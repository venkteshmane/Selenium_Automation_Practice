var canwork=1,opened_popups=[];function windowOpen(a,b,c,d){a=window.open(a,b,c,d);null==a?alert(messageResource.getMessage("common.popups_blocked")):a.focus()}
function popup(a,b,c,d,e,f,g,h){if(canwork){canwork=0;b||(b="windowedPopup");d||(d=500);c||(c=830);e||(e="no");f||(f="no");"windowedPopup"!=b&&window[b]&&!window[b].closed&&window[b].close();var k=null;try{k=window.open(a,b,"directories=no,height="+d+",width="+c+",location=no,menubar="+e+",resizable=yes,scrollbars=yes,status=no,toolbar="+f);if(null==k){alert(messageResource.getMessage("common.popups_blocked"));return}k.focus();("undefined"==typeof h||h)&&addPopup(k)}catch(l){}canwork=1;if(g&&null!=
k)return k}}function addPopup(a){opened_popups[opened_popups.length]=a}function closeAllOpenedPopups(){for(var a=0;a<opened_popups.length;a++){var b=opened_popups[a];b.closed||b.close()}}function show_in_main_window(a){if(window.opener&&0<=window.name.indexOf("windowedPopup")){var b=window.location.href;null!=a&&(b=addRequestParams(window.location.href,"e=".concat(a)));window.opener.location.href=b;window.opener.focus();window.close()}}
function addRequestParams(a,b){var c=a,c=0<=a.indexOf("?")?c.concat("&"):c.concat("?");return c.concat(b)}function notEmpty(a,b){return 0<trim(a.value).length?(b&&""!=b&&(alert(b),a.focus()),!1):!0}function setCheckboxesState(a,b,c){for(var d=0;d<a.length;d++)"checkbox"==a.elements[d].type&&-1!=a.elements[d].name.search(b)&&(a.elements[d].checked=c)}function setOptionsState(a,b){for(var c=0;c<a.options.length;c++)a.options[c].selected=b}
function getVal(a){return"select-one"==a.type?void 0!=a.selectedIndex?parseInt(a.options[a.selectedIndex].value,10):parseInt(a.options[a.value].value,10):parseInt(a.value,10)}function normalize(a){for(var b=/\s{2,}/;b.test(a);)a=a.replace(b," ");return a}function trimAllTextFields(a){for(var b=0;b<a.length;b++)"text"==a.elements[b].type&&(a.elements[b].value=trim(a.elements[b].value))}
function normalizeAllTextFields(a){for(var b=0;b<a.length;b++)"text"==a.elements[b].type&&(a.elements[b].value=normalize(a.elements[b].value))}function toUnixLineFeeds(a){return a.replace(/\r/g,"")}function isAndroid(){return-1!=navigator.userAgent.indexOf("Android")}function isOldIE(){return isIE8()||-1<navigator.userAgent.toLowerCase().indexOf("msie 9")}function isMobile(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}
function isElementInViewPort(a){a=a.getBoundingClientRect();return 0<=a.top&&0<=a.left&&a.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&a.right<=(window.innerWidth||document.documentElement.clientWidth)}function showElement(a){a.style.display="block"}function hideElement(a){a.style.display="none"}function showElementById(a){showElement(document.getElementById(a))}function hideElementById(a){hideElement(document.getElementById(a))}
function showMoire(a,b){var c=document.getElementById(a);if(c){shiftTo(c,0,0);var d=c.getElementsByTagName("img")[0];showElement(c);d&&showElement(d);c=function(){moireHelper.extinguishEnterTTCalendarWeek()};moireHelper.setWindowResizeHandler(c);c()}}function hideMoire(a){(a=document.getElementById(a))&&hideElement(a);(a=a.getElementsByTagName("img")[0])&&hideElement(a);moireHelper.restoreWindowResizeHandler();moireHelper.extinguishEnterTTCalendarWeek()}
function MoireHelper(){this.previousWindowResizeHandler=window.onresize;this.windowResizeHandlerChanged=!1;this.setWindowResizeHandler=function(a){"undefined"!=typeof a&&null!=a&&(this.previousWindowResizeHandler=window.onresize,window.onresize=a,this.windowResizeHandlerChanged=!0)};this.restoreWindowResizeHandler=function(){this.windowResizeHandlerChanged&&(window.onresize=this.previousWindowResizeHandler,this.windowResizeHandlerChanged=!1)};this.extinguishEnterTTCalendarWeek=function(){"undefined"!=
typeof Calendar_calendarTableOut&&Calendar_calendarTableOut()}}function ImagePreloader(a,b){this.callback=b;this.nProcessed=this.nLoaded=0;this.aImages=[];this.nImages=a.length;for(var c=0;c<a.length;c++)this.preload(a[c])}ImagePreloader.prototype.preload=function(a){var b=new Image;this.aImages.push(b);b.onload=ImagePreloader.prototype.onload;b.onerror=ImagePreloader.prototype.onerror;b.onabort=ImagePreloader.prototype.onabort;b.oImagePreloader=this;b.bLoaded=!1;b.src=a};
ImagePreloader.prototype.onComplete=function(){this.nProcessed++;this.nProcessed==this.nImages&&"undefined"!=typeof this.callback&&null!=this.callback&&this.callback(this.aImages,this.nLoaded)};ImagePreloader.prototype.onload=function(){this.bLoaded=!0;this.oImagePreloader.nLoaded++;this.oImagePreloader.onComplete()};ImagePreloader.prototype.onerror=function(){this.bError=!0;this.oImagePreloader.onComplete()};ImagePreloader.prototype.onabort=function(){this.bAbort=!0;this.oImagePreloader.onComplete()};
function spentTimeIsInvalid(a){return null==a||0>a}function areCookiesEnabled(){document.cookie="cookies=true";return document.cookie?!0:!1}function setElementInnerHTML(a,b){document.getElementById(a).innerHTML=b}function getSelectedRadio(a){if(a[0])for(var b=0;b<a.length;b++){if(a[b].checked)return b}else if(a.checked)return 0;return-1}function getSelectedRadioValue(a){var b=getSelectedRadio(a);return-1==b?null:a[b]?a[b].value:a.value}function findFormElementByName(a,b){return a.elements[b]}
function addListener(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)}function removeListener(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,c)}function stopEventPropagation(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function newDate(a,b,c){return new Date(a,b,c,12,0)}function getTargetElement(a){if(a.toElement)return a.toElement;if(a.relatedTarget)return a.relatedTarget}
function applyToSingleOrEach(a,b){if(a)if(void 0!=a.length)for(var c=0;c<a.length;c++)b(a[c],c);else b(a,0)}function applyToSingleOrIndexed(a,b,c){if(void 0!=a.length)c(a[b]);else if(0==b)c(a);else throw"Not a collection, but non-zero index was given";}function applyToSingleOrLast(a,b){void 0!=a.length?b(a[a.length-1]):b(a)}function getCorrectedWidth(a){return"number"==typeof window.innerWidth?a+window.outerWidth-window.innerWidth:a}
function getCorrectedHeight(a){return"number"==typeof window.innerHeight||"number"==typeof window.outerHeight?a+window.outerHeight-window.innerHeight:a}function adaptiveWindowResize(a,b){var c=getInsideWindowWidth(),d=getInsideWindowHeight();a=null==a?c:a;b=null==b?d:b;(a>c||b>d)&&resizeWindow(a,b)}function resizeWindow(a,b){window.resizeTo(getCorrectedWidth(a),getCorrectedHeight(b));var c=getInsideWindowWidth(),d=getInsideWindowHeight();a==c&&b==d||window.resizeTo(a+(a-c),b+(b-d))}
function adaptiveResizeAfterLoad(a,b){addListener(window,"load",function(){adaptiveWindowResize(a,b)})}function notifyAndSubmit(a){if(a.dispatchEvent){var b=a.ownerDocument.createEvent("HTMLEvents");b.initEvent("submit",!1,!0);a.dispatchEvent(b);Event.SUBMIT||a.submit()}else a.fireEvent&&(a.fireEvent("onsubmit",b),a.submit())}function removeElementWithTimeout(a,b){addClass(a,"invisible");setTimeout(function(){a.parentNode.removeChild(a)},b)}
function focusElement(a){setTimeout(function(){a.focus()})}function isSameOrParentOf(a,b){for(var c=a;c;){if(c==b)return!0;c=c.parentNode}return!1}function hideFocusForLinks(a){a=a.getElementsByTagName("a");for(var b=a.length,c=0;c<b;c++)a[c].hideFocus=!0}function getLeaveTypeIconPath(a){return atImgPath("leave_types/icons/leave_type_"+a+"_24bit.png")}function getLeaveTypeColorIconPath(a){return atImgPath("leave_types/chart_icons/leave_icon_"+a+".gif")}
function getLeaveTypePrintIconPath(a){return atImgPath("leave_types/icons/leave_type_"+a+"_print.png")}function arrayToMapById(a){var b={};_.each(a,function(a){b[a.id]=a});return b}function arrayToSet(a){var b={};_.each(a,function(a){b[a]=!0});return b};function isEqualsIgnoreCase(a,b){return a.toLowerCase()==b.toLowerCase()}function isArrayContains(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1}function removeElementFromArray(a,b){for(var c=[],d=0;d<a.length;d++)a[d]!=b&&(c[c.length]=a[d]);return c}function isSelectElement(a){return"select-one"==a.type}function getElementById(a){return document.getElementById(a)}function isChildOf(a,b){if(b)for(;b.parentNode;)if((b=b.parentNode)==a)return!0;return!1}
function findChildById(a,b){if(!a)return null;if(a.id==b)return a;if(!a.hasChildNodes())return null;for(var c=0;c<a.childNodes.length;c++){var d=findChildById(a.childNodes[c],b);if(null!=d)return d}return null}function isMouseOutElement(a,b){var c=b.relatedTarget||b.toElement,d;try{d=isChildOf(a,c)}catch(e){d=!1}return!d&&a!=c}function isMouseOverElement(a,b){var c=b.target||b.srcElement,d;try{d=isChildOf(a,c)}catch(e){d=!1}return d||a==c}
function makeHandlerNoPropagation(a,b){return function(c){stopEventPropagation(window.event);return a.call(b,c)}}function getEventTarget(a){a=a?a:window.event;var b;a.target?b=a.target:a.srcElement&&(b=a.srcElement);if(!b)return null;3==b.nodeType&&(b=b.parentNode);return b}function isTarget(a,b){var c=getEventTarget(b);return c==a||isChildOf(a,c)}function compareArrays(a,b){return!a&&!b||a&&b&&a.toString()==b.toString()}
function selectFromArray(a,b){for(var c=[],d=0;d<a.length;d++)for(var e=0;e<b.length;e++)if(b[e].id==a[d]){c.push(b[e]);break}return c}function addAll(a,b){for(var c=0;c<b.length;c++)a.push(b[c])}function contains(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return!0;return!1}function getStyleById(a,b){var c=null,d=document.getElementById(a);d.currentStyle?c=d.currentStyle[b]:window.getComputedStyle&&(c=document.defaultView.getComputedStyle(d,null).getPropertyValue(b));return c}
function getStyleByElement(a,b){var c=null;a.currentStyle?c=a.currentStyle[b]:window.getComputedStyle&&(c=document.defaultView.getComputedStyle(a,null).getPropertyValue(b));return c}function splitByUnicodeChar(a){for(var b=[];a.length;)/[\uD800-\uDFFF]/.test(a.substr(0,1))?(b.push(a.substr(0,2)),a=a.substr(2)):(b.push(a.substr(0,1)),a=a.substr(1));return b}function isNumber(a){return!isNaN(a)}function isPositiveNumber(a){return isNumber(a)&&0<parseFloat(a)}
function isNonNegativeInteger(a){return isNumber(a)&&0<=parseFloat(a)&&parseInt(a)==parseFloat(a)}function isUnsignedPositiveInteger(a){return isPositiveNumber(a)&&parseInt(a)==parseFloat(a)&&/^\d+$/.test(a)}function isInteger(a){return isNumber(a)&&parseInt(a)==parseFloat(a)}
function equalObjects(a,b){try{for(p in a)switch(typeof a[p]){case "object":if(!equalObjects(a[p],b[p]))return!1;break;case "function":if("undefined"==typeof b[p]||"equals"!=p&&a[p].toString()!=b[p].toString())return!1;break;default:if(a[p]!=b[p])return!1}for(p in b)if("undefined"==typeof a[p])return!1;return!0}catch(c){return!1}}function getPropertyValues(a,b){var c=[];if(!a||!b)return c;for(var d=0;d<a.length;d++)c.push(a[d][b]);return c}
function getPropertyValue(a,b){try{return a[b]}catch(c){return null}}
function fireMouseEvent(a,b,c){var d=a?a:window.event;a=getEventTargetHref(d);var e;d.initMouseEvent?(e=document.createEvent("MouseEvent"),e.initMouseEvent(b,!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,d.ctrlKey,d.altKey,d.shiftKey,d.metaKey,0,null),c&&stopEventPropagation(e),d.target.dispatchEvent(e)):document.createEventObject&&(e=document.createEventObject(d),d=d.srcElement,c&&stopEventPropagation(e),d.fireEvent("on"+b,e));a&&(document.location.href=a)}
function using(a,b){b.apply(this,a)}function getEventTargetHref(a){a=a.target||a.srcElement;var b;do if("a"==a.nodeName.toLowerCase()&&a.href&&a.href!=window.location.href&&a.href!=window.location.href+"#"&&"javascript:"!=a.href.substr(0,11).toLowerCase()&&!a.target&&!a.onclick){b=a.href;break}while(a=a.parentNode);return b}function hasParentWithClassName(a,b){var c=a;do if(hasClass(c,b))return!0;while(c=c.parentNode);return!1}
function wait(a){a=a?a:250;for(var b=(new Date).getTime();b+a>(new Date).getTime(););}function isChrome(){return/chrome/.test(navigator.userAgent.toLowerCase())}function isFireFox(){return/firefox/.test(navigator.userAgent.toLowerCase())}function isInternetExplorer(){return/msie/.test(navigator.userAgent.toLowerCase())}function doSafeSubmit(a){try{a.submit()}catch(b){}}function doSafeLocationChange(a){try{window.location.href=a}catch(b){}}function formatId(a,b){return a+"_"+b}
function isObjectEmpty(a){for(var b in a)return!1;return!0}function formatMonthDay(a){switch(Number(a)){case 1:case 21:case 31:return a+"st";case 2:case 22:return a+"nd";case 3:case 23:return a+"rd";default:return a+"th"}}function createSpan(a,b){return'<span class="'+a+'">'+b+"</span>"}function createDiv(a,b){return'<div class="'+a+'">'+b+"</div>"}function createLink(a,b){return'<a href="'+a+'">'+b+"</a>"}function createImg(a){return'<img src="'+a+'">'}
function insertBefore(a,b){b.parentNode.insertBefore(a,b)}function safeSplit(a,b){return a?a.split(b):[]}function setFocusToEndOfInput(a){if(a.setSelectionRange)a.focus(),a.setSelectionRange(a.value.length,a.value.length);else if(a.createTextRange){var b=a.createTextRange();b.collapse(!0);b.moveEnd("character",a.value.length);b.moveStart("character",a.value.length);b.select()}}function getExceptionNameFromTrace(a){return a.match(/^[A-Za-z0-9_$.]+/g)[0]}
function getMinTodayOfUsers(a,b){for(var c=a.today.parseJSONDate(),d=0;d<b.length;d++){var e=b[d].today.parseJSONDate();e<c&&(c=e)}return c}function datesIsOnTheSameWeek(a,b){return a.getWeekStartDate().getTime()==b.getWeekStartDate().getTime()}function updateElementInDOM(a){var b=a.style.display;a.style.display="none";a.style.display=b}function updateElementInDOMWithDelay(a){setTimeout(function(){updateElementInDOM(a)},10)}
function mergeArrayToNullableMap(a,b){return void 0===a||null===a?mergeArrayToMap({},b):mergeArrayToMap(a,b)}function mergeArrayToMap(a,b){_.each(b,function(b){_.isUndefined(a[b.id])&&(a[b.id]=b)});return a}function mergeArraysById(a,b){var c={};mergeArrayToMap(c,a);mergeArrayToMap(c,b);return _.values(c)}function compareExceptions(a,b){return a.msg===b||a.exception===b};var LINK_SEARCH_DEPTH=2,blockClicks=!1,controls=[],formModified=!1,buttonHilightColor="#fff6c6",borderHilightColor="#f4b700",hilightChanges=!0,submitMethod=void 0,discardMethod=void 0,cancelMethod=void 0,exitModifiedCallback=void 0,confirmDlg=void 0,validateFunction=void 0,formOnChangedCallback=void 0,onHighlightChangesCallback=void 0,changeableControlInnerVariables={index:0};function registerChangeableControl(a){controls[changeableControlInnerVariables.index++]=a}
function registerFormChangeCallback(a){formOnChangedCallback=a}function registerOnHighlightChangesCallback(a){onHighlightChangesCallback=a}function handleChange(a,b){formModified?hilightChanges&&a&&hideMessages():(formModified=!0,document.forms[0]&&document.forms[0].elements.formDataModified&&(document.forms[0].elements.formDataModified.value="true"),hilightChanges&&(onHighlightChangesCallback&&onHighlightChangesCallback(),hilightButtonPane(),showModifiedDiv(b),a&&hideMessages()))}
function hideMessages(){makeElementByIdInvisible("MessagesTable")}function hideErrors(){makeElementByIdInvisible("ErrorsTable")}function makeElementByIdInvisible(a){if(a=document.getElementById(a))a.style.visibility="hidden"}function deleteMessages(){document.getElementById("MessagesTable")&&(document.getElementById("MessagesTable").style.display="none")}function deleteErrors(){document.getElementById("ErrorsTable")&&(document.getElementById("ErrorsTable").style.display="none")}
function isLink(a,b){"undefined"==typeof b&&(b=a?a.target:window.event?window.event.srcElement:null);return"undefined"!=typeof b.hash&&"undefined"!=typeof b.host&&"undefined"!=typeof b.search&&"undefined"!=typeof b.protocol?!0:!1}function onKeyUpChangeableHandler(a){isLink(a)||changeableHandler(a)}
function changeableHandler(a){void 0!=formOnChangedCallback&&formOnChangedCallback();if(!formModified)for(i=0;i<controls.length;i++)if(void 0!=controls[i]){if((void 0!=controls[i].defaultValue||""==controls[i].defaultValue)&&controls[i].value!=controls[i].defaultValue){handleChange(!0);break}if(void 0!=controls[i].defaultChecked&&controls[i].checked!=controls[i].defaultChecked){handleChange(!0);break}if(controls[i].options)for(j=0;j<controls[i].options.length;j++)if(controls[i].options[j].selected!=
controls[i].options[j].defaultSelected){handleChange(!0);break}}}function showModifiedDiv(a){var b=document.getElementById("FormModifiedDiv");b&&b.style&&(b.style.visibility="visible");a&&a()}function cancelModifications(a){changesDetected()||a||cancelAllModifications()}
function cancelAllModifications(){var a=document.getElementById("FormModifiedDiv");a&&a.style&&(a.style.visibility="hidden");formModified=!1;document.forms[0]&&document.forms[0].elements.formDataModified&&(document.forms[0].elements.formDataModified.value="false")}function hilightButtonPane(){var a=document.getElementById("ButtonPane");a&&a.style&&(a.style.backgroundColor=buttonHilightColor,a.style.borderColor=borderHilightColor,a.style.backgroundImage="url("+atImgPath("not_saved_bg.gif")+")")}
function setSubmitHandler(a){void 0!=a&&(submitMethod=a)}function setDiscardHandler(a){void 0!=a&&(discardMethod=a)}function setCancelHandler(a){void 0!=a&&(cancelMethod=a)}function registerFormChangedHandlers(a,b){hilightChanges=a;document.body.onchange=changeableHandler;document.body.onkeyup=onKeyUpChangeableHandler;subscribeChangeAndExitHandlersOnMouseClick();document.forms[0].formDataModified&&"true"==document.forms[0].formDataModified.value&&handleChange(!1,b)}
function cancelForm(a,b,c){formModified?confirm(a)&&(c&&c(),document.location.href=b):(c&&c(),document.location.href=b)}function textFieldChanged(a){a.value!=a.defaultValue&&handleChange(!0)}function showConfirmExitDlg(){setRedirectUrl("");blockClicks=!0;confirmDlg.open();KeyDownHandler.setOnKeyDownHandler(function(a){handleEscape(remainOnThePage,a)})}function hideConfirmExitDlg(){confirmDlg.close();blockClicks=!1;KeyDownHandler.restoreOnKeyDownHandler();document.setActive&&document.setActive()}
function saveFormChanges(){hideConfirmExitDlg();void 0!=submitMethod?submitMethod():document.forms[0].submit()}function discardFormChanges(){hideConfirmExitDlg();var a=!0;void 0!=validateFunction&&(a=validateFunction());a&&(void 0!=discardMethod?discardMethod():window.location.href=getRedirectUrl())}function remainOnThePage(){hideConfirmExitDlg();setRedirectUrl("");void 0!=cancelMethod&&cancelMethod()}
function exitHandler(a){var b=a?a.target:window.event?window.event.srcElement:null,c=a?a:window.event?window.event:null;if(null==b||blockClicks&&(!b.type||"button"!=b.type)||b.src==b.href&&(b=b.parentElement,null==b))return!1;if(b.src&&void 0!=typeof b.hspace&&void 0!=typeof b.vspace&&b.parentNode)for(;0<LINK_SEARCH_DEPTH&&b&&!b.href;)b=b.parentNode;for(;b&&!b.href&&b.parentNode;)b=b.parentNode;if(null==b)return!1;if(!b.href||b.href==window.location.href||b.href==window.location.href+"#"||"javascript:"==
b.href.substr(0,11).toLowerCase()||b.target||b.onclick)return!0;a=function(){setRedirectUrl(b.href);c.returnValue=!1;void 0!=c.preventDefault&&c.preventDefault()};if(checkModified(a))return showConfirmExitDlg(),a(),!1}function setExitHandler(a){exitModifiedCallback=a}
function subscribeChangeAndExitHandlersOnMouseClick(){var a=!1;isMSIE()&&(document.body.onmousedown=function(){var b=window.event;void 0!=b&&(a=4<=b.button)});var b=document.body.onclick;document.body.onclick=function(c){b&&b(c);changeableHandler(c);a||(a=!1,exitHandler(c))}}function checkModified(a){return void 0!=exitModifiedCallback?exitModifiedCallback(a):changesDetected()}function changesDetected(){return formModified}function setChangesDetected(a){formModified=a}
function setRedirectUrl(a){document.forms[0].redirectUrl&&(document.forms[0].redirectUrl.value=a)}function getRedirectUrl(){return document.forms[0].redirectUrl?document.forms[0].redirectUrl.value:window.location.href}function setValidateFunction(a){void 0!=a&&(validateFunction=a)}
function ConfirmExitDlg(a,b,c,d,e,f){this.width=a;this.warningText=b;this.questText=c;this.confirmDlg=document.getElementById("exitConfirmDiv");this.saveButton=document.getElementById("SaveChangesButton");this.discardButton=document.getElementById("DiscardChangesButton");this.remainButton=document.getElementById("RemainOnThePageButton");this.dialog=document.getElementById("exitConfirmDialog");this.dialogDiv=document.getElementById("exitConfirmDialogDiv");this.setupButton(this.saveButton,d);this.setupButton(this.discardButton,
e);this.setupButton(this.remainButton,f);this.buttonToFocus=""!=d?this.saveButton:this.discardButton;document.getElementById("ConfirmWarning").firstChild.nodeValue=b;document.getElementById("ConfirmQuest").firstChild.nodeValue=c}ConfirmExitDlg.prototype.setWarningInnerHTML=function(a){document.getElementById("ConfirmWarning").innerHTML=a};
ConfirmExitDlg.prototype.positionDlg=function(){var a=getBodyScrollTop();$(this.confirmDlg).css({top:a+"px"});$(this.dialogDiv).css({"margin-top":-$(this.dialog).height()/2+"px"});$(this.dialog).width(this.width);$(this.dialogDiv).width($(this.dialog).width());$(this.dialogDiv).height($(this.dialog).height())};ConfirmExitDlg.prototype.setupButton=function(a,b){a&&(void 0!=b&&""!=b?a.value=b:hideElement(a))};
ConfirmExitDlg.prototype.open=function(){showMoire("moireDiv","container");showElement(this.confirmDlg);this.positionDlg();var a=this;window.setTimeout(function(){try{a.buttonToFocus.focus()}catch(b){}},200)};ConfirmExitDlg.prototype.close=function(){hideElement(this.confirmDlg);hideMoire("moireDiv")};var AtAnimation={browserEventName:function(a){var b=document.createElement("div"),c;for(c in a)if(void 0!==b.style[c])return a[c]},browserVendorPrefixes:function(){var a=null;_.isUndefined(window.getComputedStyle)||(a=window.getComputedStyle(document.documentElement,""),a=(_.unique(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1]);return{css:a?"-"+a+"-":"",js:a?a[0].toUpperCase()+a.substr(1):""}},isAnimationSupported:function(){AtAnimation._init();return!_.isUndefined(this._animationEndEventName)},
isTransitionSupported:function(){AtAnimation._init();return!_.isUndefined(this._transitionEndEventName)},getAnimationEndEventName:function(){AtAnimation._init();return this._animationEndEventName},getTransitionEndEventName:function(){AtAnimation._init();return this._transitionEndEventName},getVendorPrefixedJSName:function(a){AtAnimation._init();return this._vendorPrefixes.js+a},getVendorPrefixedCssName:function(a){AtAnimation._init();return this._vendorPrefixes.css+a},_init:function(){AtAnimation._initialized||
(AtAnimation._vendorPrefixes=AtAnimation.browserVendorPrefixes(),AtAnimation._transitionEndEventName=AtAnimation.browserEventName({transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"}),AtAnimation._animationEndEventName=AtAnimation.browserEventName({animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"}),AtAnimation._initialized=!0)}};
function AtAnimationJqueryPlugin(a){this.e=a}
AtAnimationJqueryPlugin.prototype=_.create(Object.prototype,{fadeIn:function(a){return this.showAnimated("anim-fade-in",a)},fadeOut:function(a){return this.hideAnimated("anim-fade-out",a)},fadeInWithScale:function(a){return this.showAnimated("anim-fade-in-with-scale",a)},fadeOutWithScale:function(a){return this.hideAnimated("anim-fade-out-with-scale",a)},stopAnimation:function(){this.oneAnimationEnd(function(){})},stopTransition:function(){this.oneTransitionEnd(function(){})},oneAnimationEnd:function(a){AtAnimation._init();
return this._oneEvent(AtAnimation._animationEndEventName,"_atAnimationEndCb",a)},oneTransitionEnd:function(a){AtAnimation._init();return this._oneEvent(AtAnimation._transitionEndEventName,"_atTransitionEndCb",a)},showAnimated:function(a,b){AtAnimation._init();var c=this.e;this.oneAnimationEnd(function(){c.show().removeClass(a);b&&b()});c.show().addClass(a);return c},hideAnimated:function(a,b){AtAnimation._init();var c=this.e;c.is(":visible")?(this.oneAnimationEnd(function(){c.hide().removeClass(a);
b&&b()}),c.addClass(a)):(c.hide(),b&&b());return c},_oneEvent:function(a,b,c){if(c)if(a){this._fireAndReplaceElementCallback(b,c);var d=this;this.e.one(a,function(a){d._fireAndReplaceElementCallback(b,null,a)})}else c();return this.e},_fireAndReplaceElementCallback:function(a,b,c){if(this.e[0][a])this.e[0][a](c);this.e[0][a]=b}});(function(a){a.fn.searchField=function(b,c,d){var e=a.noop,f=a.noop;if(this[0]){var g;a.isFunction(c)||(c=a.trim);e=function(){var a=c(this.pVal());this.prevValue!=a&&(this.prevValue=a,g(a))};f=function(a){this.val("");a?this.prevValue="":this.updateSearchField()};if(!1!==d){var h;"object"==a.type(d)?h=a(d):(!0!==d&&d||(d="<table class='searchFieldWrap' cellpadding='0' cellspacing='0'><tr><td class='fieldContainer'></td><td><div class='filterIcon'></div></td></tr></table>"),h=a(d,this[0].ownerDocument));
var k=function(a){h.toggleClass("hasValue",!!a)},l=this.pVal;this.pVal=function(a){var b=l.call(this,a);void 0!==a&&k(l.call(this));return b};g=function(a){k(a);b(a)};f=function(a){this.val("");a?k(this.prevValue=""):this.updateSearchField()};d=h.find(".fieldContainer");0<d.length&&(this[0].parentNode&&h.insertBefore(this[0]),d.append(this));var m=this;h.find(".filterIcon").click(function(){m.clearSearchField();m.focus()});this.focus(function(){h.addClass("inputFocused")});this.blur(function(){h.removeClass("inputFocused")})}else g=
b}this.prevValue="";this.updateSearchField=e;this.clearSearchField=f;return this}})(jQuery);function handleAjaxUserActionError(a,b,c,d){function e(a){alert(a);document.location.reload()}c||(c=function(){});if(!c(a,b))switch(a){case AJAX_USER_ACTION_ERROR_CODES.NO_ACTIVE_LICENSE:e(AJAX_USER_ACTION_ERROR_MESSAGES.NO_ACTIVE_LICENSE);break;case AJAX_USER_ACTION_ERROR_CODES.LICENSE_VIOLATION:e(AJAX_USER_ACTION_ERROR_MESSAGES.LICENSE_VIOLATION);break;case AJAX_USER_ACTION_ERROR_CODES.SESSION_EXPIRED:e(JQUERY_RPC_ERROR_MESSAGES.SESSION_EXPIRED);break;case AJAX_USER_ACTION_ERROR_CODES.NO_SUCH_USER:e(AJAX_USER_ACTION_ERROR_MESSAGES.NO_SUCH_USER);
break;case AJAX_USER_ACTION_ERROR_CODES.USER_IS_DISABLED:e(AJAX_USER_ACTION_ERROR_MESSAGES.USER_IS_DISABLED);break;case AJAX_USER_ACTION_ERROR_CODES.NO_RIGHTS:e(JQUERY_RPC_ERROR_MESSAGES.NO_RIGHTS);break;case AJAX_USER_ACTION_ERROR_CODES.PRODUCT_MISMATCH:e(JQUERY_RPC_ERROR_MESSAGES.SESSION_EXPIRED);break;case AJAX_USER_ACTION_ERROR_CODES.INCORRECT_CHALLENGE_RESPONSE:e(JQUERY_RPC_ERROR_MESSAGES.SESSION_EXPIRED);break;case AJAX_USER_ACTION_ERROR_CODES.ERROR_STATE:case AJAX_USER_ACTION_ERROR_CODES.UNEXPECTED_ERROR:alert(AJAX_USER_ACTION_ERROR_MESSAGES.UNEXPECTED_ERROR);
b&&console.log(b);break;default:d?d(a,b):alert(AJAX_USER_ACTION_ERROR_MESSAGES.UNEXPECTED_ERROR)}};var contentLoadingPopup=null;
function loadPopupContent(a,b,c,d,e){var f=$("#popupContentLoadingPlaceholder");deleteLoadedPopupContent();c&&(contentLoadingPopup||(contentLoadingPopup=(new LoadingPopup).init("contentLoadingPopup")),contentLoadingPopup.setOnEscapeCallback(function(){g&&g.abort()}),contentLoadingPopup.show());$.ajaxSetup({cache:!0});var g=$.ajax({url:a,success:function(a){f.html(a);a=function(){c&&contentLoadingPopup.hide();b&&b()};e?a():window.setTimeout(a,200)},error:function(a,b){c&&contentLoadingPopup.hide();
var e=function(){100<=a.status&&1E3>a.status?alert(JQUERY_RPC_ERROR_MESSAGES.HTTP_ERROR+" "+a.status+" "+a.statusText):alert(JQUERY_RPC_ERROR_MESSAGES.NETWORK_ERROR)};switch(b){case "abort":break;case "timeout":alert(JQUERY_RPC_ERROR_MESSAGES.TIMEOUT);break;case "error":handleAjaxUserActionError(a.status,a.responseText,d,e);break;default:alert(AJAX_USER_ACTION_ERROR_MESSAGES.UNEXPECTED_ERROR)}},timeout:12E4})}function deleteLoadedPopupContent(){$("#popupContentLoadingPlaceholder").empty()};$.fn.eqOrLast=function(a){return this.length>a?this.eq(a):this.last()};$.fn.atAnimation=function(){return new AtAnimationJqueryPlugin(this)};$.fn.resizeThrottle=function(a,b){var c;this.resize(function(){clearTimeout(c);c=setTimeout(a,b)})};$.fn.queueViewStateSwitcher=function(a){var b;0==arguments.length?b=this[0]._queueViewStateSwitcher:(b=new QueueViewStateSwitcher(this,a),this[0]._queueViewStateSwitcher=b);return b};$.fn.cssLeft=function(a){return this.css("left",px(a))};
$.fn.cssRight=function(a){return this.css("right",px(a))};$.fn.cssTop=function(a){return this.css("top",px(a))};$.fn.cssBottom=function(a){return this.css("bottom",px(a))};$.fn.cssWidth=function(a){return this.css("width",px(a))};$.fn.cssHeight=function(a){return this.css("height",px(a))};$.fn.valueChanged=function(a){this[0].prevValue=this.pVal();this.on("keyup paste cut blur",function(b){var c=$(this).pVal();if(!this.prevValue&&c||this.prevValue!==c)a.call(this,b),this.prevValue=c})};
$.fn.adjustHeightToWindowSize=function(){this.height($(window).height()-this.offset().top)};TransformedScreenMoire={elemID:"transformedMoireId",elemClass:"transformedMoireClass",show:function(a,b){var c=this.getMoire();0!=c.length&&c.remove();$("<div>").attr("id",this.elemID).addClass(this.elemClass).addClass(b).css("opacity",a).on("mousedown click dbclick ",function(a){a.preventDefault()}).appendTo("body")},hide:function(a,b,c,d){var e=this.getMoire(c);0!=e.length&&this.transformTo(0,a,b,c,function(){e.remove();$("body").focus();d&&d()})},transformTo:function(a,b,c,d,e){c=c||"linear";b=
b||"0.1s";d=this.getMoire(d);if(e)d.atAnimation().oneTransitionEnd(e);d.css(AtAnimation.getVendorPrefixedCssName("transition"),"opacity "+b+" "+c);d.css("opacity");d.css("opacity",a)},showAndTransformTo:function(a,b,c,d,e,f){this.show(.01,a);this.transformTo(b,c,d,e,f)},getMoire:function(a){a=a||this.elemID;return $("#"+a)}};var months="jan feb mar apr may jun jul aug sep oct nov dec".split(" ");
function parseDate(a,b){if("string"!=typeof a)return null;a=a.toLowerCase();var c=a.match(/[0-9]+|[a-z]+/g);if(null==c||2>c.length)return null;var d=[],e=-1,f=-1,g=-1;2==c.length&&(g=(new Date).getFullYear());for(var h=Math.min(c.length,3),k=0;k<h;k++){var l=parseInt(c[k],10);if(isNaN(l)){if(-1!=e)return null;for(l=0;l<months.length;l++)if(0==c[k].indexOf(months[l])){e=l+1;f=k+1;break}if(-1==e)return null}else{if(1>l)return null;if(31<l){if(1==k||-1!=g)return null;g=l}else d[d.length]=l}}c=null;"string"==
typeof b&&(b=b.toUpperCase(),c=[b.indexOf("DD"),b.indexOf("MM"),b.indexOf("YY")]);switch(d.length){case 0:codeBug();case 1:return createDate(d[0],e,g);case 2:if(-1!=g)return resolveDayMonthAmbiguity(d[0],d[1],g,c);if(-1!=e)return resolveDayYearAmbiguity(d[0],d[1],e,f,c);codeBug();default:return resolveTotalAmbiguity(d[0],d[1],d[2],c)}}
function resolveDayMonthAmbiguity(a,b,c,d){return 12<a?12<b?null:createDate(a,b,c):12<b?createDate(b,a,c):-1==d[0]||-1==d[1]?null:d[1]>d[0]?createDate(a,b,c):createDate(b,a,c)}function resolveDayYearAmbiguity(a,b,c,d,e){return 1==d?createDate(a,c,b):3==d?createDate(b,c,a):-1==e[0]||-1==e[2]?null:e[2]>e[0]?createDate(a,c,b):createDate(b,c,a)}
function resolveTotalAmbiguity(a,b,c,d){firstCanBeMonth=12>=a;secondCanBeMonth=12>=b;thirdCanBeMonth=12>=c;return firstCanBeMonth||secondCanBeMonth||thirdCanBeMonth?!firstCanBeMonth||secondCanBeMonth||thirdCanBeMonth?firstCanBeMonth||!secondCanBeMonth||thirdCanBeMonth?firstCanBeMonth||secondCanBeMonth||!thirdCanBeMonth?-1==d[0]||-1==d[1]||-1==d[2]?null:d[0]<d[1]?d[0]<d[2]?secondCanBeMonth?createDate(a,b,c):createDate(b,a,c):thirdCanBeMonth?createDate(b,c,a):createDate(c,b,a):d[0]>d[2]?secondCanBeMonth?
createDate(c,b,a):createDate(b,c,a):firstCanBeMonth?createDate(b,a,c):createDate(a,b,c):resolveDayYearAmbiguity(a,b,c,3,d):resolveDayYearAmbiguity(a,c,b,2,d):resolveDayYearAmbiguity(b,c,a,1,d):null}function createDate(a,b,c){100>c&&(c=100*Math.floor((new Date).getFullYear()/100)+c);if(1970>c||3E3<c)return null;var d=new Date(c,b-1,a,12);d.getDate()!=a&&(d=new Date(c,b-1,a-d.getDate(),12));return d}function codeBug(){alert("CodeBug")};BaseNumberValidator=function(a,b,c,d){this.minNumber=a;this.maxNumber=b;this.digitalGrouping=c;this.allowPercent=d};BaseNumberValidator.prototype.doParseNumber=function(a){return null};BaseNumberValidator.prototype.parseNumber=function(a){return this.isNumberStringValid(a)?this.doParseNumber(a):null};BaseNumberValidator.prototype.getValidationRegEx=function(){return".*"};BaseNumberValidator.prototype.isNumberStringValid=function(a){a=trim(a);a=this.removeDigitSeparator(a);return null!=a.match(this.getValidationRegEx())};
BaseNumberValidator.prototype.isPercentage=function(a){return this.isNumberStringValid(a)?"%"==a.substring(a.length-1):!1};BaseNumberValidator.prototype.formatNumber=function(a){return new String(a)};BaseNumberValidator.prototype.formatNumberWithDigitSeparator=function(a){return new String(a)};
BaseNumberValidator.prototype.doCheckField=function(a,b,c){var d=trim(new String(a.value));d!=a.value&&(a.value=d);if(""==d)return c.onEmptyValue(a),b;if(this.isNumberStringValid(d)){b=this.parseNumber(d);""!=d&&(a.value=this.formatNumber(b));if(!this.maxNumber||b<this.maxNumber){if(!this.minNumber||b>=this.minNumber)return c.onOk(a,d,b),!0;c.onLessThanMin(a,d,b);return!1}c.onGreaterThanMax(a,d,b);return!1}c.onInvalidString(a,d);return!1};
BaseNumberValidator.prototype.checkField=function(a,b){return this.doCheckField(a,b,{onEmptyValue:function(a){},onInvalidString:function(a,b){},onGreaterThanMax:function(a,b,e){},onLessThanMin:function(a,b,e){},onOk:function(a,b,e){}})};BaseNumberValidator.prototype.removeDigitSeparator=function(a){a=trim(a);return this.digitalGrouping&&0!=this.digitalGrouping.length?a=a.replace(new RegExp("["+(" "==this.digitalGrouping?"\\s":this.digitalGrouping)+"]","gi"),""):a};
IntegerNumbersValidator=function(a,b,c,d){BaseNumberValidator.apply(this,arguments);this.integerFormatter=new NumberFormatter(void 0,this.digitalGrouping?this.digitalGrouping:SystemSettings.digitGroupingSymbol,0,!0)};IntegerNumbersValidator.prototype=new BaseNumberValidator;IntegerNumbersValidator.prototype.getValidationRegEx=function(){return"^[\\+|\\-]?\\d+"+(this.allowPercent?"%?":"")+"$"};IntegerNumbersValidator.prototype.doParseNumber=function(a){return parseInt(trim(a),10)};
IntegerNumbersValidator.prototype.checkField=function(a,b,c,d,e){var f=this;return this.doCheckField(a,b,{onEmptyValue:function(a){b?ClientSideErrors.markTextFieldAsValid(a):ClientSideErrors.markTextFieldAsInvalid(a,messageResource.getMessage(e))},onGreaterThanMax:function(a,b,d){ClientSideErrors.markTextFieldAsInvalid(a,messageResource.getMessage(c,[f.formatNumber(f.maxNumber)]))},onLessThanMin:function(a,b,c){ClientSideErrors.markTextFieldAsInvalid(a,messageResource.getMessage(d,[f.formatNumber(f.minNumber)]))},
onOk:function(a,b,c){ClientSideErrors.markTextFieldAsValid(a)},onInvalidString:function(a,b){ClientSideErrors.markTextFieldAsInvalid(a,messageResource.getMessage(e))}})};IntegerNumbersValidator.prototype.formatNumberWithDigitSeparator=function(a){return this.integerFormatter.format(a)};function FloatNumbersValidator(a,b,c,d,e){IntegerNumbersValidator.call(this,0,c,b,d);this.decimalSeparator=a;this.allowNegative=e;this.floatFormatter=new NumberFormatter(a,b,2,!1)}FloatNumbersValidator.prototype=new IntegerNumbersValidator;
FloatNumbersValidator.prototype.getDecimalSeparator=function(){return this.decimalSeparator};FloatNumbersValidator.prototype.doParseNumber=function(a){var b=!1;"-"==a[0]&&(a=a.substr(1),b=!0);a=this.removeDigitSeparator(a);a=a.replace(this.decimalSeparator,".");a=a.replace(",",".");if("."==a)return 0;b&&(a="-"+a);return parseFloat(a)};
FloatNumbersValidator.prototype.getValidationRegEx=function(){return"^"+(this.allowNegative?"\\-?":"")+"\\d*["+(void 0!=this.decimalSeparator?this.decimalSeparator:"")+",.]?\\d*"+(this.allowPercent?"%?":"")+"$"};FloatNumbersValidator.prototype.formatNumber=function(a){return this.floatFormatter.format(a)};
FloatNumbersValidator.prototype.checkNumber=function(a,b,c,d,e){var f=this;return this.doCheckField(a,d,{onEmptyValue:function(a){""!=e&&ClientSideErrors.markTextFieldAsValid(a)},onGreaterThanMax:function(a,b,d){ClientSideErrors.markTextFieldAsInvalid(a,messageResource.getMessage(c,[f.formatNumberWithDigitSeparator(f.maxNumber)]))},onLessThanMin:function(a,b,c){},onOk:function(a,b,c){ClientSideErrors.markTextFieldAsValid(a)},onInvalidString:function(a,c){void 0!=f.decimalSeparator?ClientSideErrors.markTextFieldAsInvalid(a,
messageResource.getMessage(b,[f.decimalSeparator])):ClientSideErrors.markTextFieldAsInvalid(a,messageResource.getMessage(b))}})};var jsonrpc,prevReadyState=!1;function isRpcReady(a){if(!window.jsonrpc||window.jsonrpc.previousRunExceptionOccurs()||prevReadyState)window.jsonrpc=new JSONRpcClient(a?a:JSONRpcClient.prototype.moveToReadyState,RPC_LINK),a&&window.jsonrpc.moveToReadyState();return prevReadyState=jsonrpc.isReady()}
JSONRpcClient.prototype.abortAllRequests=function(){for(var a in JSONRpcClient.async_inflight)JSONRpcClient.async_inflight[a].canceled=!0;for(a=0;a<JSONRpcClient.async_requests.length;a++)JSONRpcClient.async_requests[a].canceled=!0;for(a=0;a<JSONRpcClient.async_responses.length;a++)JSONRpcClient.async_responses[a].canceled=!0};JSONRpcClient.prototype.isReady=function(){return!!this.ready};JSONRpcClient.prototype.previousRunExceptionOccurs=function(){return!!this.prevRunException};
JSONRpcClient.prototype.moveToReadyState=function(a,b){b?this.prevRunException=!0:(this.ready=!0,this.prevRunException=!1)};function RpcRetryController(a,b,c,d){this.interval=a;this.onRetry=b;this.onTimeout=c;this.onError=d;this.tid=null}RpcRetryController.prototype.start=function(){if(null!=this.interval){var a=this;this.tid=window.setTimeout(function(){a.timeout()},this.interval)}this.onRetry()};RpcRetryController.prototype.stop=function(){null!=this.tid&&(window.clearTimeout(this.tid),this.tid=null)};RpcRetryController.prototype.timeout=function(){this.stop();this.onTimeout()};
RpcRetryController.prototype.handleErrorOrRetry=function(a){if(this.isConnectionFailure(a))return this.retry(),!0;if(this.isServiceUnavailable(a))alert(JQUERY_RPC_ERROR_MESSAGES.SESSION_EXPIRED),document.location.reload();else if(-1!=a.name.indexOf("com.actimind.common.services.AccountHireDateInFutureException"))alert(JQUERY_RPC_ERROR_MESSAGES.FUTURE_HIRE_DATE),document.location.reload();else return this.stop(),this.onError(a),!1};
RpcRetryController.prototype.retry=function(){var a=this;window.setTimeout(function(){a.onRetry()},200)};RpcRetryController.prototype.isConnectionFailure=function(a){if(!a||"undefined"==typeof a.code)return!1;for(var b=[JSONRpcClient.Exception.CODE_REMOTE_EXCEPTION,JSONRpcClient.Exception.CODE_ERR_PARSE,JSONRpcClient.Exception.CODE_ERR_NOMETHOD,JSONRpcClient.Exception.CODE_ERR_UNMARSHALL,JSONRpcClient.Exception.CODE_ERR_MARSHALL],c=0;c<b.length;c++)if(a.code==b[c])return!1;return!0};
RpcRetryController.prototype.isServiceUnavailable=function(a){return a&&"undefined"!=typeof a.code?a.code==JSONRpcClient.Exception.CODE_ERR_NOMETHOD:!1};PanelDhtmlPopup.prototype=new DhtmlPopup;function PanelDhtmlPopup(a){DhtmlPopup.call(this,a);this.addEventDereferencer("mousedown")}
PanelDhtmlPopup.prototype.registerEventHandlers=function(){var a=this.getClosePopupHandler();KeyDownHandler.setOnKeyDownHandler(function(b){handleEscape(a,b);handleTab(function(){window.event.cancelBubble=!0},b)});this.oldDocumentMousedown=document.onmousedown;var b=this;document.onmousedown=function(){var c=event.target||event.srcElement;null!=b.getOwner()&&b.getOwner()==c||a()};this.getPopupDiv().onmousedown=function(a){window.event.cancelBubble=!0};this.oldWindowResize=window.onresize;window.onresize=
a};PanelDhtmlPopup.prototype.restoreEventHandlers=function(){KeyDownHandler.restoreOnKeyDownHandler();document.onmousedown=this.oldDocumentMousedown;window.onresize=this.oldWindowResize};var Base64={code:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a,b){var c,d,e,f,g=[],h="",k,l,m=Base64.code;l=("undefined"==typeof b?0:b)?a.encodeUTF8():a;k=l.length%3;if(0<k)for(;3>k++;)h+="=",l+="\x00";for(k=0;k<l.length;k+=3)c=l.charCodeAt(k),d=l.charCodeAt(k+1),e=l.charCodeAt(k+2),f=c<<16|d<<8|e,c=f>>18&63,d=f>>12&63,e=f>>6&63,f&=63,g[k/3]=m.charAt(c)+m.charAt(d)+m.charAt(e)+m.charAt(f);g=g.join("");return g=g.slice(0,g.length-h.length)+h},decode:function(a,
b){b="undefined"==typeof b?!1:b;var c,d,e,f,g,h=[],k,l=Base64.code;k=b?a.decodeUTF8():a;for(var m=0;m<k.length;m+=4)c=l.indexOf(k.charAt(m)),d=l.indexOf(k.charAt(m+1)),f=l.indexOf(k.charAt(m+2)),g=l.indexOf(k.charAt(m+3)),e=c<<18|d<<12|f<<6|g,c=e>>>16&255,d=e>>>8&255,e&=255,h[m/4]=String.fromCharCode(c,d,e),64==g&&(h[m/4]=String.fromCharCode(c,d)),64==f&&(h[m/4]=String.fromCharCode(c));f=h.join("");return b?f.decodeUTF8():f}},Utf8={encode:function(a){a=a.replace(/[\u0080-\u07ff]/g,function(a){a=a.charCodeAt(0);
return String.fromCharCode(192|a>>6,128|a&63)});return a=a.replace(/[\u0800-\uffff]/g,function(a){a=a.charCodeAt(0);return String.fromCharCode(224|a>>12,128|a>>6&63,128|a&63)})},decode:function(a){a=a.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(a){a=(a.charCodeAt(0)&15)<<12|(a.charCodeAt(1)&63)<<6|a.charCodeAt(2)&63;return String.fromCharCode(a)});return a=a.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(a){a=(a.charCodeAt(0)&31)<<6|a.charCodeAt(1)&63;return String.fromCharCode(a)})}};function BalanceFormatter(){this.constructor=BalanceFormatter}BalanceFormatter.prototype.init=function(a,b,c){this._hoursPerDay=a;this._decimalSeparator=SystemSettings.decimalSeparator;this._showBalanceInHours=b;a=!!c;this._daysFormatter=new NumberFormatter(this._decimalSeparator,SystemSettings.digitGroupingSymbol,a?0:2,!0,"","d","N/A");this._hoursFormatter=new NumberFormatter(this._decimalSeparator,SystemSettings.digitGroupingSymbol,a?0:2,!0,"","h","N/A");return this};
BalanceFormatter.prototype._recalculateFromDaysToHours=function(a){return _.isNull(a)?null:a*this._hoursPerDay};BalanceFormatter.prototype.format=function(a,b){return(b?!this._showBalanceInHours:this._showBalanceInHours)?this._hoursFormatter.format(this._recalculateFromDaysToHours(a)):this._daysFormatter.format(a)};BalanceFormatter.prototype.isShowInHours=function(){return this._showBalanceInHours};BalanceFormatter.prototype.setShowInHours=function(a){this._showBalanceInHours=a};
BalanceFormatter.prototype.isNegativePTO=function(a,b){return(b?!this._showBalanceInHours:this._showBalanceInHours)?this._hoursFormatter.isNegativeValue(this._recalculateFromDaysToHours(a)):this._daysFormatter.isNegativeValue(a)};function SickFormatter(){}SickFormatter.prototype=_.create(BalanceFormatter.prototype,{init:function(a,b){BalanceFormatter.prototype.init.call(this,a,SystemSettings.showSickInHours,b);return this}});function PTOFormatter(){}
PTOFormatter.prototype=_.create(BalanceFormatter.prototype,{init:function(a,b){BalanceFormatter.prototype.init.call(this,a,SystemSettings.showPTOInHours,b);return this}});function ChunkIterator(a,b,c,d){this.array=a;this.chunkSize=b;this.callback=c;this.context=d}
ChunkIterator.prototype={start:function(){this.bindCallback=_.bind(this.callback,this.context);this.bindIterateChunk=_.bind(this._iterateChunk,this);this.i=0;_.defer(this.bindIterateChunk);return this},pause:function(){this.paused=!0},resume:function(){this.paused&&this.i<this.array.length&&(this.paused=!1,_.defer(this.bindIterateChunk))},_iterateChunk:function(){if(!this.paused){for(var a=this.array.length,b=0;this.i<a&&b<this.chunkSize;this.i++,b++)this.bindCallback(this.array[this.i],this.i);$(this).trigger("progress",
this.i);this.i<a?_.defer(this.bindIterateChunk):$(this).trigger("completed")}}};function UserlistTabs(){}
UserlistTabs.prototype.init=function(a){this._activeTabValue=a.activeTabValue;this.items=a.items;this.tabs=$("#"+a.id);this.tabs.addClass("customHeaderTabs");this.mapValues=new AtMap;for(var b=this,c=0;c<this.items.length;++c){var d=this.items[c],e=document.createElement("span");e.id=d.id||"tab"+(c+1);$(e).addClass("tab");var f=document.createElement("span");$(f).addClass("tabContainer");var g=document.createElement("span");$(g).addClass("textTab");$(g).html(messageResource.getMessage(d.text));$(f).on("click",
function(c){return function(){b._activeTabValue!=c&&(b.setActiveTab(c),b.updateUI(),a.changeCallback&&a.changeCallback(),PageOverlayTipsManager.getInstance().refreshDynamicTips())}}(d.value));this.mapValues.put(d.value,e.id);0<c&&(d=document.createElement("span"),$(d).addClass("titleSeparator"),$(d).html("&nbsp"),$(e).append(d));$(f).append(g);$(e).append(f);this.tabs.append(e)}this.updateUI();return this};UserlistTabs.prototype.getJQueryTab=function(a){return this.tabs.find("#"+this.mapValues.get(a))};
UserlistTabs.prototype.updateUI=function(){this.tabs.find(".selected").removeClass("selected");this.getJQueryTab(this._activeTabValue).addClass("selected")};UserlistTabs.prototype.getActiveTab=function(){return this._activeTabValue};UserlistTabs.prototype.setActiveTab=function(a){this._activeTabValue=a};UserlistTabs.prototype.disableTab=function(a){this.getJQueryTab(a).addClass("disabled")};UserlistTabs.prototype.hide=function(){this.tabs.hide()};UserlistTabs.prototype.show=function(){this.tabs.show()};
UserlistTabs.prototype.unDisableTab=function(a){this.getJQueryTab(a).removeClass("disabled")};function TabCycle(){}TabCycle.prototype.init=function(){this.enabled=!1;return this};TabCycle.prototype.createSequence=function(a,b,c){this._addListener(a,b,!0);this._addListener(b,c,!0);this._addListener(b,a,!1);this._addListener(c,b,!1)};TabCycle.prototype.closeCycle=function(a,b){this._addListener(a,b,!1);this._addListener(b,a,!0)};
TabCycle.prototype._addListener=function(a,b,c){var d=this;a.keydown(function(a){a=a||window.event;d.enabled&&a.which===KEY_CODE_TAB&&a.shiftKey!=c&&(b.focus(),a.preventDefault?a.preventDefault():a.returnValue=!1)})};TabCycle.prototype.enable=function(){this.enabled=!0};TabCycle.prototype.disable=function(){this.enabled=!1};TabCycle.prototype.toggle=function(){this.enabled=!this.enabled};function NotNullCellValidator(){}NotNullCellValidator.prototype=_.create(TabularDataTableCellValidator.prototype);NotNullCellValidator.prototype.isEmpty=function(a){return null==a.getValue()};NotNullCellValidator.prototype.isValid=function(a){return null!=a.getValue()};Ext.namespace("AT");AT.LeaveGroupingItem=Ext.extend(AT.SelectorTreeNode,{initComponent:function(){AT.LeaveGroupingItem.superclass.initComponent.call(this)},getNodeBody:function(){return new Ext.form.Label({hidden:!1,cls:"leaveGroupLabel",html:"<table><tbody><tr><td>"+this.label+"</td><td class='lineTd'><div class='lineDiv'></div></td></tr></tbody>"})}});
AT.LeaveSelectorTreeCheckbox=Ext.extend(AT.SelectorTreeCheckbox,{getNodeBody:function(){var a=this.labelCls,b=this.title;return new Ext.form.Checkbox({cls:this.itemCls,boxLabel:this.getLeaveTypeImg(this.item)+Ext.util.Format.htmlEncode(this.label),checked:this.item[this.selectedProperty],afterRender:function(){Ext.form.Checkbox.prototype.afterRender.call(this);var c=Ext.get(this.el.dom.parentNode).child("label:first");b&&""!=b&&(c.dom.title=b);c.unselectable();c.addClass(a)}})},getLeaveTypeImg:function(a){return createImg(getLeaveTypeIconPath(a.iconId))}});
AT.LeavesSelectorTree=Ext.extend(AT.SimpleListSelectorTree,{cls:"at-selector-tree",selectorTreeCheckboxCtor:AT.LeaveSelectorTreeCheckbox,createNodes:function(){var a=[];Ext.each(this.data,function(b){b=this._createLeaveNode(b);a.push(b);b.on("change",this.onChange,this)},this);return a},_createLeaveNode:function(a){return new this.selectorTreeCheckboxCtor({item:a,label:a.active?this.getNameWithStatus(a):this.getNameWithStatus(a)+" "+messageResource.getMessage("common.archived"),isActive:a.active})},
selectAll:function(){this.items.each(function(a){a.hidden||a.select()});this.onChange()},setInitialSelectionFromCurrent:function(a){Ext.each(this.data,function(a){this.propertiesController.setSelectedInit(a,this.propertiesController.isSelected(a));this.propertiesController.setHiddenInit(a,this.propertiesController.isHidden(a))},this)},isSelectionChanged:function(){var a=!1;this.cascade(function(b){if(b.item){var c=this.propertiesController.isSelectedInit(b.item)!=this.propertiesController.isSelected(b.item);
b=this.propertiesController.isHiddenInit(b.item)!=this.propertiesController.isHidden(b.item);if(c||b)return a=!0,!1}},this);return a}});
AT.LeavesGroupingSelectorTree=Ext.extend(AT.LeavesSelectorTree,{cls:"at-selector-tree groupingSelectorTree",groupingItemCtor:AT.LeaveGroupingItem,createNodes:function(){var a=[];Ext.each(this.data,function(b){if(0!=b.children.length){var c=[];Ext.each(b.children,function(a){a=this._createLeaveNode(a);a.on("change",this.onChange,this);c.push(a)},this);b=new this.groupingItemCtor({item:b,label:b.label,children:c});a.push(b)}},this);return a},filter:function(a,b){"undefined"!=typeof this.items&&this.items.each(function(c){Ext.each(c.children,
function(c){c.filter(a,b)})});this.onChange()},getSelection:function(a){var b=[];Ext.each(this.data,function(c){Ext.each(c.children,function(c){!this.propertiesController.isSelected(c)||!a&&this.propertiesController.isHidden(c)||b.push(c)},this)},this);return b},selectAll:function(){this.items.each(function(a){Ext.each(a.children,function(a){a.hidden||a.select(!0,!1,!1)})});this.onChange()},setInitialSelectionFromCurrent:function(a){Ext.each(this.data,function(a){Ext.each(a.children,function(a){this.propertiesController.setSelectedInit(a,
this.propertiesController.isSelected(a));this.propertiesController.setHiddenInit(a,this.propertiesController.isHidden(a))},this)},this)}});
AT.BaseLeavesSelectorPanel=Ext.extend(AT.SimpleSelectorPanel,{cls:"selector-panel leave-types-selector-panel",selectorTreeCtor:AT.LeavesSelectorTree,createComponents:function(){AT.BaseLeavesSelectorPanel.superclass.createComponents.call(this);this.showShowInactiveCheckbox&&!_.any(LeaveTypeStore.getLeaveTypesOrdered(),function(a){return!a.active})&&(this.showShowInactiveCheckbox=!1)}});Ext.reg("base_leave_types_selector_panel",AT.BaseLeavesSelectorPanel);Ext.namespace("AT.form");
AT.form.DateField=Ext.extend(Ext.form.DateField,{isTriggerClicked:!1,datepreparser:parseDate,rawFormat:"",weekStartDay:1,scheduleCalculator:null,onTriggerClick:function(){this.disabled||(this.isTriggerClicked?(this.isTriggerClicked=!1,this.focus()):(null==this.menu&&(this.menu=new AT.menu.DatePickerMenu({minDate:this.minValue,maxDate:this.maxValue,disabledDatesRE:this.ddMatch,disabledDatesText:this.disabledDatesText,disabledDays:this.disabledDays,disabledDaysText:this.disabledDaysText,format:this.format,
showToday:this.showToday,minText:String.format(this.minText,this.formatDate(this.minValue)),maxText:String.format(this.maxText,this.formatDate(this.maxValue)),scheduleCalculator:this.scheduleCalculator,startDay:this.weekStartDay})),this.menu.on(Ext.apply({},this.menuListeners,{scope:this})),this.valueBeforePickerShown=this.getValue(),this.menu.picker.setValue(this.getValue()||currentUserTime()),this.menu.show(this.el,"tl-bl?",null,""==this.getValue()?"static":"dynamic")))},onDocumentMouseDown:function(a){a.within(this.menu.picker.getEl().dom)||
this.removeTriggerHandlers();this.trigger.dom==a.target&&(this.isTriggerClicked=!0)},onEscapePress:function(a){Ext.EventObject.ESC==a.getKey()&&this.removeTriggerHandlers()},beforeBlur:function(){var a=this.prepareDate(this.getRawValue());a&&this.setValue(a)},prepareDate:function(a){return this.datepreparser(a,this.rawFormat)},removeTriggerHandlers:function(){Ext.get(Ext.isIE?document.body:document).un("mousedown",this.onDocumentMouseDown,this);Ext.get(Ext.isIE?document.body:document).un("keypress",
this.onEscapePress,this)},addTriggerHandlers:function(){Ext.get(Ext.isIE?document.body:document).on("mousedown",this.onDocumentMouseDown,this);Ext.get(Ext.isIE?document.body:document).on("keypress",this.onEscapePress,this)},menuListeners:{select:function(a,b){this.setValue(b);this.menu.wasSelectionOnHide||this.removeTriggerHandlers();this.fireEvent("select",b)},show:function(){this.addTriggerHandlers();this.onFocus()},hide:function(){var a=this.menuListeners;this.menu.un("select",a.select,this);this.menu.un("show",
a.show,this);this.menu.un("hide",a.hide,this);this.menu.wasSelectionOnHide||this.focus()},beforeshow:function(){return this.fireEvent("beforepickershow",this)},datePickerUpdate:function(a){""!=this.getValue()&&this.setRawValue(this.formatDate(a))},datePickerCancel:function(){this.setRawValue(this.formatDate(this.valueBeforePickerShown));this.removeTriggerHandlers()}}});Ext.reg("atdatefield",AT.form.DateField);function makeDateField(a,b,c,d,e,f,g,h,k){Ext.onReady(function(){var l=Ext.get(b),m=l.dom.value,n=new AT.form.DateField({el:l.dom,format:Date.convertSmartToExtDateFormat(c),rawFormat:c,altFormats:"",validationDelay:6E4,invalidClass:"",id:a,maxValue:e,maxText:f?f:"",weekStartDay:g,scheduleCalculator:k});n.enableKeyEvents=!0;n.on(d);h||n.render(a);l.dom.value=m})};Ext.namespace("AT");
AT.DateButton=Ext.extend(Ext.Button,{handleMouseEvents:!1,icoSrc:"",buttonSelector:"a:first",showToday:!0,menuAlign:"tl-bl?",overCls:"x-date-over",scheduleCalculator:null,menuListeners:{select:function(a,b){this.setValue(b)},datePickerUpdate:function(a){this.displayValue(a)},datePickerCancel:function(){this.displayValue(this.getValue())},hide:function(){this.menu.wasSelectionOnHide||this.focus();this.restoreWindowKeyDownHandler()},show:function(){this.setWindowKeyDownHandler()}},internalFormat:new DateFormat("yyyy-MM-dd"),
initComponent:function(){AT.DateButton.superclass.initComponent.call(this);this.internalText=new Ext.form.Hidden({renderTo:this.renderTo,name:this.name+".internalText"});this.userText=new Ext.form.Hidden({renderTo:this.renderTo,name:this.name+".userText"});this.menu=new AT.menu.DatePickerMenu({minDate:this.minValue,maxDate:this.maxValue,format:this.format,showToday:this.showToday,scheduleCalculator:this.scheduleCalculator,startDay:this.weekStartDay});this.addEvents("change");this.menu.on(Ext.apply({},
this.menuListeners,{scope:this}))},setWindowKeyDownHandler:function(){this.escKeyMap||(this.escKeyMap=new Ext.KeyMap(Ext.getBody().parent(),{key:Ext.EventObject.ESC,fn:function(a,b){this.menu&&this.menu.hide()},scope:this,stopEvent:!0}));this.escKeyMap.enable()},restoreWindowKeyDownHandler:function(){this.escKeyMap&&this.escKeyMap.disable()},formatDate:function(a){return Ext.isDate(a)?a.dateFormat(this.format):a},showMenu:function(){this.menu&&(this.menu.picker.setValue(this.getValue()||currentUserTime()),
this.menu.show(this.el.child(this.buttonSelector).child(".x-btn-with-menu"),this.menuAlign,null,"dynamic"));return this},setValue:function(a){this.setText(this.formatDate(a));this.date&&areDatesEqual(this.date,a)||(this.date=a,this.fireEvent("change",this,a),this.internalText.setValue(this.internalFormat.formatDate(a)),this.userText.setValue(this.formatDate(a)))},displayValue:function(a){this.setText(this.formatDate(a))},getValue:function(){return this.date},setText:function(a){this.text=a;this.el&&
this.el.child("span.date-text:first-child").update(a);this.autoWidth()},onRender:function(a,b){this.template||(AT.DateButton.Template||(AT.DateButton.Template=new Ext.Template('<span><a href="#" style="text-decoration: none; cursor: pointer; display: inline-block;" class="at-date-button">','<table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="date-text-td">','    <span class="date-text">{0}</span>','</td><td style="padding-left:2px">      ','<img src="{2}" class="date-button-image"/></td></tr></tbody></table></a></span>')),
this.template=AT.DateButton.Template);var c;c=[this.text||"&#160;",this.type,this.icoSrc];c=b?this.template.insertBefore(b,c,!0):this.template.append(a,c,!0);var d=c.child(this.buttonSelector);d.on("focus",this.onFocus,this);d.on("blur",this.onBlur,this);this.initButtonEl(c,d);this.menu&&this.el.child(this.menuClassTarget).addClass("x-btn-with-menu");Ext.ButtonToggleMgr.register(this)}});Ext.reg("at_datebutton",AT.DateButton);Ext.namespace("AT");AT.DateRangeState=Ext.extend(Object,{constructor:function(a){Ext.apply(this,a)},isHasFromDate:function(){return!0},isHasToDate:function(){return!0},getFromDate:Ext.emptyFn,getToDate:Ext.emptyFn,equals:function(a,b){return this.isDatesEquals(this.isHasFromDate(),this.getFromDate(),a)&&this.isDatesEquals(this.isHasToDate(),this.getToDate(),b)},isDatesEquals:function(a,b,c){return a&&Ext.isDate(b)&&Ext.isDate(c)?b.clearTime().getTime()==c.clearTime().getTime():b==c}});
AT.CurrentMonthDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getFirstDateOfMonth().clearTime()},getToDate:function(){return currentUserTime().getLastDateOfMonth().clearTime()}});AT.CurrentMonthTillTodayDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getFirstDateOfMonth().clearTime()},getToDate:function(){return currentUserTime().clearTime()}});
AT.PreviousMonthDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().add(Date.MONTH,-1).getFirstDateOfMonth().clearTime()},getToDate:function(){return currentUserTime().add(Date.MONTH,-1).getLastDateOfMonth().clearTime()}});AT.NextMonthDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().add(Date.MONTH,1).getFirstDateOfMonth().clearTime()},getToDate:function(){return currentUserTime().add(Date.MONTH,1).getLastDateOfMonth().clearTime()}});
AT.CurrentWeekDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getWeekStartDate().clearTime()},getToDate:function(){return currentUserTime().getWeekStartDate().add(Date.DAY,6).clearTime()}});AT.CurrentWeekTillTodayDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getWeekStartDate().clearTime()},getToDate:function(){return currentUserTime().clearTime()}});
AT.NextWeekDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getWeekStartDate().add(Date.DAY,7).clearTime()},getToDate:function(){return currentUserTime().getWeekStartDate().add(Date.DAY,13).clearTime()}});AT.PreviousWeekDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getWeekStartDate().add(Date.DAY,-7).clearTime()},getToDate:function(){return currentUserTime().getWeekStartDate().add(Date.DAY,-1).clearTime()}});
AT.CurrentAndPreviousWeeksDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getWeekStartDate().add(Date.DAY,-7).clearTime()},getToDate:function(){return currentUserTime().getWeekStartDate().add(Date.DAY,6).clearTime()}});
AT.CurrentAndTwoPreviousWeeksDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getWeekStartDate().add(Date.DAY,-14).clearTime()},getToDate:function(){return currentUserTime().getWeekStartDate().add(Date.DAY,6).clearTime()}});AT.FirstHalfOfCurrentMonthState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getFirstDateOfMonth().clearTime()},getToDate:function(){return currentUserTime().getFirstDateOfMonth().add(Date.DAY,14).clearTime()}});
AT.SecondHalfOfCurrentMonthState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getFirstDateOfMonth().add(Date.DAY,15).clearTime()},getToDate:function(){return currentUserTime().getLastDateOfMonth().clearTime()}});AT.SecondHalfOfPreviousMonthState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().add(Date.MONTH,-1).getFirstDateOfMonth().add(Date.DAY,15).clearTime()},getToDate:function(){return currentUserTime().add(Date.MONTH,-1).getLastDateOfMonth().clearTime()}});
AT.Last7DaysDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().add(Date.DAY,-6).clearTime()},getToDate:function(){return currentUserTime().clearTime()}});AT.Last14DaysDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().add(Date.DAY,-13).clearTime()},getToDate:function(){return currentUserTime().clearTime()}});
AT.Last21DaysDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().add(Date.DAY,-20).clearTime()},getToDate:function(){return currentUserTime().clearTime()}});AT.CurrentYearDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return new Date(currentUserTime().getFullYear(),0,1)},getToDate:function(){return(new Date(currentUserTime().getFullYear()+1,0,1)).add(Date.DAY,-1)}});AT.CurrentYearDateRangeStateInstance=new AT.CurrentYearDateRangeState;
AT.CurrentAndNextYearDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return new Date(currentUserTime().getFullYear(),0,1)},getToDate:function(){return(new Date(currentUserTime().getFullYear()+2,0,1)).add(Date.DAY,-1)}});AT.NextYearDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return new Date(currentUserTime().getFullYear()+1,0,1)},getToDate:function(){return(new Date(currentUserTime().getFullYear()+2,0,1)).add(Date.DAY,-1)}});
AT.CurrentYearTillTodayDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return new Date(currentUserTime().getFullYear(),0,1)},getToDate:function(){return currentUserTime().clearTime()}});AT.PreviousYearDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return new Date(currentUserTime().getFullYear()-1,0,1)},getToDate:function(){return(new Date(currentUserTime().getFullYear(),0,1)).add(Date.DAY,-1)}});
AT.DayDateState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return new Date(1970,0,1)}});AT.TodayDateState=Ext.extend(AT.DayDateState,{getToDate:function(){return currentUserTime().clearTime()}});AT.YesterdayDateState=Ext.extend(AT.DayDateState,{getToDate:function(){return currentUserTime().add(Date.DAY,-1).clearTime()}});
AT.LastWeekDayDateState=Ext.extend(AT.DayDateState,{dayOfWeek:-1,getToDate:function(){var a=currentUserTime(),b=this.dayOfWeek-a.getDay();0<=b&&(b-=7);return a.add(Date.DAY,b).clearTime()}});AT.LastSundayDateState=Ext.extend(AT.LastWeekDayDateState,{dayOfWeek:0});AT.LastMondayDateState=Ext.extend(AT.LastWeekDayDateState,{dayOfWeek:1});AT.LastTuesdayDateState=Ext.extend(AT.LastWeekDayDateState,{dayOfWeek:2});AT.LastWednesdayDateState=Ext.extend(AT.LastWeekDayDateState,{dayOfWeek:3});
AT.LastThursdayDateState=Ext.extend(AT.LastWeekDayDateState,{dayOfWeek:4});AT.LastFridayDateState=Ext.extend(AT.LastWeekDayDateState,{dayOfWeek:5});AT.LastSaturdayDateState=Ext.extend(AT.LastWeekDayDateState,{dayOfWeek:6});AT.EndOfThePreviousMonthDateState=Ext.extend(AT.DayDateState,{getToDate:function(){return currentUserTime().getFirstDateOfMonth().add(Date.DAY,-1).clearTime()}});AT.BeginningOfTheCurrentMonthDateState=Ext.extend(AT.DayDateState,{getToDate:function(){return currentUserTime().getFirstDateOfMonth().clearTime()}});
AT.CurrentAndNextMonthDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().getFirstDateOfMonth().clearTime()},getToDate:function(){return currentUserTime().add(Date.MONTH,1).getLastDateOfMonth().clearTime()}});AT.NextTwoMonthsDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){return currentUserTime().add(Date.MONTH,1).getFirstDateOfMonth().clearTime()},getToDate:function(){return currentUserTime().add(Date.MONTH,2).getLastDateOfMonth().clearTime()}});
AT.SomeWeeksAheadDateRangeState=Ext.extend(AT.DateRangeState,{countOfWeeks:0,getFromDate:function(){return currentUserTime().clearTime()},getToDate:function(){return currentUserTime().add(Date.DAY,7*this.countOfWeeks-1).clearTime()}});AT.getQuarter=function(a){return a/3>>0};AT.getQuarterFirstMonth=function(a){return 3*AT.getQuarter(a)};AT.getPreviousQuarterFirstMonth=function(a){a-=3;return 0>a?9:AT.getQuarterFirstMonth(a)};
AT.CurrentQuarterDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){var a=currentUserTime();a.setMonth(AT.getQuarterFirstMonth(a.getMonth()),1);return a.clearTime()},getToDate:function(){var a=currentUserTime();a.setMonth(AT.getQuarterFirstMonth(a.getMonth())+2,1);return a.getLastDateOfMonth().clearTime()}});
AT.PreviousQuarterDateRangeState=Ext.extend(AT.DateRangeState,{getFromDate:function(){var a=currentUserTime();a.setMonth(AT.getPreviousQuarterFirstMonth(a.getMonth()),1);return a.clearTime()},getToDate:function(){var a=currentUserTime();a.setMonth(AT.getPreviousQuarterFirstMonth(a.getMonth())+2,1);return a.getLastDateOfMonth().clearTime()}});Ext.namespace("AT");
AT.DateRangeSelectorState=Ext.extend(Object,{constructor:function(a){Ext.apply(this,a);this.title||(this.title=messageResource.getMessage(this.id))},itemTextTemplate:new Ext.Template('<span class="rangeItem" style="{2}">','<div class="rangeItemComment">{1}</div>','<div class="rangeItemTitle">{0}</div>',"</span>"),createItem:function(a){var b=this.title?this.title:"",c=this.describe?this.describe():"";a=new Ext.menu.CheckItem({text:this.itemTextTemplate.apply([b,c,this.style?this.style:""]),checked:this===
a,group:this.radioGroup,state:this});a.on("click",this.clickHandler,this.handlerScope);return a}});AT.DateRangeSelectorImageMenuItem=Ext.extend(AT.DateRangeSelectorState,{constructor:function(a){this.style="background-image: url("+atImgPath(this.imgSrc)+");";AT.DateRangeSelectorState.call(this,a)}});AT.DateRangeSelectorSeparator={createItem:function(){return new Ext.menu.Separator}};
var daysFmt=new DateFormat("MMMM dd"),daysYearFmt=new DateFormat("MMMM dd, yyyy"),monthFmt=new DateFormat("MMMM, yyyy"),shortMonthFmt=new DateFormat("MMMM"),describeDate=function(){return daysFmt.formatDate(this.range.getToDate())},describeDaysRange=function(){return daysFmt.formatDate(this.range.getFromDate())+" &ndash; "+daysFmt.formatDate(this.range.getToDate())},describeMonthRange=function(){return monthFmt.formatDate(this.range.getFromDate())},describeYearRange=function(){return this.range.getFromDate().getFullYear()},
describeTwoMonthsRange=function(){return shortMonthFmt.formatDate(this.range.getFromDate())+", "+shortMonthFmt.formatDate(this.range.getToDate())},describeDaysYearRange=function(){return daysFmt.formatDate(this.range.getFromDate())+" &ndash; "+daysYearFmt.formatDate(this.range.getToDate())};AT.CurrentMonthMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.CurrentMonthDateRangeState,describe:describeMonthRange,id:DateRangeStateUtil.CURRENT_MONTH,value:DateRangeSelectionQualifier.CURRENT_MONTH});
AT.CurrentMonthTillTodayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.CurrentMonthTillTodayDateRangeState,describe:describeDaysRange,id:DateRangeStateUtil.CURRENT_MONTH_TILL_TODAY,value:DateRangeSelectionQualifier.CURRENT_MONTH_TILL_TODAY});AT.NextMonthMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.NextMonthDateRangeState,describe:describeMonthRange,id:DateRangeStateUtil.NEXT_MONTH,value:DateRangeSelectionQualifier.NEXT_MONTH});
AT.PreviousMonthMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.PreviousMonthDateRangeState,describe:describeMonthRange,id:DateRangeStateUtil.PREVIOUS_MONTH,value:DateRangeSelectionQualifier.PREVIOUS_MONTH});AT.CurrentWeekMenuItem=Ext.extend(AT.DateRangeSelectorImageMenuItem,{range:new AT.CurrentWeekDateRangeState,imgSrc:"date_range_selector/current-week.gif",id:DateRangeStateUtil.CURRENT_WEEK,value:DateRangeSelectionQualifier.CURRENT_WEEK});
AT.CurrentWeekTillTodayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.CurrentWeekTillTodayDateRangeState,describe:describeDaysRange,id:DateRangeStateUtil.CURRENT_WEEK_TILL_TODAY,value:DateRangeSelectionQualifier.CURRENT_WEEK_TILL_TODAY});AT.NextWeekMenuItem=Ext.extend(AT.DateRangeSelectorImageMenuItem,{range:new AT.NextWeekDateRangeState,imgSrc:"date_range_selector/next-week.gif",id:DateRangeStateUtil.NEXT_WEEK,value:DateRangeSelectionQualifier.NEXT_WEEK});
AT.PreviousWeekMenuItem=Ext.extend(AT.DateRangeSelectorImageMenuItem,{range:new AT.PreviousWeekDateRangeState,imgSrc:"date_range_selector/previous-week-wide.gif",id:DateRangeStateUtil.PREVIOUS_WEEK,value:DateRangeSelectionQualifier.PREVIOUS_WEEK});AT.CurrentAndPreviousWeeksMenuItem=Ext.extend(AT.DateRangeSelectorImageMenuItem,{range:new AT.CurrentAndPreviousWeeksDateRangeState,imgSrc:"date_range_selector/current-and-previous-weeks.gif",id:DateRangeStateUtil.CURRENT_AND_PREVIOUS_WEEK,value:DateRangeSelectionQualifier.CURRENT_AND_PREVIOUS_WEEK});
AT.CurrentAndTwoPreviousWeeksMenuItem=Ext.extend(AT.DateRangeSelectorImageMenuItem,{range:new AT.CurrentAndTwoPreviousWeeksDateRangeState,imgSrc:"date_range_selector/current-and-two-previous-weeks.gif",id:DateRangeStateUtil.CURRENT_AND_TWO_PREVIOUS_WEEKS,value:DateRangeSelectionQualifier.CURRENT_AND_TWO_PREVIOUS_WEEKS});
AT.FirstHalfOfCurrentMonthMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.FirstHalfOfCurrentMonthState,describe:describeDaysRange,id:DateRangeStateUtil.FIRST_HALF_OF_CURRENT_MONTH,value:null});AT.SecondHalfOfCurrentMonthMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.SecondHalfOfCurrentMonthState,describe:describeDaysRange,id:DateRangeStateUtil.SECOND_HALF_OF_CURRENT_MONTH,value:null});
AT.SecondHalfOfPreviousMonthMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.SecondHalfOfPreviousMonthState,describe:describeDaysRange,id:DateRangeStateUtil.SECOND_HALF_OF_PREVIOUS_MONTH,value:null});AT.Last7DaysMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.Last7DaysDateRangeState,describe:describeDaysRange,id:DateRangeStateUtil.LAST_7_DAYS,value:DateRangeSelectionQualifier.LAST_7_DAYS});
AT.Last14DaysMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.Last14DaysDateRangeState,describe:describeDaysRange,id:DateRangeStateUtil.LAST_14_DAYS,value:DateRangeSelectionQualifier.LAST_14_DAYS});AT.Last21DaysMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.Last21DaysDateRangeState,describe:describeDaysRange,id:DateRangeStateUtil.LAST_21_DAYS,value:DateRangeSelectionQualifier.LAST_21_DAYS});
AT.CurrentYearMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.CurrentYearDateRangeState,describe:describeYearRange,id:DateRangeStateUtil.CURRENT_YEAR,value:DateRangeSelectionQualifier.CURRENT_YEAR});AT.CurrentAndNextYearMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.CurrentAndNextYearDateRangeState,describe:describeYearRange,id:DateRangeStateUtil.CURRENT_AND_NEXT_YEAR,value:DateRangeSelectionQualifier.CURRENT_AND_NEXT_YEAR});
AT.NextYearMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.NextYearDateRangeState,describe:describeYearRange,id:DateRangeStateUtil.NEXT_YEAR,value:DateRangeSelectionQualifier.NEXT_YEAR});AT.CurrentYearTillTodayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.CurrentYearTillTodayDateRangeState,describe:describeDaysRange,id:DateRangeStateUtil.CURRENT_YEAR_TILL_TODAY,value:DateRangeSelectionQualifier.CURRENT_YEAR_TILL_TODAY});
AT.PreviousYearMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.PreviousYearDateRangeState,describe:describeYearRange,id:DateRangeStateUtil.PREVIOUS_YEAR,value:DateRangeSelectionQualifier.PREVIOUS_YEAR});AT.TodayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.TodayDateState,describe:describeDate,id:DateType.TODAY,value:EvaDateQualifier.TODAY});
AT.YesterdayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.YesterdayDateState,describe:describeDate,id:DateType.YESTERDAY,value:EvaDateQualifier.YESTERDAY});AT.LastMondayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.LastMondayDateState,describe:describeDate,id:DateType.LAST_MONDAY,value:EvaDateQualifier.LAST_MONDAY});AT.LastTuesdayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.LastTuesdayDateState,describe:describeDate,id:DateType.LAST_TUESDAY,value:EvaDateQualifier.LAST_TUESDAY});
AT.LastWednesdayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.LastWednesdayDateState,describe:describeDate,id:DateType.LAST_WEDNESDAY,value:EvaDateQualifier.LAST_WEDNESDAY});AT.LastThursdayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.LastThursdayDateState,describe:describeDate,id:DateType.LAST_THURSDAY,value:EvaDateQualifier.LAST_THURSDAY});
AT.LastFridayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.LastFridayDateState,describe:describeDate,id:DateType.LAST_FRIDAY,value:EvaDateQualifier.LAST_FRIDAY});AT.LastSaturdayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.LastSaturdayDateState,describe:describeDate,id:DateType.LAST_SATURDAY,value:EvaDateQualifier.LAST_SATURDAY});AT.LastSundayMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.LastSundayDateState,describe:describeDate,id:DateType.LAST_SUNDAY,value:EvaDateQualifier.LAST_SUNDAY});
AT.EndOfThePreviousMonthMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.EndOfThePreviousMonthDateState,describe:describeDate,id:DateType.END_OF_THE_PREVIOUS_MONTH,value:EvaDateQualifier.END_OF_PREVIOUS_MONTH});AT.BeginningOfTheCurrentMonthMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.BeginningOfTheCurrentMonthDateState,describe:describeDate,id:DateType.BEGINNING_OF_THE_CURRENT_MONTH,value:EvaDateQualifier.BEGINNING_OF_CURRENT_MONTH});
AT.CurrentAndNextMonthMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.CurrentAndNextMonthDateRangeState,describe:describeTwoMonthsRange,id:DateRangeStateUtil.CURRENT_AND_NEXT_MONTH,value:null});AT.NextTwoMonthsMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.NextTwoMonthsDateRangeState,describe:describeTwoMonthsRange,id:DateRangeStateUtil.NEXT_TWO_MONTHS,value:null});
AT.EightWeeksAheadMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.SomeWeeksAheadDateRangeState({countOfWeeks:8}),describe:describeDaysRange,id:DateRangeStateUtil.EIGHT_WEEKS_AHEAD,value:null});AT.TenWeeksAheadMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.SomeWeeksAheadDateRangeState({countOfWeeks:10}),describe:describeDaysRange,id:DateRangeStateUtil.TEN_WEEKS_AHEAD,value:null});
AT.TwelveWeeksAheadMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.SomeWeeksAheadDateRangeState({countOfWeeks:12}),describe:describeDaysRange,id:DateRangeStateUtil.TWELVE_WEEKS_AHEAD,value:null});AT.CustomDateRangeMenuItem=Ext.extend(AT.DateRangeSelectorState,{describe:function(){return""},custom:!0,id:DateRangeStateUtil.CUSTOM,value:DateRangeSelectionQualifier.CUSTOM});
AT.CustomDateMenuItem=Ext.extend(AT.DateRangeSelectorState,{describe:function(){return""},custom:!0,id:DateType.CUSTOM_DATE,value:EvaDateQualifier.CUSTOM});AT.CurrentQuarterMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.CurrentQuarterDateRangeState,describe:describeDaysYearRange,id:DateRangeStateUtil.CURRENT_QUARTER,value:DateRangeSelectionQualifier.CURRENT_QUARTER});
AT.PreviousQuarterMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.PreviousQuarterDateRangeState,describe:describeDaysYearRange,id:DateRangeStateUtil.PREVIOUS_QUARTER,value:DateRangeSelectionQualifier.PREVIOUS_QUARTER});AT.CurrentWeekNoImgMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.CurrentWeekDateRangeState,describe:describeDaysYearRange,id:DateRangeStateUtil.CURRENT_WEEK,value:DateRangeSelectionQualifier.CURRENT_WEEK});
AT.PreviousWeekNoImgMenuItem=Ext.extend(AT.DateRangeSelectorState,{range:new AT.PreviousWeekDateRangeState,describe:describeDaysYearRange,id:DateRangeStateUtil.PREVIOUS_WEEK,value:DateRangeSelectionQualifier.PREVIOUS_WEEK});Ext.namespace("AT");
AT.RoundedBox=Ext.extend(Ext.Container,{straightBorder:null,initComponent:function(){AT.RoundedBox.superclass.initComponent.call(this);this.template="right"==this.straightBorder?this.templateRoundLeft:"left"==this.straightBorder?this.templateRoundRight:this.templateRoundBoth},onRender:function(a,b){arguments=[this.cls];this.el=b?this.template.insertBefore(b,arguments,!0):this.template.append(a,arguments,!0);this.el.id||(this.el.id=this.getId())},getLayoutTarget:function(){return this.el.child(".i")},templateRoundBoth:new Ext.Template('<div class="roundedBoxTag {0}" ><div class="i"></div></div>'),
templateRoundLeft:new Ext.Template('<div class="roundedBoxTag  straightBorder-right {0}" ><div class="i"></div></div>'),templateRoundRight:new Ext.Template('<div class="roundedBoxTag  straightBorder-left {0}" ><div class="i"></div></div>')});Ext.reg("at_rounded_box",AT.RoundedBox);function FieldController(){}FieldController.LABEL_ERROR_CLASS="field-label-error";FieldController.prototype.init=function(a){this.initField(a,!0)};
FieldController.prototype.initField=function(a,b){this.fieldElement=document.getElementById(a);this.defaultMaxlength=this.fieldElement.getAttribute("maxlength");this.defaultValue=this.fieldElement.value;this.emptyCaptionShown=!1;this.fieldElement.controller=this;var c=this;b&&(this.addListener("focus",function(){c.hideGrayTextIfShown()}),this.addListener("blur",function(){c.fireBlur();c.fieldElement.value!=c.defaultValue&&c.fireChange();c.showGreyTextIfEmpty()}));this.addListener("keydown",function(){c.fireChange()});
this.addListener("change",function(){c.fieldElement.value!=c.defaultValue&&c.fireChange();b&&c.showGreyTextIfEmpty()});b&&this.showGreyTextIfEmpty()};FieldController.prototype.setDefaultValueIfNeeded=function(){this.isEmpty()&&(this.fieldElement.defaultValue=this.emptyCaption)};FieldController.prototype.onChangeHandler=void 0;FieldController.prototype.onBlurHandler=void 0;FieldController.prototype.emptyCaption="";FieldController.prototype.emptyCaptionStyleClass="emptyCaption";
FieldController.prototype.hideGrayText=function(){this.fieldElement.value="";null!=this.defaultMaxlength&&this.fieldElement.setAttribute("maxlength",this.defaultMaxlength);this.fieldElement.className="";this.fieldElement.spellcheck=!0;this.emptyCaptionShown=!1};FieldController.prototype.hideGrayTextIfShown=function(){this.emptyCaptionShown&&this.hideGrayText()};
FieldController.prototype.showGreyText=function(a){this.fieldElement.className=this.emptyCaptionStyleClass;null!=this.defaultMaxlength&&this.fieldElement.setAttribute("maxlength",this.emptyCaption.length);this.fieldElement.value=a?a:this.emptyCaption;this.fieldElement.spellcheck=!1;this.emptyCaptionShown=!0};FieldController.prototype.showGreyTextIfEmpty=function(){this.isEmpty()&&this.showGreyText()};FieldController.prototype.isEmpty=function(){return this.emptyCaptionShown||0==trim(this.fieldElement.value).length};
FieldController.prototype.addListener=function(a,b){this.fieldElement.addEventListener?this.fieldElement.addEventListener(a,b,!1):this.fieldElement.attachEvent("on"+a,b)};FieldController.prototype.fireChange=function(){if(this.onChangeHandler)this.onChangeHandler(this)};FieldController.prototype.fireBlur=function(){if(this.onBlurHandler)this.onBlurHandler(this)};FieldController.prototype.getValue=function(){return this.isEmpty()?"":getStringWithUnifiedNewLineSymbol(this.fieldElement.value)};
FieldController.prototype.setValue=function(a){this.fieldElement.value=a};FieldController.prototype.getElement=function(){return this.fieldElement};FieldController.prototype.setDisabled=function(a){this.fieldElement.disabled=a};FieldController.prototype.isModified=function(){return trim(this.fieldElement.value)!=trim(this.fieldElement.defaultValue)};function SecureFieldController(){FieldController.call(this)}SecureFieldController.prototype=new FieldController;SecureFieldController.prototype.init=function(a){FieldController.prototype.init.call(this,a);this.isEmpty()||(this.getElement().value=this.decode(this.getElement().value),this.getElement().defaultValue=this.getElement().value)};SecureFieldController.prototype.getValue=function(){return this.encode(FieldController.prototype.getValue.call(this))};
SecureFieldController.prototype.encode=function(a){return Base64.encode(a,!1)};SecureFieldController.prototype.decode=function(a){return Base64.decode(a,!1)};SecureFieldController.prototype.encodeFieldValue=function(){this.setValue(this.getValue())};SecureFieldController.prototype.encodeFieldValueMD5=function(){this.setValue(MD5(FieldController.prototype.getValue.call(this)))};SecureFieldController.prototype.getPlainTextValue=function(){return FieldController.prototype.getValue.call(this)};function EnhancedFieldController(){FieldController.call(this)}EnhancedFieldController.prototype=new FieldController;EnhancedFieldController.prototype.hideGrayText=function(){this.fieldElement.value="";null!=this.defaultMaxlength&&this.fieldElement.setAttribute("maxlength",this.defaultMaxlength);removeClass(this.fieldElement,this.emptyCaptionStyleClass);this.fieldElement.spellcheck=!0;this.emptyCaptionShown=!1};
EnhancedFieldController.prototype.showGreyText=function(a){addClass(this.fieldElement,this.emptyCaptionStyleClass);null!=this.defaultMaxlength&&this.fieldElement.setAttribute("maxlength",this.emptyCaption.length);this.fieldElement.value=a?a:this.emptyCaption;this.fieldElement.spellcheck=!1;this.emptyCaptionShown=!0};EnhancedFieldController.prototype.isEmpty=function(){return this.emptyCaptionShown||0==trim(this.fieldElement.value).length};function UserScheduleCalculator(){this.constructor=UserScheduleCalculator}UserScheduleCalculator.prototype=new ScheduleCalculator;UserScheduleCalculator.prototype.init=function(a,b,c){b={durations:b};c=c.slice();c.unshift(b);ScheduleCalculator.prototype.init.call(this,a,c);return this};function createLayoutCalendar(a,b,c,d,e,f,g,h){return new Calendar(a,b,"","",c,d,e,!1,f,g,h)}var Calendar_calendarTableOut=function(a){},Calendar_calendarTableOver=function(a){};
function Calendar(a,b,c,d,e,f,g,h,k,l,m){this.weekDays=[];this.scheduleCalculator=l;this.headerDayDurations=m;this.callbackFunc=g;this.inPopup=h;this.onmouseOverHandler="Calendar_highlightCell(this, event)";this.onmouseOutHandler="Calendar_unhighlightCell(this, event)";this.months="January February March April May June July August September October November December".split(" ");this.weekStartDay=k-1;this.weekDays="Su Mo Tu We Th Fr Sa".split(" ");this.today=strToDate(b);this.baseDate=null==a||""==
a?this.today:strToDate(a);this.endDate=this.startDate=null;null!=c&&""!=c&&null!=d&&""!=d&&(this.startDate=strToDate(c),this.endDate=strToDate(d));this.endFrameDate=this.startFrameDate=null;null!=e&&""!=e&&null!=f&&""!=f&&(this.startFrameDate=strToDate(e),this.endFrameDate=strToDate(f));this.prevMonth=new Date(this.baseDate);this.prevMonth.setMonth(this.baseDate.getMonth()-1);this.nextMonth=new Date(this.baseDate);this.nextMonth.setMonth(this.baseDate.getMonth()+1);this.firstDay=new Date(this.baseDate);
this.firstDay.setDate(1);this.firstDay.setDate(1-(7+this.firstDay.getDay()-this.weekStartDay)%7);this.linkCurrentDay=!0;this.header=!1;this.setStyleNames("calendarWorkingDay","calendarWeekendDay");this.displayDaysOfOtherMonths=this.changeMonthIfDateOutsideCurrentMonth=!0}Calendar.DAY_BORDER_COLOR="#ffffff";Calendar.BORDER_COLOR="#b5b5b5";Calendar.CURSOR_BG_COLOR="#face00";Calendar.prototype.setMouseOverHandler=function(a){this.onmouseOverHandler=a};
Calendar.prototype.setMouseOutHandler=function(a){this.onmouseOutHandler=a};function Calendar_isWeekend(a){var b=a.firstChild;return b&&"SPAN"==b.nodeName?-1!=b.className.indexOf("Weekend"):"calendarWeekendDay"==a.className}Calendar.prototype.isWeekend=Calendar_isWeekend;
var Calendar_highlightCell=function(a){a.style.backgroundColor=Calendar.CURSOR_BG_COLOR;try{a.style.cursor="pointer"}catch(b){}},Calendar_unhighlightCell=function(a){try{a.style.cursor=""}catch(b){}Calendar_isWeekend(a);a.style.backgroundColor="";a.style.borderColor=""};
function Calendar_setCellStyle(a,b){b?replaceClass(a,"calendarWorkingDay","calendarWeekendDay"):replaceClass(a,"calendarWeekendDay","calendarWorkingDay");var c=a.firstChild;c&&"SPAN"==c.nodeName&&(-1!=c.className.indexOf("CurrentMonth")?c.className=b?"calendarCurrentMonthWeekendDay":"calendarCurrentMonthWorkingDay":c.className=b?"calendarOtherMonthWeekendDay":"calendarOtherMonthWorkingDay")}Calendar.prototype.openPopup=function(a,b,c){a=window.open("",a,b);a.opener=self;a.document.write(c);a.document.close()};
function TableElement(a,b,c,d,e){this.text=a;this.style=b;this.textStyle=c;this.link=d;this.hasFrame=e}
Calendar.prototype.getCalendarHTML=function(){for(var a=[[]],b=0;7>b;b++)wd=(this.weekStartDay+b)%7,h=0==this.headerDayDurations[wd]?"calendarWeekendDayHeader":"calendarWorkingDayHeader",a[0][b]=new TableElement(this.weekDays[wd],h,null,null,!1);h=new Date(this.nextMonth);h.setDate(6);for(var b=this.scheduleCalculator.getEffectiveSchedule(this.firstDay,h),c=0,d=1,e=new Date(this.firstDay);e.getMonth()==this.baseDate.getMonth()||e.getMonth()==this.firstDay.getMonth();){a[d]=[];for(var f=0;7>f;f++){var g,
h,k,l,m=null!=this.startFrameDate&&null!=this.endFrameDate&&e.getTime()>=this.startFrameDate.getTime()&&e.getTime()<=this.endFrameDate.getTime();l=e.getFullYear()==this.today.getFullYear()&&e.getMonth()==this.today.getMonth()&&e.getDate()==this.today.getDate();k=0==b[c++];this.displayDaysOfOtherMonths||e.getMonth()==this.baseDate.getMonth()?(h=k?this.nonWorkDayStyle:this.workDayStyle,l&&(h+=" calendarCurrentDay"),k=e.getMonth()==this.baseDate.getMonth()?k?"calendarCurrentMonthWeekendDay":"calendarCurrentMonthWorkingDay":
k?"calendarOtherMonthWeekendDay":"calendarOtherMonthWorkingDay",g=e.getDate(),1!=l||1==l&&1==this.linkCurrentDay?(l=dateToStr(this.validDay(e)),l=this.inPopup?"javascript: window.opener."+this.callbackFunc+"('"+l+"', this);window.close();":"javascript: if(typeof "+this.callbackFunc+" != typeof undefined){"+this.callbackFunc+"('"+l+"', this);}"):l=null,a[d][f]=new TableElement(g,h,k,l,m)):(g="&nbsp;",h="calendarEmptyDayCell",k=k?"calendarOtherMonthWeekendDay":"calendarOtherMonthWorkingDay",a[d][f]=
new TableElement(g,h,k,null,m));e.setDate(e.getDate()+1)}d++}h=""+("<table id='calendar_table' width=\"100%\" border=0 bgcolor="+Calendar.BORDER_COLOR+" cellspacing=1 cellpadding=0 class=calendarTable");this.highliteFrame&&(h+=" onmouseout='if (typeof Calendar_calendarTableOut != typeof undefined) Calendar_calendarTableOut(event)' onmouseover='if (typeof Calendar_calendarTableOver != typeof undefined) Calendar_calendarTableOver(event, this)'");h+=">";this.header&&(h+='<tr><td class="currentMonthHeader" colspan="7" align="center">'+
this.getMonthLabel()+", "+this.getYearLabel()+"</td>");this.weeksCount=a.length;for(b=0;b<a.length;b++)h+=this.getCalendarRowHTML(a,b);return h=h+"</table>"+("<div id='calendar_frame' style='padding:0 0 0 0; margin:0 0 0 0; cursor:pointer;display:none;position:absolute;z-index:1001;border-style:solid;border-color:"+Calendar.CURSOR_BG_COLOR+";' ></div>")};
Calendar.prototype.validDay=function(a){return this.changeMonthIfDateOutsideCurrentMonth?a:a.getMonth()<this.baseDate.getMonth()&&a.getFullYear()==this.baseDate.getFullYear()||a.getFullYear()<this.baseDate.getFullYear()?new Date(this.baseDate.getFullYear(),this.baseDate.getMonth(),1):a.getMonth()>this.baseDate.getMonth()&&a.getFullYear()==this.baseDate.getFullYear()||a.getFullYear()>this.baseDate.getFullYear()?new Date(this.baseDate.getFullYear(),this.baseDate.getMonth(),this.getMaxDayOfMonth(this.baseDate.getFullYear(),
this.baseDate.getMonth())):a};Calendar.prototype.getMaxDayOfMonth=function(a,b){switch(b){case 0:case 2:case 4:case 6:case 7:case 9:case 11:return 31;case 3:case 5:case 8:case 10:case 7:case 9:case 11:return 30;case 1:return 0==a%4&&0!=a%100||0==a%400?29:28}};
Calendar.prototype.getCalendarRowHTML=function(a,b){for(var c=this.highliteFrame&&0!=b?"<tr id='calendar_row_"+b+"' onmouseover='"+this.onmouseOverHandler+"' onmouseout='"+this.onmouseOutHandler+"'>":"<tr id='calendar_row_0'>",d=0;7>d;d++){var e=a[b][d],f=e.text,c=c+("<td "+(" class='"+e.style+"'"));e.link&&(c+=' onclick="'+e.link+'"');var g;a[b][d].hasFrame&&(g=Calendar.CURSOR_BG_COLOR,g=0==d?"padding:1px 2px 1px 1px; border-width: 2px 0px 2px 2px; border-color:"+g+" "+Calendar.DAY_BORDER_COLOR+
" "+g+" "+g+";":6==d?"padding:1px 1px 1px 2px; border-width: 2px 2px 2px 0px; border-color:"+g+" "+g+" "+g+" "+Calendar.DAY_BORDER_COLOR:"padding:1px 2px 1px 2px; border-width: 2px 0px 2px 0px; border-color:"+g+" "+Calendar.DAY_BORDER_COLOR+" "+g+" "+Calendar.DAY_BORDER_COLOR,c+=" style='"+g+"'id='Calendar_frameElement'");e.link&&!this.highliteFrame&&(c+=" onmouseover='"+this.onmouseOverHandler+"' onmouseout='"+this.onmouseOutHandler+"'");c+=">";c=e.textStyle?c+("<span class='"+e.textStyle+"'>"+f+
"</span></td>"):c+(f+"</td>")}return c+"</tr>"};Calendar.prototype.setMonths=function(a){this.months=a};Calendar.prototype.setHeader=function(a){this.header=a};Calendar.prototype.setLinkCurrentDay=function(a){this.linkCurrentDay=a};Calendar.prototype.setWeekDays=function(a){this.weekDays=a};Calendar.prototype.setDisplayDaysOfOtherMonths=function(a){this.displayDaysOfOtherMonths=a};Calendar.prototype.getCallback=function(){return this.callbackFunc};Calendar.prototype.getMonthLabel=function(){return this.months[this.baseDate.getMonth()]};
Calendar.prototype.getYearLabel=function(){return this.baseDate.getFullYear()};Calendar.prototype.setStyleNames=function(a,b){this.workDayStyle=a;this.nonWorkDayStyle=b};Calendar.prototype.getTodayDay=function(){return this.today.getDate()};Calendar.prototype.getTodayMonth=function(){return this.months[this.today.getMonth()]};Calendar.prototype.getTodayMonthNumber=function(){return this.today.getMonth()};Calendar.prototype.getTodayYear=function(){return this.today.getFullYear()};
Calendar.prototype.getCurrentDay=function(){return this.baseDate.getDate()};Calendar.prototype.getCurrentMonth=function(){return this.months[this.baseDate.getMonth()]};Calendar.prototype.getCurrentMonthNumber=function(){return this.baseDate.getMonth()};Calendar.prototype.getCurrentYear=function(){return this.baseDate.getFullYear()};Calendar.prototype.getNextMonth=function(){return this.months[this.prevMonth]};Calendar.prototype.getPrevMonth=function(){return this.months[this.nextMonth]};
Calendar.prototype.getNextMonthNumber=function(){return this.months[this.prevMonth]};Calendar.prototype.getPrevMonthNumber=function(){return this.months[this.nextMonth]};Calendar.prototype.getCustomDateURL=function(a,b,c){return"javascript:window.opener.showCalendar('"+a+"-"+b+"-"+c+"', '"+dateToStr(this.today)+"', "+this.startDate.getFullYear()+", "+this.endDate.getFullYear()+", '"+this.callbackFunc+"');"};
Calendar.prototype.getCustomDateJS=function(a,b,c){return"window.opener.showCalendar('"+a+"-"+b+"-"+c+"', '"+dateToStr(this.today)+"', "+this.startDate.getFullYear()+", "+this.endDate.getFullYear()+", '"+this.callbackFunc+"');"};Calendar.prototype.getEndDate=function(){return this.endDate};Calendar.prototype.getStartDate=function(){return this.startDate};function strToDate(a){return/^(\d+)\-(\d+)\-(\d+)$/.exec(a)?newDate(RegExp.$1,RegExp.$2-1,RegExp.$3):alert("Invalid Datetime format: "+a)}
function dateToStr(a){return String(a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate())}function getSelectedValue(a){if(a&&a.options)return a.options[a.selectedIndex].value};TitledTextDhtmlPopup.prototype=new DhtmlPopup;TitledTextDhtmlPopup.prototype.titledTextParentClass=DhtmlPopup;function TitledTextDhtmlPopup(a){this.titledTextParentClass(a);this.titleId=a+"Title";this.textId=a+"Text";this.setPositioningStrategy(new RelativePositioning)}TitledTextDhtmlPopup.prototype.getPopupTitleObject=function(){return document.getElementById(this.titleId)};TitledTextDhtmlPopup.prototype.getPopupTextObject=function(){return document.getElementById(this.textId)};
TitledTextDhtmlPopup.prototype.getPopupTextValue=function(){return""};TitledTextDhtmlPopup.prototype.isEmpty=function(){return 0==trim(this.getPopupTextValue()).length};TitledTextDhtmlPopup.prototype.restoreEventHandlers=function(){KeyDownHandler.restoreOnKeyDownHandler()};TitledTextDhtmlPopup.prototype.registerEventHandlers=function(){var a=this.getClosePopupHandler();KeyDownHandler.setOnKeyDownHandler(function(b){handleEscape(a,b)})};
TitledTextDhtmlPopup.prototype.setPopupTitle=function(a){this.getPopupTitleObject().firstChild.nodeValue=a};TitledTextDhtmlPopup.prototype.setPopupText=function(a){};TitledTextDhtmlPopup.prototype.show=function(a,b,c,d){this.setPopupTitle(a);this.setPopupText(b);this.titledTextParentClass.prototype.show.call(this,c,d)};TitledTextDhtmlPopup.prototype.update=function(a,b){this.setPopupTitle(a);this.setPopupText(b);this.scrollWindowIfNeeded()};EditableTextDhtmlPopup.prototype=new TitledTextDhtmlPopup;
EditableTextDhtmlPopup.prototype.editableTextParentClass=TitledTextDhtmlPopup;function EditableTextDhtmlPopup(a){this.editableTextParentClass(a)}EditableTextDhtmlPopup.prototype.show=function(a,b,c,d){this.editableTextParentClass.prototype.show.call(this,a,b,c,d);var e=this;window.setTimeout(function(){e.focusOnText()},10)};EditableTextDhtmlPopup.prototype.focusOnText=function(){try{this.getPopupTextObject().focus()}catch(a){}};
EditableTextDhtmlPopup.prototype.setPopupText=function(a){this.getPopupTextObject().value=a;this.focusOnText()};EditableTextDhtmlPopup.prototype.getPopupTextValue=function(){return this.getPopupTextObject().value};StaticTextDhtmlPopup.prototype=new TitledTextDhtmlPopup;StaticTextDhtmlPopup.prototype.staticTextParentClass=TitledTextDhtmlPopup;function StaticTextDhtmlPopup(a){this.staticTextParentClass(a)}
StaticTextDhtmlPopup.prototype.setPopupText=function(a){this.getPopupTextObject().innerHTML=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\n/g,"<br>")};StaticTextDhtmlPopup.prototype.setPopupTitle=function(a){this.staticTextParentClass.prototype.setPopupTitle.call(this,a);isMSIE()||(a=this.getPopupTitleObject(),a.parentNode.style.width=a.offsetWidth)};StaticTextDhtmlPopup.prototype.getPopupTextValue=function(){return this.getPopupTextObject().firstChild.nodeValue};var deadlineState,timeout=1E4,deadlinePopup=new EditableTextDhtmlPopup("deadlinePopup"),DEADLINE_TIMEOUT_SAVING_MESSAGE,ERR_TASK_WAS_DELETED_MESSAGE,ERR_CANNOT_SAVE_DEADLINE;
function DeadlineState(a,b,c){this.taskId=a;this.cell=b;this.deadline=trim(b.firstChild.innerHTML);this.deadline==messageResource.getMessage("common.not_available")&&(this.deadline="");this.state="EDITING";this.dateFormat=c;window.deadline=new SmartDate(function(){return document.getElementById("deadlinePopupText")},getParsedDeadlineHolder,c);this.turnPopupToEditingState()}DeadlineState.prototype.setState=function(a){this.state=a;"EDITING"==a?this.turnPopupToEditingState():"SAVING"==a&&this.turnPopupToSavingState()};
DeadlineState.prototype.isDeadlineModified=function(){return trim(window.deadline.getDateFieldValue())!=this.deadline};
DeadlineState.prototype.turnPopupToEditingState=function(){document.getElementById("deadlinePopupEditingState").style.display="block";document.getElementById("deadlinePopupButtons").style.display="block";document.getElementById("deadlinePopupSavingState").style.display="none";document.getElementById("closeDeadlinePopupDisabledSpan").style.display="none";document.getElementById("closeDeadlinePopupActiveSpan").style.display="block"};
DeadlineState.prototype.turnPopupToSavingState=function(){document.getElementById("deadlinePopupEditingState").style.display="none";document.getElementById("deadlinePopupButtons").style.display="none";document.getElementById("deadlinePopupSavingState").style.display="block";document.getElementById("closeDeadlinePopupActiveSpan").style.display="none";document.getElementById("closeDeadlinePopupDisabledSpan").style.display="block"};
function highlightDeadlineOnMouseOver(a){if(!isDeadlineSaving()){try{a.style.cursor="pointer"}catch(b){}deadlineState&&deadlineState.cell==a||(a.style.backgroundColor=DHTMLColors.mouseOverHighlightColor)}}function removeDeadlineHighligthing(a){if(!isDeadlineSaving()){try{a.style.cursor=""}catch(b){}deadlineState&&deadlineState.cell==a||(a.style.backgroundColor="")}}
function showDeadlinePopup(a,b,c){!isDeadlineSaving()&&closeAllPopups()&&(deadlinePopup.setAfterShowHandler(function(){b&&(b.style.backgroundColor=DHTMLColors.onClickHighlightColor)}),deadlinePopup.setAfterHideHandler(function(){ExitConfirmationHandlersManager.restoreExitConfirmation();b&&(b.style.backgroundColor="");deadlineState=null}),deadlinePopup.setBeforeHideHandler(function(){return isDeadlineSaving()?!1:deadlineState&&deadlineState.isDeadlineModified()?confirm(messageResource.getMessage("edit_deadline.modifications_not_saved")):
!0}),deadlineState=new DeadlineState(a,b,c),deadlineState.isConfirmationOnUnloadRequired=!0,ExitConfirmationHandlersManager.setUpExitConfirmation(messageResource.getMessage("edit_deadline.modifications_not_saved"),function(){return deadlineState&&deadlineState.isConfirmationOnUnloadRequired&&deadlineState.isDeadlineModified()},!1),deadlinePopup.show(messageResource.getMessage("edit_deadline.title"),deadlineState.deadline,-50,25),Ext.getCmp("deadlineFieldContainer").render())}
function isDeadlineSaving(){return deadlineState&&"SAVING"==deadlineState.state}function getParsedDeadlineHolder(){return document.getElementById("parsedDeadline")}
function deadlineSaved(a,b){if(!isDeadlineSaving())return!1;if(null!=b)return deadlineState.retryController.handleErrorOrRetry(b),!1;var c=deadlineState.cell,d=deadline.getHolderValue();if(0==d.length)c.firstChild.innerHTML=messageResource.getMessage("common.not_available"),c.firstChild.className="deadline";else{var e=deadline.parseDate(),f=new DateFormat(deadlineState.dateFormat);c.firstChild.innerHTML=f.formatDate(e);c.firstChild.className=isDeadlineInThePast(d)?"deadline_in_the_past":"deadline"}deadlineSavingCleanup(!1);
deadlinePopup.hide();return!0}function updateDeadline(a,b,c){try{if(isRpcReady(["TaskInfoService.updateDeadline"]))if(jsonrpc.TaskInfoService){var d=jsonrpc.TaskInfoService.updateDeadline(c,a,b);deadlineState&&(deadlineState.requestId=d)}else document.location.reload();else window.setTimeout(function(){updateDeadline(a,b,c)},200)}catch(e){return deadlineState&&deadlineState.retryController.handleErrorOrRetry(e),null}}
function saveDeadline(a){if(!isDeadlineSaving())if(deadline.checkDate(!0)){deadlineState.setState("SAVING");deadlineState.cell.style.backgroundColor=DHTMLColors.beingSavedColor;var b=deadline.getHolderValue();deadlineState.retryController=new RpcRetryController(timeout,function(){updateDeadline(deadlineState.taskId,b,function(b,d){deadlineSaved(b,d)&&a&&a()})},deadlineTimeoutSaving,processDeadlineSavingError);deadlineState.retryController.start()}else deadline.getDateField().focus(),setRedirectUrl(""),
doCancel()}function deadlineSavingCleanup(a){if(deadlineState&&deadlineState.retryController){deadlineState.retryController.stop();deadlinePopup.setAfterHideHandler(null);ExitConfirmationHandlersManager.restoreExitConfirmation();var b=deadlineState.cell,c=function(){removeDeadlineHighligthing(b)};deadlineState=null;deadlinePopup.hide();a?c():window.setTimeout(c,1E3)}}
function deadlineTimeoutSaving(){if(isDeadlineSaving()){if(confirm(DEADLINE_TIMEOUT_SAVING_MESSAGE)){if(!deadlineState||!deadlineState.retryController)return;deadlineState.retryController.stop();isDeadlineSaving()&&deadlineState.retryController.start()}else isDeadlineSaving()&&(deadlineState&&deadlineState.requestId&&JSONRpcClient.cancelRequest(deadlineState.requestId),jsonrpc.abortAllRequests(),deadlineSavingCleanup());jsonrpc=null}}
function processDeadlineSavingError(a){-1!=a.name.indexOf("com.actimind.actitime.services.NoRightsForRemoteCallException")?noRightsURL?document.location.href=noRightsURL:document.location.reload():-1!=a.name.indexOf("com.actimind.actitime.task.NoSuchTaskException")?(alert(ERR_TASK_WAS_DELETED_MESSAGE),document.location.reload()):(alert(ERR_CANNOT_SAVE_DEADLINE),deadlineSavingCleanup(!0))};OkCancelPopup.prototype=new DhtmlPopup;OkCancelPopup.prototype.parentClass=DhtmlPopup;function OkCancelPopup(a,b,c,d){this.errorDiv=c;this.errorTextDiv=d;this.onCancelClickHandler=this.onOkClickHandler=null;this.popupDivId=a;this.popupTableId=b;this.parentClass(a)}
OkCancelPopup.prototype.showErrorMessage=function(a){this.errorTextDiv.innerHTML=a;showElement(this.errorDiv);this.errorDiv.style.visibility="hidden";window.setTimeout("document.getElementById('"+this.errorDiv.id+"').style.visibility = 'visible'",200)};OkCancelPopup.prototype.hideErrorMessage=function(){hideElement(this.errorDiv);this.errorTextDiv.innerHTML=""};OkCancelPopup.prototype.clickOk=function(){this.okClickHandler(null)};OkCancelPopup.prototype.clickCancel=function(){this.cancelClickHandler(null)};
OkCancelPopup.prototype.okClickHandler=function(a){(null==this.onOkClickHandler||this.onOkClickHandler(a))&&this.hide()};OkCancelPopup.prototype.cancelClickHandler=function(a){(null==this.onCancelClickHandler||this.onCancelClickHandler(a))&&this.hide()};OkCancelPopup.prototype.setOnOkClickHandler=function(a){this.onOkClickHandler=a};OkCancelPopup.prototype.setOnCancelClickHandler=function(a){this.onCancelClickHandler=a};
OkCancelPopup.prototype.show=function(a,b,c,d,e){var f=this;this.parentClass.prototype.show.call(this,a,b,c,d,e);KeyDownHandler.setOnKeyDownHandler(function(a){handleEscape(function(){f.clickCancel()},a)})};OkCancelPopup.prototype.hide=function(){KeyDownHandler.restoreOnKeyDownHandler();this.hideErrorMessage();this.parentClass.prototype.hide.call(this)};var countries=[{id:"AD",name:"Andorra",phoneCodes:["376"]},{id:"AE",name:"United Arab Emirates",phoneCodes:["971"]},{id:"AF",name:"Afghanistan",phoneCodes:["93"]},{id:"AG",name:"Antigua and Barbuda",phoneCodes:["1268"]},{id:"AI",name:"Anguilla",phoneCodes:["1264"]},{id:"AL",name:"Albania",phoneCodes:["355"]},{id:"AM",name:"Armenia",phoneCodes:["374"]},{id:"AO",name:"Angola",phoneCodes:["244"]},{id:"AQ",name:"Antarctica",phoneCodes:[]},{id:"AR",name:"Argentina",phoneCodes:["54"]},{id:"AS",name:"American Samoa",
phoneCodes:["1684"]},{id:"AT",name:"Austria",phoneCodes:["43"]},{id:"AU",name:"Australia",phoneCodes:["61"]},{id:"AW",name:"Aruba",phoneCodes:["297"]},{id:"AX",name:"Aland Islands",phoneCodes:["35818"]},{id:"AZ",name:"Azerbaijan",phoneCodes:["994"]},{id:"BA",name:"Bosnia and Herzegovina",shortName:"Bosnia-Herzegovina",phoneCodes:["387"]},{id:"BB",name:"Barbados",phoneCodes:["1246"]},{id:"BD",name:"Bangladesh",phoneCodes:["880"]},{id:"BE",name:"Belgium",phoneCodes:["32"]},{id:"BF",name:"Burkina Faso",
phoneCodes:["226"]},{id:"BG",name:"Bulgaria",phoneCodes:["359"]},{id:"BH",name:"Bahrain",phoneCodes:["973"]},{id:"BI",name:"Burundi",phoneCodes:["257"]},{id:"BJ",name:"Benin",phoneCodes:["229"]},{id:"BL",name:"Saint Barthelemy",phoneCodes:["590"]},{id:"BM",name:"Bermuda",phoneCodes:["1441"]},{id:"BN",name:"Brunei",phoneCodes:["673"]},{id:"BO",name:"Bolivia",phoneCodes:["591"]},{id:"BQ",name:"Bonaire, Saint Eustatius and Saba ",shortName:"Caribbean Netherlands",phoneCodes:["599"]},{id:"BR",name:"Brazil",
phoneCodes:["55"]},{id:"BS",name:"Bahamas",phoneCodes:["1242"]},{id:"BT",name:"Bhutan",phoneCodes:["975"]},{id:"BV",name:"Bouvet Island",phoneCodes:[]},{id:"BW",name:"Botswana",phoneCodes:["267"]},{id:"BY",name:"Belarus",phoneCodes:["375"]},{id:"BZ",name:"Belize",phoneCodes:["501"]},{id:"CA",name:"Canada",phoneCodes:["1"]},{id:"CC",name:"Cocos Islands",phoneCodes:["61"]},{id:"CD",name:"Democratic Republic of the Congo",phoneCodes:["243"]},{id:"CF",name:"Central African Republic",phoneCodes:["236"]},
{id:"CG",name:"Republic of the Congo",phoneCodes:["242"]},{id:"CH",name:"Switzerland",phoneCodes:["41"]},{id:"CI",name:"Ivory Coast",phoneCodes:["225"]},{id:"CK",name:"Cook Islands",phoneCodes:["682"]},{id:"CL",name:"Chile",phoneCodes:["56"]},{id:"CM",name:"Cameroon",phoneCodes:["237"]},{id:"CN",name:"China",phoneCodes:["86"]},{id:"CO",name:"Colombia",phoneCodes:["57"]},{id:"CR",name:"Costa Rica",phoneCodes:["506"]},{id:"CU",name:"Cuba",phoneCodes:["53"]},{id:"CV",name:"Cape Verde",phoneCodes:["238"]},
{id:"CW",name:"Curacao",phoneCodes:["599"]},{id:"CX",name:"Christmas Island",phoneCodes:["61"]},{id:"CY",name:"Cyprus",phoneCodes:["357"]},{id:"CZ",name:"Czech Republic",phoneCodes:["420"]},{id:"DE",name:"Germany",phoneCodes:["49"]},{id:"DJ",name:"Djibouti",phoneCodes:["253"]},{id:"DK",name:"Denmark",phoneCodes:["45"]},{id:"DM",name:"Dominica",phoneCodes:["1767"]},{id:"DO",name:"Dominican Republic",phoneCodes:["1809","1829"]},{id:"DZ",name:"Algeria",phoneCodes:["213"]},{id:"EC",name:"Ecuador",phoneCodes:["593"]},
{id:"EE",name:"Estonia",phoneCodes:["372"]},{id:"EG",name:"Egypt",phoneCodes:["20"]},{id:"EH",name:"Western Sahara",phoneCodes:["212"]},{id:"ER",name:"Eritrea",phoneCodes:["291"]},{id:"ES",name:"Spain",phoneCodes:["34"]},{id:"ET",name:"Ethiopia",phoneCodes:["251"]},{id:"FI",name:"Finland",phoneCodes:["358"]},{id:"FJ",name:"Fiji",phoneCodes:["679"]},{id:"FK",name:"Falkland Islands",phoneCodes:["500"]},{id:"FM",name:"Micronesia",phoneCodes:["691"]},{id:"FO",name:"Faroe Islands",phoneCodes:["298"]},
{id:"FR",name:"France",phoneCodes:["33"]},{id:"GA",name:"Gabon",phoneCodes:["241"]},{id:"GB",name:"United Kingdom",phoneCodes:["44"]},{id:"GD",name:"Grenada",phoneCodes:["1473"]},{id:"GE",name:"Georgia",phoneCodes:["995"]},{id:"GF",name:"French Guiana",phoneCodes:["594"]},{id:"GG",name:"Guernsey",phoneCodes:["441481"]},{id:"GH",name:"Ghana",phoneCodes:["233"]},{id:"GI",name:"Gibraltar",phoneCodes:["350"]},{id:"GL",name:"Greenland",phoneCodes:["299"]},{id:"GM",name:"Gambia",phoneCodes:["220"]},{id:"GN",
name:"Guinea",phoneCodes:["224"]},{id:"GP",name:"Guadeloupe",phoneCodes:["590"]},{id:"GQ",name:"Equatorial Guinea",phoneCodes:["240"]},{id:"GR",name:"Greece",phoneCodes:["30"]},{id:"GS",name:"South Georgia and the South Sandwich Islands",shortName:"South Georgia and South Sandwich Islands",phoneCodes:[]},{id:"GT",name:"Guatemala",phoneCodes:["502"]},{id:"GU",name:"Guam",phoneCodes:["1671"]},{id:"GW",name:"Guinea-Bissau",phoneCodes:["245"]},{id:"GY",name:"Guyana",phoneCodes:["592"]},{id:"HK",name:"Hong Kong",
phoneCodes:["852"]},{id:"HM",name:"Heard Island and McDonald Islands",phoneCodes:[]},{id:"HN",name:"Honduras",phoneCodes:["504"]},{id:"HR",name:"Croatia",phoneCodes:["385"]},{id:"HT",name:"Haiti",phoneCodes:["509"]},{id:"HU",name:"Hungary",phoneCodes:["36"]},{id:"ID",name:"Indonesia",phoneCodes:["62"]},{id:"IE",name:"Ireland",phoneCodes:["353"]},{id:"IL",name:"Israel",phoneCodes:["972"]},{id:"IM",name:"Isle of Man",phoneCodes:["441624"]},{id:"IN",name:"India",phoneCodes:["91"]},{id:"IO",name:"British Indian Ocean Territory",
phoneCodes:["246"]},{id:"IQ",name:"Iraq",phoneCodes:["964"]},{id:"IR",name:"Iran",phoneCodes:["98"]},{id:"IS",name:"Iceland",phoneCodes:["354"]},{id:"IT",name:"Italy",phoneCodes:["39"]},{id:"JE",name:"Jersey",phoneCodes:["441534"]},{id:"JM",name:"Jamaica",phoneCodes:["1876"]},{id:"JO",name:"Jordan",phoneCodes:["962"]},{id:"JP",name:"Japan",phoneCodes:["81"]},{id:"KE",name:"Kenya",phoneCodes:["254"]},{id:"KG",name:"Kyrgyzstan",phoneCodes:["996"]},{id:"KH",name:"Cambodia",phoneCodes:["855"]},{id:"KI",
name:"Kiribati",phoneCodes:["686"]},{id:"KM",name:"Comoros",phoneCodes:["269"]},{id:"KN",name:"Saint Kitts and Nevis",shortName:"St. Pierre and Miquelon",phoneCodes:["1869"]},{id:"KP",name:"North Korea",phoneCodes:["850"]},{id:"KR",name:"South Korea",phoneCodes:["82"]},{id:"XK",name:"Kosovo",phoneCodes:[]},{id:"KW",name:"Kuwait",phoneCodes:["965"]},{id:"KY",name:"Cayman Islands",phoneCodes:["1345"]},{id:"KZ",name:"Kazakhstan",phoneCodes:["7"]},{id:"LA",name:"Laos",phoneCodes:["856"]},{id:"LB",name:"Lebanon",
phoneCodes:["961"]},{id:"LC",name:"Saint Lucia",phoneCodes:["1758"]},{id:"LI",name:"Liechtenstein",phoneCodes:["423"]},{id:"LK",name:"Sri Lanka",phoneCodes:["94"]},{id:"LR",name:"Liberia",phoneCodes:["231"]},{id:"LS",name:"Lesotho",phoneCodes:["266"]},{id:"LT",name:"Lithuania",phoneCodes:["370"]},{id:"LU",name:"Luxembourg",phoneCodes:["352"]},{id:"LV",name:"Latvia",phoneCodes:["371"]},{id:"LY",name:"Libya",phoneCodes:["218"]},{id:"MA",name:"Morocco",phoneCodes:["212"]},{id:"MC",name:"Monaco",phoneCodes:["377"]},
{id:"MD",name:"Moldova",phoneCodes:["373"]},{id:"ME",name:"Montenegro",phoneCodes:["382"]},{id:"MF",name:"Saint Martin",phoneCodes:["590"]},{id:"MG",name:"Madagascar",phoneCodes:["261"]},{id:"MH",name:"Marshall Islands",phoneCodes:["692"]},{id:"MK",name:"Macedonia",phoneCodes:["389"]},{id:"ML",name:"Mali",phoneCodes:["223"]},{id:"MM",name:"Myanmar",phoneCodes:["95"]},{id:"MN",name:"Mongolia",phoneCodes:["976"]},{id:"MO",name:"Macao",phoneCodes:["853"]},{id:"MP",name:"Northern Mariana Islands",phoneCodes:["1670"]},
{id:"MQ",name:"Martinique",phoneCodes:["596"]},{id:"MR",name:"Mauritania",phoneCodes:["222"]},{id:"MS",name:"Montserrat",phoneCodes:["1664"]},{id:"MT",name:"Malta",phoneCodes:["356"]},{id:"MU",name:"Mauritius",phoneCodes:["230"]},{id:"MV",name:"Maldives",phoneCodes:["960"]},{id:"MW",name:"Malawi",phoneCodes:["265"]},{id:"MX",name:"Mexico",phoneCodes:["52"]},{id:"MY",name:"Malaysia",phoneCodes:["60"]},{id:"MZ",name:"Mozambique",phoneCodes:["258"]},{id:"NA",name:"Namibia",phoneCodes:["264"]},{id:"NC",
name:"New Caledonia",phoneCodes:["687"]},{id:"NE",name:"Niger",phoneCodes:["227"]},{id:"NF",name:"Norfolk Island",phoneCodes:["672"]},{id:"NG",name:"Nigeria",phoneCodes:["234"]},{id:"NI",name:"Nicaragua",phoneCodes:["505"]},{id:"NL",name:"Netherlands",phoneCodes:["31"]},{id:"NO",name:"Norway",phoneCodes:["47"]},{id:"NP",name:"Nepal",phoneCodes:["977"]},{id:"NR",name:"Nauru",phoneCodes:["674"]},{id:"NU",name:"Niue",phoneCodes:["683"]},{id:"NZ",name:"New Zealand",phoneCodes:["64"]},{id:"OM",name:"Oman",
phoneCodes:["968"]},{id:"PA",name:"Panama",phoneCodes:["507"]},{id:"PE",name:"Peru",phoneCodes:["51"]},{id:"PF",name:"French Polynesia",phoneCodes:["689"]},{id:"PG",name:"Papua New Guinea",phoneCodes:["675"]},{id:"PH",name:"Philippines",phoneCodes:["63"]},{id:"PK",name:"Pakistan",phoneCodes:["92"]},{id:"PL",name:"Poland",phoneCodes:["48"]},{id:"PM",name:"Saint Pierre and Miquelon",shortName:"St. Pierre and Miquelon",phoneCodes:["508"]},{id:"PN",name:"Pitcairn",phoneCodes:["870"]},{id:"PR",name:"Puerto Rico",
phoneCodes:["1787","1939"]},{id:"PS",name:"Palestinian Territory",phoneCodes:["970"]},{id:"PT",name:"Portugal",phoneCodes:["351"]},{id:"PW",name:"Palau",phoneCodes:["680"]},{id:"PY",name:"Paraguay",phoneCodes:["595"]},{id:"QA",name:"Qatar",phoneCodes:["974"]},{id:"RE",name:"Reunion",phoneCodes:["262"]},{id:"RO",name:"Romania",phoneCodes:["40"]},{id:"RS",name:"Serbia",phoneCodes:["381"]},{id:"RU",name:"Russia",phoneCodes:["7"]},{id:"RW",name:"Rwanda",phoneCodes:["250"]},{id:"SA",name:"Saudi Arabia",
phoneCodes:["966"]},{id:"SB",name:"Solomon Islands",phoneCodes:["677"]},{id:"SC",name:"Seychelles",phoneCodes:["248"]},{id:"SD",name:"Sudan",phoneCodes:["249"]},{id:"SS",name:"South Sudan",phoneCodes:["211"]},{id:"SE",name:"Sweden",phoneCodes:["46"]},{id:"SG",name:"Singapore",phoneCodes:["65"]},{id:"SH",name:"Saint Helena",phoneCodes:["290"]},{id:"SI",name:"Slovenia",phoneCodes:["386"]},{id:"SJ",name:"Svalbard and Jan Mayen",phoneCodes:["47"]},{id:"SK",name:"Slovakia",phoneCodes:["421"]},{id:"SL",
name:"Sierra Leone",phoneCodes:["232"]},{id:"SM",name:"San Marino",phoneCodes:["378"]},{id:"SN",name:"Senegal",phoneCodes:["221"]},{id:"SO",name:"Somalia",phoneCodes:["252"]},{id:"SR",name:"Suriname",phoneCodes:["597"]},{id:"ST",name:"Sao Tome and Principe",phoneCodes:["239"]},{id:"SV",name:"El Salvador",phoneCodes:["503"]},{id:"SX",name:"Sint Maarten",phoneCodes:["599"]},{id:"SY",name:"Syria",phoneCodes:["963"]},{id:"SZ",name:"Swaziland",phoneCodes:["268"]},{id:"TC",name:"Turks and Caicos Islands",
phoneCodes:["1649"]},{id:"TD",name:"Chad",phoneCodes:["235"]},{id:"TF",name:"French Southern Territories",phoneCodes:[]},{id:"TG",name:"Togo",phoneCodes:["228"]},{id:"TH",name:"Thailand",phoneCodes:["66"]},{id:"TJ",name:"Tajikistan",phoneCodes:["992"]},{id:"TK",name:"Tokelau",phoneCodes:["690"]},{id:"TL",name:"East Timor",phoneCodes:["670"]},{id:"TM",name:"Turkmenistan",phoneCodes:["993"]},{id:"TN",name:"Tunisia",phoneCodes:["216"]},{id:"TO",name:"Tonga",phoneCodes:["676"]},{id:"TR",name:"Turkey",
phoneCodes:["90"]},{id:"TT",name:"Trinidad and Tobago",phoneCodes:["1868"]},{id:"TV",name:"Tuvalu",phoneCodes:["688"]},{id:"TW",name:"Taiwan",phoneCodes:["886"]},{id:"TZ",name:"Tanzania",phoneCodes:["255"]},{id:"UA",name:"Ukraine",phoneCodes:["380"]},{id:"UG",name:"Uganda",phoneCodes:["256"]},{id:"UM",name:"United States Minor Outlying Islands",phoneCodes:["1"]},{id:"US",name:"United States",shortName:"U.S.A.",phoneCodes:["1"]},{id:"UY",name:"Uruguay",phoneCodes:["598"]},{id:"UZ",name:"Uzbekistan",
phoneCodes:["998"]},{id:"VA",name:"Vatican",phoneCodes:["379"]},{id:"VC",name:"Saint Vincent and the Grenadines",shortName:"St. Vincent and the Grenadines",phoneCodes:["1784"]},{id:"VE",name:"Venezuela",phoneCodes:["58"]},{id:"VG",name:"British Virgin Islands",shortName:"Virgin Islands",phoneCodes:["1284"]},{id:"VI",name:"U.S. Virgin Islands",phoneCodes:["1340"]},{id:"VN",name:"Vietnam",phoneCodes:["84"]},{id:"VU",name:"Vanuatu",phoneCodes:["678"]},{id:"WF",name:"Wallis and Futuna",phoneCodes:["681"]},
{id:"WS",name:"Samoa",phoneCodes:["685"]},{id:"YE",name:"Yemen",phoneCodes:["967"]},{id:"YT",name:"Mayotte",phoneCodes:["262"]},{id:"ZA",name:"South Africa",phoneCodes:["27"]},{id:"ZM",name:"Zambia",phoneCodes:["260"]},{id:"ZW",name:"Zimbabwe",phoneCodes:["263"]},{id:"CS",name:"Serbia and Montenegro",phoneCodes:["381"]},{id:"AN",name:"Netherlands Antilles",phoneCodes:["599"]}];function CommonRenderer(a,b,c,d,e,f,g){this.userGroupRenderer=a;this.userRenderer=b;this.addGroupControlRenderer=c;this.userGroupContainer=d;this.userContainer=e;this.addGroupControlContainer=f;this.moveToMenuDivId=g}
CommonRenderer.prototype.generateUserContent=function(a,b,c,d,e){this.userContainer.innerHTML="";for(var f=0,g=a.emptyDueToFilter,h=a.filtered,k=[],l=0;l<c.length;l++){var m=this.userRenderer.generateContent(a,c[l],e);c[l].active||(f++,d||k.push(m));this.userContainer.appendChild(m)}!h||0<f&&f!=c.length?_.each(k,function(a){a.style.display="none"}):f=0;g?a.getEmptyGroupResolver().resolveEmptyUserGroupAfterFilterApplied(b):a.getEmptyGroupResolver().resolveEmptyUserGroupElementState(b,d,f)};
CommonRenderer.prototype.generateGroupContent=function(a){this.userGroupContainer.innerHTML="";for(var b=0;b<a.length;b++)this.userGroupContainer.appendChild(this.userGroupRenderer.generateContent(a[b]))};
CommonRenderer.prototype.generateMoveToMenu=function(){var a=new Ext.Button({applyTo:this.moveToMenuDivId,cls:"at-dropdown-list-btn",ctCls:"moveToButton",menu:new Ext.menu.Menu({items:[],cls:"groupManagementLightBox at-scrollable-menu"}),menuAlign:"tl-bl",text:messageResource.getMessage("group_management.move_to")});$(window).off("resize.moveToMenu").on("resize.moveToMenu",function(){a.hideMenu()});return a};
CommonRenderer.prototype.getMenuItems=function(a,b){for(var c=[],d=0;d<b.length;d++)c[d]=new Ext.menu.Item({text:this.userGroupRenderer.getItemText(b[d]),value:b[d].id}),c[d].on({click:{scope:c[d],fn:function(){a.moveToMenuClicked(this.value)}}});return c};CommonRenderer.prototype.reInitMoveToMenu=function(a,b,c){a=this.getMenuItems(a,c);b.menu.removeAll();for(c=0;c<a.length;c++)b.menu.addItem(a[c]);0==a.length&&b.disable()};
CommonRenderer.prototype.cleanup=function(){this.userGroupContainer.innerHTML="";this.userContainer.innerHTML=""};CommonRenderer.prototype.generateAddGroupControlContent=function(){this.addGroupControlContainer.innerHTML="";this.addGroupControlContainer.appendChild(this.addGroupControlRenderer.generateContent())};function UserRenderer(a,b,c,d,e,f,g,h){this.userDivClassName=a;this.userTableClassName=b;this.dragImgClassName=c;this.usernameCellClassName=d;this.grayedClassName=e;this.checkboxCellClassName=f;this.userDivIdPrefix=g;this.userCheckboxIdPrefix=h}
UserRenderer.prototype.generateContent=function(a,b,c){a=document.createElement("div");a.className=this.userDivClassName;a.id=formatId(this.userDivIdPrefix,b.id);var d=document.createElement("table");d.className=this.userTableClassName;var e=document.createElement("tbody"),f=document.createElement("tr"),g=document.createElement("td");g.className=this.dragImgClassName;var h=document.createElement("img");h.src=atImgPath("user_group_lightbox/move-group-arrow.png");g.appendChild(h);h=document.createElement("td");
h.className=this.checkboxCellClassName;var k=document.createElement("input");k.type="checkbox";var l=formatId(this.userCheckboxIdPrefix,b.id);k.id=l;k.onfocus=function(){this.blur()};var m=document.createElement("td");m.className=this.usernameCellClassName;var n=document.createElement("div");n.className=GroupManagementUtil.ellipsisOverflowClassName;n.title=b.name;var q=document.createElement("label");q.htmlFor=l;q.innerHTML=c.highlightTokens(b.name);disableTextSelection(q);b.active||addClass(m,this.grayedClassName);
a.appendChild(d);d.appendChild(e);e.appendChild(f);f.appendChild(g);f.appendChild(h);h.appendChild(k);m.appendChild(n);n.appendChild(q);f.appendChild(m);return a};function AddGroupRenderer(){}AddGroupRenderer.prototype.init=function(a){this.addGroupTableId=a.addGroupTableId;this.inputId=a.inputId;this.buttonId=a.buttonId;this.spinnerId=a.spinnerId;this.imageCellClassName=a.imageCellClassName;this.inputCellClassName=a.inputCellClassName;this.buttonCellClassName=a.buttonCellClassName;this.spinnerCellClassName=a.spinnerCellClassName;return this};
AddGroupRenderer.prototype.buildImageCell=function(a){var b=document.createElement("td");b.className=this.imageCellClassName;var c=document.createElement("img");c.src=atImgPath("user_group_lightbox/add-group-icon.png");b.appendChild(c);a.appendChild(b)};
AddGroupRenderer.prototype.buildInputCell=function(a){var b=document.createElement("td");b.className=this.inputCellClassName;var c=document.createElement("input");c.type="text";c.maxLength="40";c.className="text";c.id=this.inputId;b.appendChild(c);a.appendChild(b)};
AddGroupRenderer.prototype.buildButtonCell=function(a){var b=document.createElement("td");b.className=this.buttonCellClassName;var c=document.createElement("button");c.id=this.buttonId;c.innerHTML=messageResource.getMessage("group_management.add_button_caption");b.appendChild(c);a.appendChild(b)};AddGroupRenderer.prototype.buildSpinnerCell=function(a){var b=document.createElement("td");b.className=this.spinnerCellClassName;b.id=this.spinnerId;a.appendChild(b)};
AddGroupRenderer.prototype.buildCells=function(a){};AddGroupRenderer.prototype.generateContent=function(){var a=document.createElement("table");a.width="100%";a.cellspacing="0";a.cellpadding="0";a.id=this.addGroupTableId;var b=document.createElement("tr");this.buildCells(b);a.appendChild(b);return a};function AddTimeZoneGroupRenderer(){}AddTimeZoneGroupRenderer.prototype=new AddGroupRenderer;AddTimeZoneGroupRenderer.prototype.init=function(a){AddGroupRenderer.prototype.init.call(this,a);this.selectorCellClassName=a.selectorCellClassName;this.selectorId=a.selectorId;this.timeZoneImageCellClassName=a.timeZoneImageCellClassName;return this};
AddTimeZoneGroupRenderer.prototype.buildCitySelectorCell=function(a){var b=document.createElement("td");b.className=this.selectorCellClassName;var c=document.createElement("div");c.id=this.selectorId;b.appendChild(c);a.appendChild(b)};AddTimeZoneGroupRenderer.prototype.buildTimeZoneImageCell=function(a){var b=document.createElement("td");b.className=this.timeZoneImageCellClassName;var c=document.createElement("img");c.src=atImgPath("user_group_lightbox/time-zone.png");b.appendChild(c);a.appendChild(b)};
AddTimeZoneGroupRenderer.prototype.buildCells=function(a){this.buildImageCell(a);this.buildCitySelectorCell(a);this.buildTimeZoneImageCell(a);this.buildInputCell(a);this.buildButtonCell(a);this.buildSpinnerCell(a)};function AddUserGroupRenderer(){}AddUserGroupRenderer.prototype=new AddGroupRenderer;AddUserGroupRenderer.prototype.buildCells=function(a){this.buildImageCell(a);this.buildInputCell(a);this.buildButtonCell(a);this.buildSpinnerCell(a)};function UserController(a,b,c){this.userDivIdPrefix=a;this.checkBoxIdPrefix=b;this.selectedUserClassName=c;this.users={}}UserController.prototype.init=function(a,b,c,d){this.users={};for(var e=0;e<b.length;e++){var f=document.getElementById(formatId(this.userDivIdPrefix,b[e].id)),g=document.getElementById(formatId(this.checkBoxIdPrefix,b[e].id));this.users[b[e].id]=new UserInGroupRow(f,g,a.getDDController().makeDDWrapperForUser(a,f,b[e].id,d),a,b[e])}this.isShowDisabledUsers=c};
UserController.prototype.selectAll=function(){for(var a in this.users)this.doSelectUser(this.users[a],!0)};UserController.prototype.clearAll=function(){for(var a in this.users)this.doSelectUser(this.users[a],!1)};UserController.prototype.selectUser=function(a){this.doSelectUser(a,a.checkbox.checked)};
UserController.prototype.reloadDisabledUsers=function(a,b){var c=0,d=[],e=0,f;for(f in this.users)e++,this.users[f].active||(c++,a?this.users[f].open():d.push(this.users[f]));!b||0<d.length&&d.length!=e?_.each(d,function(a){a.hide()}):c=0;this.isShowDisabledUsers=a;return c};UserController.prototype.doSelectUser=function(a,b){b?addClass(a.div,this.selectedUserClassName):removeClass(a.div,this.selectedUserClassName);a.checkbox.checked=b};
UserController.prototype.getUsersNeededForDrag=function(a,b){var c=[],d=this.users[a];if(d.isSelected())for(var e in this.users)this._verifyUser(this.users[e],b)&&c.push(this.users[e]);else c.push(d);c.sort(nameComparator);return c};UserController.prototype.getUsers=function(){return this.users};UserController.prototype.hasUsersSelected=function(a){for(var b in this.users)if(this._verifyUser(this.users[b],a))return!0;return!1};
UserController.prototype._verifyUser=function(a,b){return a.isSelected()&&(a.active||this.isShowDisabledUsers||b)};UserController.prototype.getSelectedUserIds=function(a){var b=[],c;for(c in this.users)this._verifyUser(this.users[c],a)&&b.push(this.users[c].id);return b};UserController.prototype.selectSavedUsers=function(a){for(var b=0;b<a.length;b++){var c=this.users[a[b]];c&&this.doSelectUser(c,!0)}};function DragAndDropController(a,b,c,d,e){this.ddProxyClassName=a;this.ddProxyRowClassName=b;this.draggedUserDivClassName=c;this.undroppableClassName=d;this.dragGroupName="users";this.currentDraggedUsers=null;this.groupNamingKey=e}
DragAndDropController.prototype.makeDDWrapperForUser=function(a,b,c,d){var e=new Ext.dd.DDProxy(b,this.dragGroupName,{isTarget:!1,scroll:!1});e.DDM.useCache=!1;var f=function(a){a.keyCode==KEY_CODE_ESC&&(e.DDM.stopDrag(a),cancelBubble(a))},g=this;Ext.apply(e,{onDragEnter:function(b,c){var d=a.getGroupController().getGroup(GroupManagementUtil.getElementId(c));a.getGroupController().isGroupSuitableForDrop(d.id)?g.dragEnterToAvailableGroup(d):g.dragEnterToUnavailableGroup(d,a)},onDragOut:function(b,
c){var d=a.getGroupController().getGroup(GroupManagementUtil.getElementId(c));g.dragOut(d,a)},onDragDrop:function(b,c){var d=a.getGroupController().getGroup(GroupManagementUtil.getElementId(c));g.dragOut(d,a);d.isHovered()&&g.dropUsersWithChecking(a,d.id,GroupManagementUtil.makeIdArrayFromObjectArray(g.currentDraggedUsers))},b4StartDrag:function(b,d){a.passiveEventHandler(function(){g.beforeStartDragAction(e,a,c,b,d)},!1);KeyDownHandler.setOnKeyDownHandler(f)},endDrag:function(){e.getDragEl().innerHTML=
"";document.body.style.cursor="default";a.removeDragAndDropClassNamesFromLightboxContainer();for(var b=0;b<g.currentDraggedUsers.length;b++)removeClass(g.currentDraggedUsers[b].div,g.draggedUserDivClassName),g.currentDraggedUsers[b].checkbox.disabled="";g.currentDraggedUsers=null;KeyDownHandler.restoreOnKeyDownHandler()},b4MouseDown:function(){a.hideErrors();a.endGroupEditing(!1)}});d&&e.lock();return e};DragAndDropController.prototype.makeDDWrapperForGroup=function(a){new Ext.dd.DDTarget(a,this.dragGroupName)};
DragAndDropController.prototype.dragEnterToUnavailableGroup=function(a,b){var c=b.getGroupController();addClass(a.div,this.undroppableClassName);c.getEditedGroup()&&c.getEditedGroup().id==a.id?(a.disableEditedGroupMouseEvents(),a.groupUndoAcceptEditButtonOnMouseOut.call(a.undoEditButton),a.groupUndoAcceptEditButtonOnMouseOut.call(a.acceptEditButton)):(a.divOnMouseOut(),a.disableMouseEvents(),a.groupButtonControlOnMouseOut.call(a.deleteLink))};
DragAndDropController.prototype.dragEnterToAvailableGroup=function(a){a.disableMouseEvents(!0);a.groupButtonControlOnMouseOut.call(a.deleteLink)};DragAndDropController.prototype.dragOut=function(a,b){var c=b.getGroupController();removeClass(a.div,this.undroppableClassName);c.getEditedGroup()&&c.getEditedGroup().id==a.id?a.enableEditedGroupMouseEvents():a.enableMouseEvents()};
DragAndDropController.prototype.beforeStartDragAction=function(a,b,c,d,e){a.setDelta(-10,-5);c=b.getUserController().getUsersNeededForDrag(c,b.isDisabledUsersShownDueToFilter());var f=a.getDragEl();f.className=this.ddProxyClassName;for(var g=new DragAndDropUsersInFlightRenderer(this.ddProxyRowClassName,c.length),h=0;h<c.length;h++)g.permitToRender&&f.appendChild(g.generateOneUserDiv(c[h])),addClass(c[h].div,this.draggedUserDivClassName),c[h].checkbox.disabled="disabled";a.alignElWithMouse(f,d,e);
document.body.style.cursor="move";b.setDragAndDropClassNamesToLightboxContainer();this.currentDraggedUsers=c};DragAndDropController.prototype.onDropAction=function(a,b,c){a.getGroupController().getGroup(b);a=new GroupMoveRPCManager(a.getServiceName(),a,b,a.getGroupController().getGroup(b).name,c,this.groupNamingKey);RpcControlManager.saveRpcControlBoundData(a,!1)};
DragAndDropController.prototype.dropUsersWithChecking=function(a,b,c){var d=this;a.getGroupController().isGroupSuitableForDrop(b)&&0<c.length&&a.groupEventHandler(function(){d.onDropAction(a,b,c)},!1)};function DragAndDropUsersInFlightRenderer(a,b){this.divClassName=a;this.totalCountOfUsers=b;this.COUNT_OF_USERS_DISPLAYED=4;this.countOfProcessedUsers=0;this.permitToRender=!0}
DragAndDropUsersInFlightRenderer.prototype.generateOneUserDiv=function(a){var b=document.createElement("div");b.className=this.divClassName;addClass(b,GroupManagementUtil.textClassName);addClass(b,GroupManagementUtil.ellipsisOverflowClassName);this.countOfProcessedUsers<this.COUNT_OF_USERS_DISPLAYED?(b.innerHTML=escapeHtmlSymbols(a.name),this.countOfProcessedUsers++):(a=this.totalCountOfUsers-this.COUNT_OF_USERS_DISPLAYED,b.innerHTML=1===a?messageResource.getMessage("group_management.drag_and_drop.additional_users_count.singular"):
messageResource.getMessage("group_management.drag_and_drop.additional_users_count.plural",[a]),this.permitToRender=!1);return b};function AddTimeZoneGroupController(){}AddTimeZoneGroupController.prototype=new AddGroupController;AddTimeZoneGroupController.prototype.init=function(a){AddGroupController.prototype.init.call(this,a);this.selectorId=a.addGroupSelectorId;this.editStateClassName=a.editStateClassName;return this};
AddTimeZoneGroupController.prototype.initAfterShowing=function(a){AddGroupController.prototype.initAfterShowing.call(this,a);var b=this;this.citySelector=(new TimeZonesSelector).init($("#"+this.selectorId),null,function(c){b.cityChanged(c,a)},messageResource.getMessage("group_management.add_time_zone_group.empty_selector_text"),!0,"addTimeZoneGroupSearch")};AddTimeZoneGroupController.prototype.cityChanged=function(a,b){this.cityData=a;this.changeStateIfNeeded(b)};
AddTimeZoneGroupController.prototype.resetRowIntoDefaultState=function(){this.citySelector.resetToInit();this.cityData=null;AddGroupController.prototype.resetRowIntoDefaultState.call(this)};
AddTimeZoneGroupController.prototype.changeStateIfNeeded=function(a){null==this.cityData?removeClass(this.newGroupInputCell,this.editStateClassName):(addClass(this.newGroupInputCell,this.editStateClassName),this.emptyFieldController.isEmpty()&&(this.emptyFieldController.hideGrayText(),this.newGroupInput.value=this.cityData.name.substr(0,40)));AddGroupController.prototype.changeStateIfNeeded.call(this,a)};
AddTimeZoneGroupController.prototype.getNewGroupData=function(){return{id:-1,name:this.newGroupInput.value.trim(),cityPlaceId:this.cityData.placeId,cityName:this.cityData.name,timeZoneId:this.cityData.timeZoneId,rawOffset:this.cityData.rawOffset,currentTime:this.cityData.currentTime}};AddTimeZoneGroupController.prototype.getNewGroupFieldEmptyCaption=function(){return messageResource.getMessage("group_management.new_group_name")};function HighlightController(a,b,c,d){this.hoveredGroupDivClassName=b;this.hoveredControlClassName=c;this.selectedGroupDivClassName=a;this.hoverUndoAcceptEditButtonClassName=d}HighlightController.prototype.highlightSelectedGroup=function(a){addClass(a.div,this.selectedGroupDivClassName)};HighlightController.prototype.unhighlightSelectedGroup=function(a){removeClass(a.div,this.selectedGroupDivClassName)};HighlightController.prototype.highlightHoveredGroup=function(a){addClass(a.div,this.hoveredGroupDivClassName)};
HighlightController.prototype.unhighlightHoveredGroup=function(a){removeClass(a.div,this.hoveredGroupDivClassName)};HighlightController.prototype.highlightHoveredControl=function(a){addClass(a,this.hoveredControlClassName)};HighlightController.prototype.unhighlightHoveredControl=function(a){removeClass(a,this.hoveredControlClassName)};HighlightController.prototype.highlightHoveredUndoAcceptEditButton=function(a){addClass(a,this.hoverUndoAcceptEditButtonClassName)};
HighlightController.prototype.unhighlightHoveredUndoAcceptEditButton=function(a){removeClass(a,this.hoverUndoAcceptEditButtonClassName)};function BaseGroupRPCManager(a,b){RpcControlManager.call(this);this.serviceName=a;this.controller=b}BaseGroupRPCManager.prototype=new RpcControlManager;BaseGroupRPCManager.prototype.getService=function(){return jsonrpc[this.serviceName]};BaseGroupRPCManager.prototype.getMethods=function(){return[this.serviceName+".deleteGroup",this.serviceName+".updateGroup",this.serviceName+".createGroup",this.serviceName+".moveUsersToAnotherGroup"]};
BaseGroupRPCManager.prototype.beginSavingData=function(){this.controller.lockNeededElementsDueToAJAX();this.controller.isChangesMade=!0;this.doBeginSavingData()};BaseGroupRPCManager.prototype.doBeginSavingData=function(){};BaseGroupRPCManager.prototype.endSavingData=function(a){this.controller.unlockNeededElementsDueToAJAX();this.doEndSavingData(a)};BaseGroupRPCManager.prototype.doEndSavingData=function(a){a||this.controller.rebuildViewAfterTimeOutError()};
BaseGroupRPCManager.prototype.handleNoRightsError=function(a){return-1!=a.name.indexOf("com.actimind.actitime.services.NoRightsForRemoteCallException")?(alert(JQUERY_RPC_ERROR_MESSAGES.NO_RIGHTS),document.location.reload(),!0):!1};
BaseGroupRPCManager.prototype.handleSpecificError=function(a){this.controller.unlockNeededElementsDueToAJAX();if(-1!=a.name.indexOf("com.actimind.common.services.UserGroupsDisabledException"))return PRODUCT_NAME==Product.actiPLANS?alert(messageResource.getMessage("actiplans.user_list.js.error.user_groups_disabled")):alert(messageResource.getMessage("userlist.js.error_ugr_disabled")),document.location.reload(),!0;if(-1!=a.name.indexOf("com.actimind.actitime.services.NoRightsToManageAccountSettings"))return alert(messageResource.getMessage("group_management.permissions_changed")),
document.location.reload(),!0;if(this.doHandleSpecificError(a))return!0;var b=this;window.setTimeout(function(){b.controller.handleUnexpectedServerError()},500);return!0};BaseGroupRPCManager.prototype.doHandleSpecificError=function(a){};function GroupDeleteRPCManager(a,b,c,d){BaseGroupRPCManager.call(this,a,b);this.groupId=c;this.groupNamingKey=d}GroupDeleteRPCManager.prototype=new BaseGroupRPCManager;GroupDeleteRPCManager.prototype.doBeginSavingData=function(){this.controller.getGroupController().markGroupAsDeletedNow(this.groupId)};GroupDeleteRPCManager.prototype.onDataSavingComplete=function(a){this.controller.rebuildViewAfterGroupDeletion(this.groupId)};
GroupDeleteRPCManager.prototype.doHandleSpecificError=function(a){return-1!=a.name.indexOf("com.actimind.actitime.administration.NoSuchUserGroupException")?(this.onDataSavingComplete(),!0):!1};GroupDeleteRPCManager.prototype.makeRemoteCall=function(a){this.getService().deleteGroup(a,this.groupId)};GroupDeleteRPCManager.prototype.getTimeoutMsg=function(){return messageResource.getEscapedMessage("group_management.timeout.delete_group.user_group",[messageResource.getEscapedMessage(this.groupNamingKey)])};function GroupEditRPCManager(a,b,c,d){BaseGroupRPCManager.call(this,a,b);this.group=c;this.groupNamingKey=d}GroupEditRPCManager.prototype=new BaseGroupRPCManager;GroupEditRPCManager.prototype.doBeginSavingData=function(){var a=this;this.controller.groupEventHandler(function(){a.controller.getGroupController().markGroupAsEditedNow(a.group.id)},!1)};GroupEditRPCManager.prototype.onDataSavingComplete=function(a){this.controller.rebuildViewAfterGroupEditing(this.group)};
GroupEditRPCManager.prototype.doHandleSpecificError=function(a){var b=this;return-1!=a.name.indexOf("com.actimind.actitime.administration.NoSuchUserGroupException")?(this.controller.showErrorMessage(messageResource.getMessage("group_management.group_deleted.user_group",[messageResource.getEscapedMessage(this.groupNamingKey)])),window.setTimeout(function(){b.controller.readData()},500),!0):-1!=a.name.indexOf("com.actimind.actitime.administration.GroupExistsException")?(this.controller.showDuplicateUserGroupMessage(),
window.setTimeout(function(){b.controller.readData(function(){b.controller.getGroupController().paintDuplicateGroupsAsRed(b.group.id,b.group.name)})},500),!0):!1};GroupEditRPCManager.prototype.makeRemoteCall=function(a){this.getService().updateGroup(a,this.group)};GroupEditRPCManager.prototype.getTimeoutMsg=function(){return messageResource.getMessage("group_management.timeout.edit_group.user_group",[messageResource.getEscapedMessage(this.groupNamingKey)])};function GroupCreateRPCManager(a,b,c,d){BaseGroupRPCManager.call(this,a,b);this.group=c;this.groupNamingKey=d}GroupCreateRPCManager.prototype=new BaseGroupRPCManager;GroupCreateRPCManager.prototype.doBeginSavingData=function(){this.controller.getAddGroupController().markRowAsAJAXProcessedNow()};GroupCreateRPCManager.prototype.doEndSavingData=function(a){a||this.controller.getAddGroupController().resetRowIntoDefaultState()};
GroupCreateRPCManager.prototype.onDataSavingComplete=function(a){this.group.id=a;this.controller.rebuildViewAfterGroupCreation(this.group)};GroupCreateRPCManager.prototype.doHandleSpecificError=function(a){if(-1!=a.name.indexOf("com.actimind.actitime.administration.GroupExistsException")){this.controller.getAddGroupController().resetRowIntoDefaultState();this.controller.showDuplicateUserGroupMessage();var b=this;window.setTimeout(function(){b.controller.readData()},500);return!0}return!1};
GroupCreateRPCManager.prototype.makeRemoteCall=function(a){this.getService().createGroup(a,this.group)};GroupCreateRPCManager.prototype.getTimeoutMsg=function(){return messageResource.getEscapedMessage("group_management.timeout.create_group.user_group",[messageResource.getEscapedMessage(this.groupNamingKey)])};function GroupMoveRPCManager(a,b,c,d,e,f){BaseGroupRPCManager.call(this,a,b);this.targetGroupId=c;this.targetGroupName=d;this.userIds=e;this.groupNamingKey=f}GroupMoveRPCManager.prototype=new BaseGroupRPCManager;GroupMoveRPCManager.prototype.doBeginSavingData=function(){this.controller.getGroupController().markGroupAsMovedInNow(this.targetGroupId)};
GroupMoveRPCManager.prototype.onDataSavingComplete=function(a){a.length==this.userIds.length?this.controller.showErrorMessage(messageResource.getMessage("group_management.drag_and_drop.all_users_deleted")):0<a.length&&this.controller.showErrorMessage(messageResource.getMessage("group_management.drag_and_drop.some_users_deleted"));this.controller.rebuildViewAfterUsersMoving(this.targetGroupId,this.userIds,a)};
GroupMoveRPCManager.prototype.doHandleSpecificError=function(a){return-1!=a.name.indexOf("com.actimind.actitime.administration.NoSuchUserGroupException")?(this.controller.showErrorMessage(messageResource.getMessage("group_management.drag_and_drop.group_deleted.user_group",[messageResource.getEscapedMessage(this.groupNamingKey),escapeHtmlSymbols(this.targetGroupName)])),this.controller.rebuildViewAfterGroupDeletion(this.targetGroupId),!0):!1};
GroupMoveRPCManager.prototype.makeRemoteCall=function(a){this.getService().moveUsersToAnotherGroup(a,this.targetGroupId,this.userIds)};GroupMoveRPCManager.prototype.getTimeoutMsg=function(){return messageResource.getMessage("group_management.timeout.move_into_group.user_group",[messageResource.getEscapedMessage(this.groupNamingKey)])};function EmptyGroupResolver(a,b,c,d){EmptyGroupResolver.WITHOUT_USERS=1;EmptyGroupResolver.WITHOUT_ENABLED_USERS=2;EmptyGroupResolver.MESSAGE_HIDDEN=3;this.domElement=a;this.labelCell=b;this.userContainer=c;this.emptyNullGroupMessage=messageResource.getEscapedMessage("group_management.empty_null_group.user_group");this.nullGroupWithoutEnabledUsersMessage=messageResource.getEscapedMessage("group_management.null_group_without_enabled.user_group");this.lastState=EmptyGroupResolver.MESSAGE_HIDDEN;this.groupNamingKey=
d.groupNamingKey;this.GroupNamingKey=d.GroupNamingKey;this.validatorGroupStrategy=d.validatorGroupStrategy}EmptyGroupResolver.prototype.resolveEmptyUserGroupElementState=function(a,b,c){0==a.users.length?this.appendWithoutUsersElement(a):b||c!=a.users.length?(this.lastState=EmptyGroupResolver.MESSAGE_HIDDEN,this.hideElement()):this.appendWithoutEnabledUsersElement(a)};EmptyGroupResolver.prototype.resolveEmptyUserGroupAfterFilterApplied=function(a){this.replaceWithoutUsersLabel(a.name,!0);this.showElement()};
EmptyGroupResolver.prototype.createElement=function(a){var b=document.createElement("table"),c=document.createElement("tbody"),d=document.createElement("tr"),e=document.createElement("td");b.className=a;e.className=GroupManagementUtil.textClassName;b.appendChild(c);c.appendChild(d);d.appendChild(e);return b};
EmptyGroupResolver.prototype.appendWithoutUsersElement=function(a){this.lastState=EmptyGroupResolver.WITHOUT_USERS;this.validatorGroupStrategy.isNullGroup(a)?this.replaceLabel(this.emptyNullGroupMessage):this.replaceWithoutUsersLabel(a.name,!1);this.showElement()};
EmptyGroupResolver.prototype.appendWithoutEnabledUsersElement=function(a){this.lastState=EmptyGroupResolver.WITHOUT_ENABLED_USERS;this.validatorGroupStrategy.isNullGroup(a)?this.replaceLabel(this.nullGroupWithoutEnabledUsersMessage):this.replaceWithoutEnabledUsersLabel(a.name);this.showElement()};EmptyGroupResolver.prototype.replaceLabel=function(a){this.labelCell.innerHTML=a};
EmptyGroupResolver.prototype.replaceWithoutEnabledUsersLabel=function(a){this.replaceLabel(messageResource.getEscapedMessage("group_management.group_without_enabled.user_group",[messageResource.getMessage(this.groupNamingKey)].concat(a)))};EmptyGroupResolver.prototype.replaceWithoutUsersLabel=function(a,b){this.replaceLabel(messageResource.getEscapedMessage(b?"group_management.empty_group.no_users_found":"group_management.empty_group.user_group",[messageResource.getMessage(this.groupNamingKey),a]))};
EmptyGroupResolver.prototype.replaceUserGroupNameInLabel=function(a){switch(this.lastState){case EmptyGroupResolver.WITHOUT_USERS:this.replaceWithoutUsersLabel(a,!1);break;case EmptyGroupResolver.WITHOUT_ENABLED_USERS:this.replaceWithoutEnabledUsersLabel(a)}};EmptyGroupResolver.prototype.showElement=function(){this.domElement.style.display="";this.userContainer.style.display="none"};
EmptyGroupResolver.prototype.hideElement=function(){this.domElement.style.display="none";this.userContainer.style.display=""};function SectionsErrorsHandler(){}SectionsErrorsHandler.prototype.DUPLICATE_TIME_ZONE_GROUP_ERROR="duplicateTimeZoneGroupError";SectionsErrorsHandler.prototype.init=function(a){this._accountSection=a;return this};
SectionsErrorsHandler.prototype.handleError=function(a,b,c){a==UserManagementConstants.ERROR_DUPLICATE_USERNAME&&(this._accountSection.setToDuplicateUsernameState(),b(this._accountSection));a==UserManagementConstants.ERROR_EMAIL_INVALID&&(this._accountSection.setEmailInvalid(),b(this._accountSection));a==SectionsErrorsHandler.prototype.DUPLICATE_TIME_ZONE_GROUP_ERROR&&(this._accountSection.updateTimeZoneGroups(c),this._accountSection.setDuplicateTimeZoneGroupError(!0),b(this._accountSection))};function SectionsPreparatoryStrategy(){}SectionsPreparatoryStrategy.prototype.init=function(){return this};SectionsPreparatoryStrategy.prototype.prepareSections=function(a,b,c){};SectionsPreparatoryStrategy.prototype.getVersionSpecificDrawer=function(){};SectionsPreparatoryStrategy.prototype.getScrollableContainerEl=function(a){return $(a).find(".innerContent")[0]};function CreateSectionsPreparatoryStrategy(){}CreateSectionsPreparatoryStrategy.prototype=new SectionsPreparatoryStrategy;
CreateSectionsPreparatoryStrategy.prototype.init=function(){SectionsPreparatoryStrategy.prototype.init.call(this,void 0);return this};CreateSectionsPreparatoryStrategy.prototype.prepareSections=function(a,b,c){a.setUpNameCallback(c)};CreateSectionsPreparatoryStrategy.prototype.getAccountInformationSectionConstructor=function(){return new CreateAccountInformationSection};
CreateSectionsPreparatoryStrategy.prototype.getVersionSpecificDrawer=function(){return isOlVersion?new OnlineAccountFieldsCreateUserPopupDrawer:new DownloadableAccountFieldsCreateUserPopupDrawer};function EditSectionsPreparatoryStrategy(){}EditSectionsPreparatoryStrategy.prototype=new SectionsPreparatoryStrategy;EditSectionsPreparatoryStrategy.prototype.init=function(a,b){SectionsPreparatoryStrategy.prototype.init.call(this,void 0);this._editUserData=a;this._editedUserIsLoggedIn=b;return this};
EditSectionsPreparatoryStrategy.prototype.prepareSections=function(a){};EditSectionsPreparatoryStrategy.prototype.getAccountInformationSectionConstructor=function(){return new EditAccountInformationSection};EditSectionsPreparatoryStrategy.prototype.getVersionSpecificDrawer=function(){return isOlVersion?new OnlineAccountFieldsEditUserPopupDrawer:new DownloadableAccountFieldsEditUserPopupDrawer};function WorkDayDurationsTableBuilder(){}WorkDayDurationsTableBuilder.prototype=function(){};WorkDayDurationsTableBuilder.prototype.createTable=function(){};WorkDayDurationsTableBuilder.prototype.init=function(a){this._defaultWorkSchedule=a.defaultWorkSchedule;this._userManagementData=a};function CreateWorkDayDurationsTableBuilder(){}CreateWorkDayDurationsTableBuilder.prototype=new WorkDayDurationsTableBuilder;
CreateWorkDayDurationsTableBuilder.prototype.init=function(a){WorkDayDurationsTableBuilder.prototype.init.call(this,a);return this};CreateWorkDayDurationsTableBuilder.prototype.createTable=function(a,b,c,d,e,f){b.innerHTML="";a=(new CreateUserWorkdayDurationsTable).init(this._userManagementData,c,d,e,f);a.buildDOM(b);return a};function EditWorkDayDurationsTableBuilder(a){this.customRemoveRowCellRenderer=a}EditWorkDayDurationsTableBuilder.prototype=new WorkDayDurationsTableBuilder;
EditWorkDayDurationsTableBuilder.prototype.init=function(a,b){WorkDayDurationsTableBuilder.prototype.init.call(this,a);this._currentTime=b;return this};EditWorkDayDurationsTableBuilder.prototype.createTable=function(a,b,c,d,e,f){b.innerHTML="";a=(new EditUserWorkdayDurationsTable).init(this._userManagementData,c,d,e,f,this._defaultWorkSchedule,this._currentTime,this.customRemoveRowCellRenderer?this.customRemoveRowCellRenderer:(new RemoveRowCellRenderer).init());a.buildDOM(b);return a};CommonUserManagementSectionsBuilderParams=function(){this._defaultWorkSchedule=this._accountSettings=this._userId=this._currentTime=this._userManagementData=this._workdayDurationsTableBuilder=this._preparatoryStrategy=null;this._showPermissionsSection=!1;this._ratesTableStrategy=this._firstRequestDate=this._firstTTDate=this._allowedToManageAccountSettings=this._editedUserIsLoggedIn=null};
CommonUserManagementSectionsBuilderParams.prototype.setPreparatoryStrategy=function(a){this._preparatoryStrategy=a;return this};CommonUserManagementSectionsBuilderParams.prototype.setWorkdayDurationsTableBuilder=function(a){this._workdayDurationsTableBuilder=a;return this};
CommonUserManagementSectionsBuilderParams.prototype.setUserManagementData=function(a){this._userManagementData=a;this._defaultWorkSchedule=a.defaultWorkSchedule;this._allowedToManageAccountSettings=a.viewerSettings.allowedToManageAccountSettings;return this};CommonUserManagementSectionsBuilderParams.prototype.setCurrentTime=function(a){this._currentTime=a;return this};CommonUserManagementSectionsBuilderParams.prototype.setUserId=function(a){this._userId=a;return this};
CommonUserManagementSectionsBuilderParams.prototype.setAccountSettings=function(a){this._showPermissionsSection=(this._accountSettings=a)?!0:!1;return this};CommonUserManagementSectionsBuilderParams.prototype.setEditedUserIsLoggedIn=function(a){this._editedUserIsLoggedIn=a;return this};CommonUserManagementSectionsBuilderParams.prototype.setFirstTTDate=function(a){this._firstTTDate=a?Date.parseJSONDate(a):null;return this};
CommonUserManagementSectionsBuilderParams.prototype.setFirstRequestDate=function(a){this._firstRequestDate=a?Date.parseJSONDate(a):null;return this};CommonUserManagementSectionsBuilderParams.prototype.setRatesTableStrategy=function(a){this._ratesTableStrategy=a;return this};CommonUserManagementSectionsBuilderParams.prototype.copyParams=function(a){if(this.invalid)throw Error("UserManagementSectionsBuilderParams is invalid");for(var b in this)this.hasOwnProperty(b)&&(a[b]=this[b]);this.invalid=!0};
ActitimeUserManagementSectionsBuilderParams=function(){this._ptoHoursPerDay=null};ActitimeUserManagementSectionsBuilderParams.prototype=new CommonUserManagementSectionsBuilderParams;ActitimeUserManagementSectionsBuilderParams.prototype.setUserManagementSectionsBuilderParams=function(a){this.commonUserManagementSectionsBuilderParams=a;return this};ActitimeUserManagementSectionsBuilderParams.prototype.setPtoHoursPerDay=function(a){this._ptoHoursPerDay=a;return this};
ActitimeUserManagementSectionsBuilderParams.prototype.copyParams=function(a){this.commonUserManagementSectionsBuilderParams.copyParams(a);CommonUserManagementSectionsBuilderParams.prototype.copyParams.call(this,a)};ActiplansUserManagementSectionsBuilderParams=function(){};ActiplansUserManagementSectionsBuilderParams.prototype=new CommonUserManagementSectionsBuilderParams;
ActiplansUserManagementSectionsBuilderParams.prototype.setUserManagementSectionsBuilderParams=function(a){this.commonUserManagementSectionsBuilderParams=a;return this};ActiplansUserManagementSectionsBuilderParams.prototype.copyParams=function(a){this.commonUserManagementSectionsBuilderParams.copyParams(a);delete this.commonUserManagementSectionsBuilderParams;CommonUserManagementSectionsBuilderParams.prototype.copyParams.call(this,a)};
function UserManagementSectionsBuilder(){this.constructor=UserManagementSectionsBuilder}UserManagementSectionsBuilder.prototype.init=function(a){a.copyParams(this);return this};UserManagementSectionsBuilder.prototype.createSections=function(){};UserManagementSectionsBuilder.prototype.getSectionsErrorsHandler=function(){};UserManagementSectionsBuilder.prototype.getUserInputDataFetcher=function(){};UserManagementSectionsBuilder.prototype.initAfterShowing=function(a){};
function ActiplansUserManagementSectionsBuilder(){}ActiplansUserManagementSectionsBuilder.prototype=new UserManagementSectionsBuilder;ActiplansUserManagementSectionsBuilder.prototype.init=function(a,b,c,d,e,f,g,h,k){UserManagementSectionsBuilder.prototype.init.call(this,a,b,c,d,e,f,null,g,null,null,h,k,null);return this};
ActiplansUserManagementSectionsBuilder.prototype.createSections=function(a,b,c,d,e,f,g,h){var k=[];this._accountInformationSection=this._preparatoryStrategy.getAccountInformationSectionConstructor().init({lightBoxEl:c,userManagementData:this._userManagementData,currentTime:this._currentTime,userId:this._userId,accountSettings:this._accountSettings,changesCallback:a,validateCallback:b,checkUsernameErrorHandler:d,corporateSchedule:this._defaultWorkSchedule,userGroupsEnabled:this._userManagementData.viewerSettings.userGroupsEnabled,
timeZoneGroupsEnabled:this._userManagementData.viewerSettings.timeZoneGroupsEnabled,firstTTDate:this._firstTTDate,firstLeaveRequestDate:this._firstRequestDate,editedUserIsSelf:this._editedUserIsLoggedIn,handlerIfNoSuchUserAfterAjax:f,specificVersionDrawerConstructor:this._preparatoryStrategy.getVersionSpecificDrawer(),scrollableContainerEl:this._preparatoryStrategy.getScrollableContainerEl(c),showGroupRows:!0,needValidation:!0,disableEmptyUsernameCheck:!1,disableDuplicateUsernameCheck:!1,releaseDateLabelEl:$(document.getElementsByClassName("releaseDateLabel")),
hireDateLabelEl:$(document.getElementsByClassName("hireDateLabel"))});this._accountInformationSection.setState({accessToOtherProductEditable:h,enabledInOtherProduct:this._accountSettings.enabledInOtherProduct,editSelf:this._editedUserIsLoggedIn});this._workScheduleSection=(new WorkScheduleSection).init(this._workdayDurationsTableBuilder,c,this._userManagementData,this._accountSettings,a,b,g,this._preparatoryStrategy.getScrollableContainerEl(c));$(c).toggleClass("overtimeSectionOff",!g);k.push(this._accountInformationSection);
k.push(this._workScheduleSection);this._preparatoryStrategy.prepareSections(this._accountInformationSection,null,e);return k};ActiplansUserManagementSectionsBuilder.prototype.getSectionsErrorsHandler=function(){return(new SectionsErrorsHandler).init(this._accountInformationSection)};ActiplansUserManagementSectionsBuilder.prototype.getUserInputDataFetcher=function(){return(new ActiplansUserInputDataFetcher).init(this._accountInformationSection,this._workScheduleSection)};
ActiplansUserManagementSectionsBuilder.prototype.initAfterShowing=function(a){a&&this._accountInformationSection.setFocusIntoFirstNameField()};function UserInputDataFetcher(){}UserInputDataFetcher.prototype.init=function(){};UserInputDataFetcher.prototype.getUserInputData=function(){};UserInputDataFetcher.prototype.getCreateUserInputData=function(){};
UserInputDataFetcher.prototype.getUserInputDataThatNotWillBeCopied=function(a){var b=this._accountSection,c=null;a.viewerSettings.allowedToManageAccountSettings&&(c=b.getReleaseDate(),c={id:b.getUserId(),firstName:b.getFirstName(),lastName:b.getLastName(),middleInitial:b.getMiddleInitial(),enabled:b.isEnabled(),enabledInOtherProduct:b.isEnabledInOtherProduct(),email:b.getEmail(),hireDate:b.getHireDate().toJSONString(),releaseDate:c?c.toJSONString():null},(b=b.getSpecificNotCopyValues())&&$.extend(c,
{passwordData:b.passwordData,username:b.username}));return c};UserInputDataFetcher.prototype.getUserInputDataForAccountCreatedState=function(a){var b=this._accountSection,c=null;a.viewerSettings.allowedToManageAccountSettings&&(c={firstName:b.getFirstName(),lastName:b.getLastName(),middleInitial:b.getMiddleInitial(),email:b.getEmail(),hireDate:b.getHireDate().toJSONString()});return c};function ActitimeUserInputDataFetcher(){}ActitimeUserInputDataFetcher.prototype=new UserInputDataFetcher;
ActitimeUserInputDataFetcher.prototype.init=function(a,b,c,d){this._accountSection=a;this._workScheduleAndOvertimeSection=b;this._userRatesSection=c;this._permissionsSection=d;return this};
ActitimeUserInputDataFetcher.prototype.getCreateUserInputData=function(a){var b=this._accountSection,c=this._workScheduleAndOvertimeSection,d=this._userRatesSection,e=this._permissionsSection,f=null,g=null,h=null,k,l;a.viewerSettings.allowedToManageAccountSettings&&(l=e?e.getSelectedRights():null,a=b.getReleaseDate(),l={firstName:b.getFirstName(),lastName:b.getLastName(),middleInitial:b.getMiddleInitial(),enabled:b.isEnabled(),enabledInOtherProduct:b.isEnabledInOtherProduct(),userGroupId:b.getUserGroupId(),
timeZoneGroupId:b.getTimeZoneGroupId(),overtimeLevel:c.getOvertimeTrackingLevel(),email:b.getEmail(),hireDate:b.getHireDate().toJSONString(),releaseDate:a?a.toJSONString():null,initialSchedule:c.getInitialSchedule(),defaultInitialSchedule:c.isDefaultInitialSchedule(),workSchedule:c.getSchedules(),rates:d?d.getRates():null,accessRights:l},c=this._accountSection.getSpecificValues(),$.extend(l,{username:c.username}),f=c.newPassword,g=b.getNewUserGroupName(),h=b.getNewTimeZoneGroup(),k=b.getUserId());
return[k,l,g,h,f]};ActitimeUserInputDataFetcher.prototype.getUserInputData=function(a){var b=this.getCreateUserInputData(a);a.viewerSettings.allowedToManageAccountSettings&&(b[1].overtimeLevel=this._workScheduleAndOvertimeSection.getOvertimeTrackingLevel());return b};function ActiplansUserInputDataFetcher(){}ActiplansUserInputDataFetcher.prototype=new UserInputDataFetcher;ActiplansUserInputDataFetcher.prototype.init=function(a,b){this._accountSection=a;this._workScheduleSection=b;return this};
ActiplansUserInputDataFetcher.prototype.getCreateUserInputData=function(){return this.getUserInputData()};
ActiplansUserInputDataFetcher.prototype.getUserInputData=function(){var a=this._accountSection,b=this._workScheduleSection,c=a.getReleaseDate(),b={firstName:a.getFirstName(),lastName:a.getLastName(),middleInitial:a.getMiddleInitial(),enabled:a.isEnabled(),enabledInOtherProduct:a.isEnabledInOtherProduct(),userGroupId:a.getUserGroupId(),timeZoneGroupId:a.getTimeZoneGroupId(),email:a.getEmail(),hireDate:a.getHireDate().toJSONString(),releaseDate:c?c.toJSONString():null,initialSchedule:b.getInitialSchedule(),
defaultInitialSchedule:b.isDefaultInitialSchedule(),workSchedule:b.getSchedules()},c=this._accountSection.getSpecificValues();$.extend(b,{username:c.username});var c=c.newPassword,d=a.getNewUserGroupName(),e=a.getNewTimeZoneGroup();return[a.getUserId(),b,d,e,c]};function WorkScheduleSection(){}WorkScheduleSection.prototype=new BaseUserDataSection;WorkScheduleSection.prototype.init=function(a,b,c,d,e,f,g,h){BaseUserDataSection.prototype.init.call(this,b,e,f);this._sectionEl=this._getSectionEl();b=this.getElementBySubId("scheduleDurationsTablePlaceholder");this._workdayDurationsTable=a.createTable(this._sectionEl,b,d,e,f,h);return this};WorkScheduleSection.prototype._getSectionEl=function(){return this.getElementBySubId("workScheduleSection")};
WorkScheduleSection.prototype.hasErrors=function(){return this._workdayDurationsTable.hasErrors()};WorkScheduleSection.prototype.validate=function(){return this._workdayDurationsTable.validate()};WorkScheduleSection.prototype.getInitialSchedule=function(){return this._workdayDurationsTable.getInitialSchedule()};WorkScheduleSection.prototype.isDefaultInitialSchedule=function(){return this._workdayDurationsTable.isDefaultInitialSchedule()};WorkScheduleSection.prototype.getSchedules=function(){return this._workdayDurationsTable.getSchedules()};
WorkScheduleSection.prototype.updateUI=function(){this._workdayDurationsTable.updateUI()};WorkScheduleSection.prototype.getSectionElement=function(){return this._sectionEl};function AddButtonStrategy(){}AddButtonStrategy.prototype.init=function(){};AddButtonStrategy.prototype.callback=function(){};function AddButtonOnlineStrategy(){}
AddButtonOnlineStrategy.prototype=_.create(AddButtonStrategy.prototype,{init:function(a,b,c){this.$addUserButton=a;var d=this;a=$("<div>").addClass("content");var e=function(a,b,c,e){b=$("<div>").addClass("item "+(b?b:""));e&&(e=function(a){$(".inviteUserModePopup").toggleClass("beakColor",a)},b.hover(_.bind(e,this,!0),_.bind(e,this,!1)));b.append($("<div>").addClass("label").text(messageResource.getMessage(a)));b.click(function(){d.inviteUserModeDialog.hide();c&&c()});return b};a.append(e("userlist.js.invite_user_mode_popup.invite_user",
"addOneUserIcon",b,!0));a.append(e("userlist.js.invite_user_mode_popup.invite_several_users","inviteSeveralUsersIcon",c,!1));this.inviteUserModeDialog=new DropdownDialog({wrapperClass:"inviteUserModePopup",dialogDiv:a,notModal:!1,hideButtons:!0,hideOnResize:!0,showEmptyTitleBar:!1});return this},callback:function(){this.inviteUserModeDialog.showAt(this.$addUserButton[0],{offset:"-114px 10px"})}});function AddButtonDownloadableStrategy(){}
AddButtonDownloadableStrategy.prototype=_.create(AddButtonStrategy.prototype,{init:function(a){this.clickCallback=a;return this},callback:function(){this.clickCallback&&this.clickCallback()}});function DisablePopup(){}
DisablePopup.prototype=_.create(DHTMLPopupWithMoire.prototype,{init:function(a,b){this._popupId="disablePopup";this._popupEl=$("#disablePopup");DHTMLPopupWithMoire.call(this,this._popupId);this.initInnerContent(a,b);this.$cancel=this._popupEl.find(".cancelButton");this.$close=this._popupEl.find(".closeButton");this.$disable=this._popupEl.find(".disableButton");this.$disable.remove("disable");this.spinnerController=new SpinnerController;this.$spinner=this._popupEl.find(".spinner");this.disableDisableButton=
!1;this.$cancel.click(_.bind(this.hide,this));this.$close.click(_.bind(this.hide,this));a==b?this.$disable.click(_.bind(this.disable,this)):this.$disable.click(_.bind(this.disableOther,this));return this},hideOnMouseDown:function(){return!1},hideOnResize:function(){return!1},initInnerContent:function(a,b){var c=a==b,d=this._popupEl.find(".firstIcon"),e=this._popupEl.find(".secondIcon");a==Product.actiTIME?(d.find(".product").text(messageResource.getMessage("product.actitime")),e.find(".product").text(messageResource.getMessage("product.actiplans")),
d.addClass("aTIcon"),e.addClass("aPIcon"),b==Product.actiTIME?d.addClass("disable"):e.addClass("disable")):(d.find(".product").text(messageResource.getMessage("product.actiplans")),e.find(".product").text(messageResource.getMessage("product.actitime")),d.addClass("aPIcon"),e.addClass("aTIcon"),b==Product.actiPLANS?d.addClass("disable"):e.addClass("disable"));c?(this._popupEl.find(".title").text(messageResource.getMessage("disable_popup.current_product.title")),this._popupEl.find(".description").text(messageResource.getMessage("disable_popup.current_product.description")),
this._popupEl.find(".disableButton").text(messageResource.getMessage("disable_popup.current_product.comform")),this._popupEl.find(".cancelButton").text(messageResource.getMessage("disable_popup.current_product.cancel"))):(this._popupEl.find(".title").text(messageResource.getMessage("disable_popup.title")),this._popupEl.find(".description").text(messageResource.getMessage("disable_popup.description")),this._popupEl.find(".disableButton").text(messageResource.getMessage("disable_popup.comform")),this._popupEl.find(".cancelButton").text(messageResource.getMessage("disable_popup.cancel")))},
show:function(){this.spinnerController.stop();DHTMLPopupWithMoire.prototype.show.call(this)},hide:function(){this.spinnerController.stop();DHTMLPopupWithMoire.prototype.hide.call(this)},disable:function(){this._disableProduct("IntegrationService.disableProduct")},disableOther:function(){this._disableProduct("IntegrationService.disableOtherProduct")},_disableProduct:function(a){if(!this.disableDisableButton){this.$disable.addClass("disable");var b=this;this.disableDisableButton=!0;this.spinnerController.spinInElement(this.$spinner);
makeRpcCall(a,[],function(){b.$disable.remove("disable");b.spinnerController.stop();b.disableDisableButton=!1;b.hide();window.location.reload()},function(a,d,e){b.$disable.remove("disable");b.spinnerController.stop();b.disableDisableButton=!1;return b._rpcErrorHandler(a,d,e)},null,12E4)}},_rpcErrorHandler:function(a,b,c){return"com.actimind.common.integration.NoRightsForDisableProductException"==c.exception?(alert(messageResource.getMessage("integration.js.error.no_rights_for_integration")),!0):"com.actimind.common.util.PWSCommunicationException"==
c.exception?(alert(messageResource.getMessage("integration.js.error.hms_pvs_communication_error")),!0):!1}});function AboutPopup(a){DHTMLPopupWithMoire.call(this,a)}
AboutPopup.prototype=_.create(DHTMLPopupWithMoire.prototype,{hideOnMouseDown:_.constant(!1),hideOnResize:_.constant(!1),hideOnEscape:_.constant(!0),show:function(){var a=this.message_nUserAccountsUsed,b=this.message_oneUserAccountUsed;DHTMLPopupWithMoire.prototype.show.call(this);$("#aboutPopupCloseButtonId").click(_.bind(this.hide,this));$("#aboutPopup_usedUserAccounts").html("&nbsp;");this._requestObject=makeRpcCall("UserManagementService.getActiveUsersNumber",[],function(c){$("#aboutPopup_usedUserAccounts").html(1==
c?b:messageResource.applyParamsSubstitutions(a,[c],0))},function(){return!0});var c;this.isShowSystemInfo?(c=Math.round($("#aboutSystemInfoTable").outerHeight()),$("#aboutProductInfoTable").css("height",c)):(c=Math.round($("#aboutProductInfoTable").outerHeight()),$("#aboutSystemInfoTable").css("height",c));$("#aboutContentCell").css("height",c+30)},hide:function(){DHTMLPopupWithMoire.prototype.hide.call(this);this._requestObject&&this._requestObject.abort()},init:function(){this.message_nUserAccountsUsed=
messageResource.getMessage("about.license.n_user_accounts_used");this.message_oneUserAccountUsed=messageResource.getMessage("about.license.one_user_account_used");var a=$("#productInfoTab"),b=$("#systemInfoTab"),c=$("#aboutContentCell");a.click(function(){c.removeClass("systemInfoTabSelected");c.addClass("productInfoTabSelected");this.isShowSystemInfo=!1});b.click(function(){c.removeClass("productInfoTabSelected");c.addClass("systemInfoTabSelected");this.isShowSystemInfo=!0});return this}});function WorkdayDurationsViewer(){}WorkdayDurationsViewer.prototype=_.create(WorkdayDurationsEditor.prototype);WorkdayDurationsViewer.prototype.init=function(a,b,c,d,e){WorkdayDurationsEditor.prototype.init.call(this,a,b,c,d,e);for(a=0;a<this.inputs.length;a++)this.inputs[a].readOnly=!0;return this};WorkdayDurationsViewer.prototype.getTableClassName=function(){return"wdEditor modificationsProhibited"};
WorkdayDurationsViewer.prototype.onBlur=function(a){a.value=trim(a.value);this.removeBorderClasses(a.parentNode,"focus")};function TotalCellRenderer(){}TotalCellRenderer.prototype=_.create(TableCellRenderer.prototype);TotalCellRenderer.prototype.init=function(){return this};TotalCellRenderer.prototype.generateContent=function(a){a.getCellEl().innerHTML=UserTime.formatTime(a.getValue())};TotalCellRenderer.prototype.updateUI=function(a){this.generateContent(a);a.getCellEl().className="totalCell"};function InitialScheduleCellRenderer(){}InitialScheduleCellRenderer.prototype=_.create(TableCellRenderer.prototype);InitialScheduleCellRenderer.prototype.init=function(){TableCellRenderer.call(this);return this};
InitialScheduleCellRenderer.prototype.generateContent=function(a){a.getCellEl().innerHTML="<div class ='caption'>"+messageResource.getMessage("user.add_edit.js.wd_editor.initial_schedule_row_header")+"</div><div class ='current'>"+messageResource.getMessage("user.add_edit.js.wd_editor.working_schedule_current")+"</div>"};InitialScheduleCellRenderer.prototype.getCellClassName=function(a){return["initialScheduleCell"]};function CreateUserWorkdayDurationsTable(){}CreateUserWorkdayDurationsTable.prototype=_.create(TabularDataTable.prototype);CreateUserWorkdayDurationsTable.prototype.init=function(a,b,c,d){this.userManagementData=a;TabularDataTable.prototype.init.call(this,this.buildHeader(),c,d);this.addRow(this.createInitialRow(b.defaultInitialSchedule,b.initialSchedule,a,c));return this};
CreateUserWorkdayDurationsTable.prototype.createInitialRow=function(a,b,c,d){var e=this,f=(new DurationsCellRenderer).init(d,c.weekStartDay,!1,c.decimalSeparator),g=(new DurationsCellValidator).init(),h=(new TotalCellRenderer).init(),k=(new SetAsDefaultCellRenderer).init(),l=(new WorkdayDurationsTableRow).init(c.defaultWorkSchedule,0,!1,d);l.setMarkedAsDefault(a);l.setInPast(!1);c=(new WorkingScheduleCellRenderer).init();d=(new TabularDataTableCell).init(null,(new NotNullCellValidator).init(),this);
d.setRenderer(c);l.addCellObj(d,!1);this.durationsCell=l.createDurationsCell(b,g,f);l.addCellObj(this.durationsCell,!0);b=l.createTotalCell(WorkdayDurationsEditor.sumDurations(b),h);l.addCellObj(b,!1);a=l.createSetAsDefaultCell(a,k);l.addCellObj(a,!1);l.setupTotalAndDefaultCellUpdates(b,a,this.durationsCell,function(){$(e).trigger("initialScheduleChanged",[l])});return l};CreateUserWorkdayDurationsTable.prototype.buildHeader=function(){return WorkdayDurationsEditor.buildTableHeader(this.userManagementData.weekStartDay)};
CreateUserWorkdayDurationsTable.prototype.getBaseTableClasses=function(){return TabularDataTable.prototype.getBaseTableClasses.call(this).concat(["wdTable","createMode"])};CreateUserWorkdayDurationsTable.prototype.getInitialSchedule=function(){return this.durationsCell.getValue()};CreateUserWorkdayDurationsTable.prototype.isDefaultInitialSchedule=function(){return this.durationsCell.getRow().isMarkedAsDefault()};CreateUserWorkdayDurationsTable.prototype.getSchedules=function(){return null};function EditUserWorkdayDurationsTable(){}EditUserWorkdayDurationsTable.prototype=_.create(TabularDataWithEffectiveDatesTable.prototype);
EditUserWorkdayDurationsTable.prototype.init=function(a,b,c,d,e,f,g,h){this.currentDate=a.todayInViewerTimeZone.parseJSONDate().truncateTime();this.userManagementData=a;this.changesCallback=c;TabularDataWithEffectiveDatesTable.prototype.init.call(this,this.buildHeader(),c,d,g);this.durationsCellRenderer=(new DurationsCellRenderer).init(c,a.weekStartDay,!1,a.decimalSeparator);this.durationsCellValidator=(new DurationsCellValidator).init();this.totalCellRenderer=(new TotalCellRenderer).init();this.effectiveDateCellRenderer=
(new EffectiveDateCellRenderer).init(a.invertedDaysMap,a.weekStartDay,c,messageResource.getMessage("user.add_edit.js.wd_editor.effective_date_prefix"),e,f);this.effectiveDateCellValidator=(new NotNullCellValidator).init();this.setAsDefaultCellRenderer=(new SetAsDefaultCellRenderer).init();this.removeRowCellRenderer=h;this.addRow(this.createInitialRow(b.defaultInitialSchedule,b.initialSchedule,a,c));for(a=0;a<b.workSchedule.length;a++)this.addRow(this.createScheduleRow(b.workSchedule[a],!1));this.getTableEl().appendChild(this.buildFooter());
return this};
EditUserWorkdayDurationsTable.prototype.createInitialRow=function(a,b,c,d){var e=this,f=(new InitialScheduleCellRenderer).init(),g=(new WorkdayDurationsTableRow).init(c.defaultWorkSchedule,1,!1,d);g.setMarkedAsDefault(a);g.setInPast(!1);c=(new TabularDataTableCell).init(null,(new NotNullCellValidator).init(),this);c.setRenderer(f);g.addCellObj(c,!1);this.initialScheduleDurationsCell=g.createDurationsCell(b,this.durationsCellValidator,this.durationsCellRenderer);g.addCellObj(this.initialScheduleDurationsCell,!0);
b=g.createTotalCell(WorkdayDurationsEditor.sumDurations(b),this.totalCellRenderer);g.addCellObj(b,!1);a=g.createSetAsDefaultCell(a,this.setAsDefaultCellRenderer);g.addCellObj(a,!1);g.setupTotalAndDefaultCellUpdates(b,a,this.initialScheduleDurationsCell,function(){$(e).trigger("initialScheduleChanged",[g])});a=new TableCell("",this);b=new TableCellRenderer;a.setRenderer(b);g.addCellObj(a,!1);g.loadingCell=new LoadingCell;g.addCellObj(g.loadingCell);return g};
EditUserWorkdayDurationsTable.prototype.getInitialSchedule=function(){return this.initialScheduleDurationsCell.getValue()};EditUserWorkdayDurationsTable.prototype.isDefaultInitialSchedule=function(){return this.initialScheduleDurationsCell.getRow().isMarkedAsDefault()};EditUserWorkdayDurationsTable.prototype.processSchedules=function(a){_.forEach(a,_.bind(this._processSchedule,this));this.markRowsWithEqualEffectiveDatesAsInvalid();this.updateEffectiveRow()};
EditUserWorkdayDurationsTable.prototype._processSchedule=function(a){for(var b=1;b<this.rows.length;b++)if(this.rows[b].oldEffectiveDate===a.oldEffectiveDate){a=this.createScheduleRow(a,!1);this.updateRow(b,a);return}this.addRow(this.createScheduleRow(a,!1))};
EditUserWorkdayDurationsTable.prototype.getSchedules=function(){for(var a=[],b=1;b<this.rows.length;b++){var c=this.rows[b];c.isMarkedToRemove()||c.hasErrors()||null===c.cells[0].getValue()||a.push({effectiveDate:c.cells[0].getValue().toJSON(),durations:c.cells[1].getValue(),sameAsDefault:c.isMarkedAsDefault(),oldEffectiveDate:c.getOldEffectiveDate()})}return a};
EditUserWorkdayDurationsTable.prototype.getEffectiveRowIdx=function(){var a=TabularDataWithEffectiveDatesTable.prototype.getEffectiveRowIdx.call(this);return null==a?0:a};EditUserWorkdayDurationsTable.prototype.resetDefaultIfDateInThePastAndUpdatePastFlag=function(a){var b=a.getValue()&&a.getValue().truncateTime()<this.currentDate;a=a.getRow();if(b){var c=a.cells[3];1==c.getValue()&&(c.setValue(!1),c.updateUI())}a.isInPast()!=b&&(a.setInPast(b),a.updateRowClasses())};
EditUserWorkdayDurationsTable.prototype.getBaseRowClasses=function(a){return TabularDataWithEffectiveDatesTable.prototype.getBaseRowClasses.call(this,a).concat(this.getRow(a).getRowClasses())};EditUserWorkdayDurationsTable.prototype.updateEffectiveRow=function(){var a=TabularDataWithEffectiveDatesTable.prototype.updateEffectiveRow.call(this),b=this.getRow(0);b.setInPast(0!=a);b.isInPast()&&(b.cells[3].setValueNoValidate(!1),b.setMarkedAsDefault(!1));b.updateUI()};
EditUserWorkdayDurationsTable.prototype.createScheduleRow=function(a,b){var c=(new WorkdayDurationsTableRow).init(this.userManagementData.defaultWorkSchedule,1,b,this.changesCallback),d=a.effectiveDate&&a.effectiveDate.parseJSONDate()<this.currentDate;c.setMarkedAsDefault(!d&&a.sameAsDefault);c.setInPast(d);c.setOldEffectiveDate(a.effectiveDate);var e=this,f=(new TabularDataTableCell).init(a.effectiveDate?a.effectiveDate.parseJSONDate():null,this.effectiveDateCellValidator,this);f.setRenderer(this.effectiveDateCellRenderer);
f.onChange(function(){e.markRowsWithEqualEffectiveDatesAsInvalid();e.updateEffectiveRow();e.resetDefaultIfDateInThePastAndUpdatePastFlag(f);c.hasErrors()||e.triggerUpdateEvent(c)});c.addCellObj(f,!0);d=c.createDurationsCell(a.durations,this.durationsCellValidator,this.durationsCellRenderer);c.addCellObj(d,!0);var g=c.createTotalCell(WorkdayDurationsEditor.sumDurations(a.durations),this.totalCellRenderer);c.addCellObj(g,!1);var h=c.createSetAsDefaultCell(c.isMarkedAsDefault(),(new SetAsDefaultCellRenderer).init());
c.addCellObj(h,!1);c.setupTotalAndDefaultCellUpdates(g,h,d,function(){e.triggerUpdateEvent(c)});d=new TableCell(null,this);d.setRenderer(b?(new RemoveRowCellRenderer).init():this.removeRowCellRenderer);c.addCellObj(d,!1);c.loadingCell=new LoadingCell;c.addCellObj(c.loadingCell);return c};EditUserWorkdayDurationsTable.prototype.buildHeader=function(){return WorkdayDurationsEditor.buildTableHeader(this.userManagementData.weekStartDay)};
EditUserWorkdayDurationsTable.prototype.buildFooter=function(){var a=document.createElement("tfoot"),b=document.createElement("tr");b.className="addRecord";var c=document.createElement("td");c.className="addRecordCell";var d=document.createElement("a"),e=document.createElement("a");d.className="img";e.className="text";d.innerHTML="&nbsp;";e.innerHTML=messageResource.getMessage("user.add_edit.js.wd_editor.new_schedule");var f=this,g=function(){f.addEmptyRow()};d.onclick=g;e.onclick=g;a.appendChild(b);
b.appendChild(c);c.appendChild(d);c.appendChild(e);return a};EditUserWorkdayDurationsTable.prototype.addEmptyRow=function(){TabularDataWithEffectiveDatesTable.prototype.addEmptyRow.call(this);this.triggerUpdateEvent(_.last(this.rows));this.changesCallback(!0)};
EditUserWorkdayDurationsTable.prototype.createEmptyRow=function(){for(var a=this.currentDate.toJSON(),b=1;b<this.rows.length;b++)if(!this.rows[b].isMarkedToRemove()){var c=this.rows[b].cells[0].getValue();if(c&&c.toJSON()==a){a=null;break}}a={effectiveDate:a,durations:this.userManagementData.defaultWorkSchedule.slice(0),sameAsDefault:!0};return this.createScheduleRow(a,!0)};
EditUserWorkdayDurationsTable.prototype.triggerUpdateEvent=function(a){a.hasErrors()||a.isEmpty()||$(this).trigger("schedulesChanged",[a])};EditUserWorkdayDurationsTable.prototype.getBaseTableClasses=function(){return TabularDataTable.prototype.getBaseTableClasses.call(this).concat(["wdTable","editMode"])};function DurationsCellRenderer(){}DurationsCellRenderer.prototype=_.create(TableCellRenderer.prototype);DurationsCellRenderer.prototype.init=function(a,b,c,d){this.changesCallback=a;this.weekStartDay=b;this.showEditorHeader=c;this._decimalSeparator=d;return this};
DurationsCellRenderer.prototype.generateContent=function(a){var b=this,c=(new WorkdayDurationsEditor).init(a.getValue(),this.weekStartDay,function(){a.setValue(c.getDurations());b.changesCallback()},this.showEditorHeader,null,this._decimalSeparator);c.renderTo(a.getCellEl());a.workdayDurationsEditor=c};
DurationsCellRenderer.prototype.updateUI=function(a){TableCellRenderer.prototype.updateUI.call(this,a);a.getCellEl().className="durationsCell";a.workdayDurationsEditor.setDurations(a.getValue());a.workdayDurationsEditor.setInputDisabled(a.getRow().isMarkedToRemove()||a.getRow().isMarkedAsDefault());a.workdayDurationsEditor.updateUI()};function DurationsCellValidator(){}DurationsCellValidator.prototype=_.create(TabularDataTableCellValidator.prototype);DurationsCellValidator.prototype.init=function(){TabularDataTableCellValidator.prototype.init.call(this);return this};DurationsCellValidator.prototype.isEmpty=function(a){return!1};DurationsCellValidator.prototype.isValid=function(a){a=a.getValue();for(var b=0;b<a.length;b++)if(null==a[b])return!1;return!0};function WorkingScheduleCellRenderer(){}WorkingScheduleCellRenderer.prototype=_.create(TableCellRenderer.prototype);WorkingScheduleCellRenderer.prototype.init=function(){TableCellRenderer.call(this);return this};WorkingScheduleCellRenderer.prototype.generateContent=function(a){a.getCellEl().innerHTML=messageResource.getMessage("user.add_edit.js.wd_editor.working_schedule_row_header")};WorkingScheduleCellRenderer.prototype.getCellClassName=function(a){return["workingSchedule"]};function SetAsDefaultCellRenderer(){}SetAsDefaultCellRenderer.prototype=_.create(TableCellRenderer.prototype);SetAsDefaultCellRenderer.prototype.init=function(a){this.onClickCallBack=a;return this};SetAsDefaultCellRenderer.prototype.getCheckbox=function(a){return a.getCellEl().firstChild.firstChild.firstChild.firstChild.firstChild.firstChild};
SetAsDefaultCellRenderer.prototype.generateContent=function(a){a.getCellEl().innerHTML="<label><table cellpadding=0 cellspacing=4 border=0><tr><td><input type='checkbox'></td><td valign=top class='checkbox_description'>"+messageResource.getMessage("user.add_edit.js.wd_editor.use_corporate_settings")+"</td></tr></table></label>";disableTextSelection(a.getCellEl());var b=this;this.getCheckbox(a).onclick=function(){a.setValue(this.checked);if(b.onClickCallBack)b.onClickCallBack()}};
SetAsDefaultCellRenderer.prototype.updateUI=function(a){var b=this.getCheckbox(a);b.checked=a.getValue()?!0:!1;b.disabled=a.getRow().isMarkedToRemove();a.getCellEl().className="setAsDefaultCell"};CertainUserFilter=function(a){TreeFilter.call(this);this._rootNode=a};CertainUserFilter.prototype=_.create(TreeFilter.prototype);CertainUserFilter.prototype.setUserIdToHide=function(a){this._userIdToHide=a};CertainUserFilter.prototype.doFilter=function(){var a=new TreeNodeSet,b=this.findNodeWithId(this._rootNode,this._userIdToHide);b&&a.add(b);return a};
CertainUserFilter.prototype.findNodeWithId=function(a,b){if(0<a.level&&a.value.id===b)return a;for(var c=a.getChildren(),d=0;d<c.length;d++){var e=this.findNodeWithId(c[d],b);if(e)return e}return!1};CertainUserFilter.prototype.containsTokens=function(){return!1};function LazyTree(a,b){TriStateSelectorTree.call(this,a,b,null);this._treeDomAlreadyBuilded=!1}LazyTree.prototype=_.create(TriStateSelectorTree.prototype);LazyTree.prototype.treeShownCallBack=function(a,b){this._treeDomAlreadyBuilded?this.applyFilter(b):($(a).html(""),Tree.prototype.buildDOM.call(this,a,b),this._treeDomAlreadyBuilded=!0)};function SingleItemTreeSelectionController(a,b){TriStateSelectionController.call(this,a);this.selectionNodeType=b}SingleItemTreeSelectionController.prototype=_.create(TriStateSelectionController.prototype);SingleItemTreeSelectionController.prototype.toggle=function(a){a.getType()==this.selectionNodeType&&(this.deselectAll(),this.nodeSelected(a))};function ApproverNodeRenderer(a,b,c){SimpleCheckboxNodeRenderer.call(this,a,b,c)}ApproverNodeRenderer.prototype=_.create(SimpleCheckboxNodeRenderer.prototype);ApproverNodeRenderer.prototype.generateLabel=function(a,b){var c=a.getValue(),d=c.firstName,e=c.lastName;b.innerHTML=UserNameFormat.formatLFM(escapeHtmlSymbols(d),escapeHtmlSymbols(e),escapeHtmlSymbols(c.middleInitial));b.title=UserNameFormat.formatLFM(d,e,c.middleInitial)};
ApproverNodeRenderer.prototype.appendAdditionalElements=function(a,b){var c=this,d=document.createElement("div");d.className="canManageAllUsersWarning";var e=$("#approverManagesAllUsersTooltip"),f=b.getValue(),g=UserNameFormat.formatFML(f.firstName,f.lastName,f.middleInitial);$(d).hover(function(a){var b=$(d).closest("div.node").hasClass("selected"),b=messageResource.getEscapedMessage(b?"user_list.approver_manages_all_users.tooltip.text":"user_list.approver__no_longer_manages_all_users.tooltip.text",
[g]);e.html(b);e.zIndex($(d).closest("div.ui-dialog.approversDialog").zIndex()+1);c.showNodeTooltip(e,a)},function(){c.hideNodeTooltip(e)});a.appendChild(d)};ApproverNodeRenderer.prototype.getNodeClasses=function(a){var b=SimpleCheckboxNodeRenderer.prototype.getNodeClasses.call(this,a);a.getValue().canManageAllUsers&&b.push("canManageAllUsers");return b};function UserSelectorAccessRight(a,b,c,d,e){this.id=a;this.nameKey=b;this.name=null;this.selectAllMessageKey=c?c:"common.users_selector.access_right.select_all";this.filterMessageKey=d?d:"common.users_selector.access_right.show_users_without_right";this.userNoRightsMessageKey=e?e:"common.users_selector.access_right.insufficient_rights";this.name=this.nameKey?messageResource.getMessage(this.nameKey):""}UserSelectorAccessRight.prototype.getId=function(){return this.id};
UserSelectorAccessRight.prototype.isGranted=function(a){return isArrayContains(a,this.id)};UserSelectorAccessRight.prototype.getSelectAllMessage=function(){return messageResource.getMessage(this.selectAllMessageKey,[this.name])};UserSelectorAccessRight.prototype.getFilterMessage=function(){return messageResource.getMessage(this.filterMessageKey,[this.name])};UserSelectorAccessRight.prototype.getUserNoRightsMessage=function(){return messageResource.getMessage(this.userNoRightsMessageKey,[this.name])};
UserSelectorAccessRight.prototype.getName=function(){return this.name};function ManageTasksRight(){UserSelectorAccessRight.call(this,window.__GENERATED_CONSTANTS__.AccessRight.MANAGE_TASKS);this.name=messageResource.getMessage("common.users_selector.access_right.manage_tasks")}ManageTasksRight.prototype=_.create(UserSelectorAccessRight.prototype);
function GenerateMoneyReportRight(){UserSelectorAccessRight.call(this,window.__GENERATED_CONSTANTS__.AccessRight.GENERATE_MONEY_REPORTS,"common.users_selector.access_right.generate_money_reports")}GenerateMoneyReportRight.prototype=new UserSelectorAccessRight;function GenerateTimeReportRight(){UserSelectorAccessRight.call(this,window.__GENERATED_CONSTANTS__.AccessRight.GENERATE_TIME_REPORTS,"common.users_selector.access_right.generate_time_reports")}GenerateTimeReportRight.prototype=new UserSelectorAccessRight;
function SubmitTimeTrackRight(){UserSelectorAccessRight.call(this,window.__GENERATED_CONSTANTS__.AccessRight.SUBMIT_TIME_TRACK,"common.users_selector.access_right.submit_time_track")}SubmitTimeTrackRight.prototype=new UserSelectorAccessRight;function ManageScopeRight(){UserSelectorAccessRight.call(this,window.__GENERATED_CONSTANTS__.AccessRight.EDIT_HIERARCHY,"common.users_selector.access_right.manage_scope")}ManageScopeRight.prototype=new UserSelectorAccessRight;
function SubmitOtherUserTimeTrackRight(){UserSelectorAccessRight.call(this,window.__GENERATED_CONSTANTS__.AccessRight.SUBMIT_OTHER_USER_TIME_TRACK,"common.users_selector.access_right.submit_other_user_time_track")}SubmitOtherUserTimeTrackRight.prototype=new UserSelectorAccessRight;function ManageLeaveBalanceRight(){UserSelectorAccessRight.call(this,window.__GENERATED_CONSTANTS__.AccessRight.MANAGE_PTO_AND_SICK,"common.users_selector.access_right.manage_pto_and_sick")}
ManageLeaveBalanceRight.prototype=new UserSelectorAccessRight;function HierarchySelectorInitMediator(){this.rootNode=new TreeRootNode;this.searchIndex=new StringIndex;this.allActiveSet=new TreeNodeSet}HierarchySelectorInitMediator.prototype.getRootNode=function(){return this.rootNode};HierarchySelectorInitMediator.prototype.getConfig=function(){return{rootNode:this.rootNode,searchIndex:this.searchIndex,allActiveSet:this.allActiveSet}};Ext.namespace("AT");
AT.ThreePositionUserSelectorPanel=Ext.extend(AT.UsersSelectorPanel,{groupBySettingCookieName:"threePositionUserSelectorGroupBySetting",createComponents:function(){AT.ThreePositionUserSelectorPanel.superclass.createComponents.call(this);this.viewByPanel=new AT.ExtendedGroupSelectorSwitcher},buildGroupByUsersTreeData:function(){var a=new TreeRootNode,b=new StringIndex,c=new TreeNodeSet;(new UserSelectorTreeBuilder(a,this.users,null,null,new UserSelectorTreeBuilderObserver(b,c),null)).buildTree();this.groupByUsersTreeData=
{rootNode:a,searchIndex:b,allActiveSet:c}},groupByUser:function(){if(null!=this.groupType){var a=this.collectCurrentSettings();this.prepareForGroupByChange();this.changeUserSelectorGroupsStrategy(this.initHideUserGroupsStrategy());this.groupByUsersTreeData||this.buildGroupByUsersTreeData();this.setTreeData(this.groupByUsersTreeData);this.recreateTreeSetSelectorSettingsAndBuildTree(a);this.groupType=null;this.viewByPanel.updateUI(this.groupType);this.saveGroupBySettingsToCookie("groupByUsers")}},getGroupTypeFromString:function(a){return"groupByUsers"==
a?null:AT.ThreePositionUserSelectorPanel.superclass.getGroupTypeFromString.call(this,a)},regroupUsers:function(a){null==a?(this.groupType=null,this.groupByUser()):AT.ThreePositionUserSelectorPanel.superclass.regroupUsers.call(this,a)},initTreeData:function(){null==this.groupType?(this.userSelectorGroupsStrategy=this.initHideUserGroupsStrategy(),this.buildGroupByUsersTreeData(),this.setTreeData(this.groupByUsersTreeData)):AT.ThreePositionUserSelectorPanel.superclass.initTreeData.call(this)},initializeViewByPanel:function(){var a=
this;this.viewByPanel.init(this.userGroupsEnabled,this.timeZoneGroupsEnabled,function(){a.treeActionHandler($.proxy(a.groupByUser,a),!0,!1)},function(){a.treeActionHandler($.proxy(a.groupByUserGroup,a),!0,!1)},function(){a.treeActionHandler($.proxy(a.groupByTimeZoneGroup,a),!0,!1)})},createGroupsUsersMaps:function(){},addSelectorTreeChangeListener:function(){},beforeResetAction:function(){this.groupTypeInit||this.groupByUser();AT.ThreePositionUserSelectorPanel.superclass.beforeResetAction.call(this)}});function CustomerProjectSelectorEmptyMessageBuilder(a){EmptyMessageBuilder.call(this);this.isFiltered=a}
CustomerProjectSelectorEmptyMessageBuilder.prototype=_.create(EmptyMessageBuilder.prototype,{createMessages:function(){this.messages.noNodesMatchingSearch=messageResource.getEscapedMessage("projects_customers_selector.no_results_in_search");this.messages.noSelectedNodes=messageResource.getEscapedMessage("projects_customers_selector.hide_not_selected.no_users_or_groups_selected");this.messages.noSelectedNodesHasDisabled=messageResource.getEscapedMessage("projects_customers_selector.hide_not_selected.only_disabled");
this.messages.emptyTree=messageResource.getEscapedMessage(this.isFiltered?"projects_customers_selector.no_customers_and_projects_exists_filtered":"projects_customers_selector.no_customers_and_projects_exists");this.messages.noActiveNodes=messageResource.getEscapedMessage(this.isFiltered?"projects_customers_selector.no_active_customers_and_projects_exists_filtered":"projects_customers_selector.no_active_customers_and_projects_exists")}});function CustomerProjectSelectorOnlyProjectsEmptyMessageBuilder(a){CustomerProjectSelectorEmptyMessageBuilder.call(this);this.isFiltered=a}
CustomerProjectSelectorOnlyProjectsEmptyMessageBuilder.prototype=_.create(CustomerProjectSelectorEmptyMessageBuilder.prototype,{createMessages:function(){this.messages.noNodesMatchingSearch=messageResource.getEscapedMessage("projects_customers_selector.no_projects_in_search");this.messages.noSelectedNodes=messageResource.getEscapedMessage("projects_customers_selector.hide_not_selected.no_projects_selected");this.messages.noSelectedNodesHasDisabled=messageResource.getEscapedMessage("projects_customers_selector.hide_not_selected.only_disabled_projects");
this.messages.emptyTree=messageResource.getEscapedMessage(this.isFiltered?"projects_customers_selector.no_projects_exists_filtered":"projects_customers_selector.no_projects_exists");this.messages.noActiveNodes=messageResource.getEscapedMessage(this.isFiltered?"projects_customers_selector.no_active_projects_exists_filtered":"projects_customers_selector.no_active_projects_exists")}});function CodePhoneSelector(){}
CodePhoneSelector.prototype.init=function(a){this.containerId=a.containerId;this.mainSelectorClass="countryCodeSelector";this.settings={showDropdownToTop:a.showToTop,isFixedDropDown:a.isFixedDropDown,preSelection:!1,hideDropdownOnEmptyInput:!1,selectedClass:this.mainSelectorClass+"_selected",dropdownClass:this.mainSelectorClass+"_dropdown "+(a.showToTop?" toTop":" toBottom")+(a.isFixedDropDown?" fixed":"")};this.dropdownList=this.dropdown=this.input=this.select=null;this.cache=[];this.results=[];
this.picked=!1;this.valueBeforeFocus=null;this.selectedIndex=0;this.allowMouseMove=!0;this.options=a.options;this.createTextFunction=a.createTextFunction;this.createNameFunction=a.createNameFunction;this.setInputByValueFunction=a.setInputByValueFunction;this.getTokenFunction=a.getTokenFunction;this.searchIndex=new StringIndex(new StringTokenizer(StringTokenizer.PUNCTUATORS_FOR_SEARCH));this.predefinedValue=a.predefinedValue;this.reloadCache();this.renderControls();this.wire();return this};
CodePhoneSelector.prototype.reloadCache=function(){var a=this;this.cache=$.map(this.options,function(b,c){a.searchIndex.add(a.getTokenFunction(b),c);return{name:a.createNameFunction(b),value:b}})};
CodePhoneSelector.prototype.renderControls=function(){this.input=$("<input type='text' autocomplete='off' />").addClass(this.mainSelectorClass+"Input_selector").css({visibility:"visible"});this.input.on("input",function(){this.value=this.value.replace(/[^/+0-9]/g,"");this.value=this.value.replace(/(\d)\+/g,"$1");this.value=this.value.replace(/\+\+/g,"+")});this.input.on("selectstart",function(a){stopEventPropagation(a)});this.input.focus(function(){a.container.addClass("inFocus")});this.input.blur(function(){a.container.removeClass("inFocus")});
this.dropdown=$("<div></div>").addClass(this.settings.dropdownClass);this.dropdownListEl="<ul class='codePhoneSelectorDropdown'></ul>";this.dropdownList=$(this.dropdownListEl);this.dropdown.append(this.dropdownList);this.dropdown.css("max-height","200px");this.container=$("#"+this.containerId);this.container.append(this.input);new SmartField(this.input,function(a){a=String.fromCharCode(a);return"0"<=a&&"9">=a||"+"==a||"-"==a},function(){},null,!1,10);this.arrow=$("<div></div>").addClass(this.mainSelectorClass+
"Arrow_selector").css({visibility:"visible"});this.container.append(this.arrow);$("body").append(this.dropdown);this.predefinedValue&&(this.input.val(this.predefinedValue),this.initialSelect=!0);var a=this;$(window).resize(function(){a.hide()})};
CodePhoneSelector.prototype.wire=function(){var a=this;this.input.click(function(b){a.focus();b.stopPropagation()});this.input.mouseup(function(a){a.preventDefault()});this.input.focus(function(b){a.valueBeforeFocus=a.input.val();a.picked||a.filterResults();b.stopPropagation()});this.input.blur(function(){var b=a.input.val();"+"!=b[0]&&""!=b&&a.input.val("+"+b)});this.arrow.mousedown(function(b){a.container.hasClass("showAll")?a.hide():(a.input.focus(),a.hide(),a.filterResults(!0),a.container.addClass("showAll"),
b.stopPropagation())});this.dropdownList.mouseover(function(b){if(!a.allowMouseMove)a.allowMouseMove=!0;else if("LI"==b.target.tagName){var c=a.dropdown.find("li");a.markSelected(c.index($(b.target)))}});this.dropdownList.mouseleave(function(){a.markSelected(-1)});this.dropdownList.click(function(){stopEventPropagation(event);cancelBubble(event);a.pickSelected();a.focusAndHide()});this.dropdown.mouseover(function(){a.dropdownMouseover=!0});this.dropdown.mouseleave(function(){a.dropdownMouseover=!1});
$(document).on("mousedown.codePhoneSelector",function(b){b.target!=a.dropdown[0]&&b.target!=a.input[0]&&-1==$(b.target).parents().index(a.dropdown)&&a.hide()});this.input.keyup(function(b){switch(b.keyCode){case KEY_CODE_ENTER:b.preventDefault();a.pickSelected();a.focusAndHide();break;case KEY_CODE_ESC:b.preventDefault();a.reset();a.focusAndHide();break;default:a.filterResults()}a.settings.hideDropdownOnEmptyInput&&(""==a.input.val()?a.dropdownList.hide():a.dropdownList.show())});this.input.keydown(function(b){switch(b.keyCode){case KEY_CODE_TAB:a.hide();
break;case KEY_CODE_PAGE_UP:b.preventDefault();a.markFirst();break;case KEY_CODE_PAGE_DOWN:b.preventDefault();a.markLast();break;case KEY_CODE_UP:b.preventDefault();a.showed?a.moveSelected(-1):a.dropdownList.show();break;case KEY_CODE_DOWN:b.preventDefault();a.moveSelected(1);break;case KEY_CODE_ESC:if(!a.isDropDownShown())break;case 13:b.preventDefault(),b.stopPropagation()}});this.dropdown.off(ScrollUtils.getWheelEventName()).on(ScrollUtils.getWheelEventName(),function(b){a.showed&&_.bind(ScrollUtils.getWheelEventListenerForPreventScrollParents(),
this)(b)})};
CodePhoneSelector.prototype.filterResults=function(a){var b=this.input.val();if(b!=this.lastValue){this.results=[];if(""==b||"+"==b||a||this.initialSelect)$.extend(this.results,this.cache),this.initialSelect=!1,"+"==b&&this.hideEmptyError();else{this.hideEmptyError();a=this.searchIndex.search(this.searchIndex.getTokenizer().getTokens(b));for(var c in a)this.results.push(this.cache[c])}this.results.sort(function(a,b){return a.name.toLowerCase()<b.name.toLowerCase()?-1:a.name.toLowerCase()>b.name.toLowerCase()?
1:0});0<this.results.length?this.renderDropdown():this.hide();this.markFirst();this.picked=!1;this.lastValue=b}};
CodePhoneSelector.prototype.renderDropdown=function(){this.dropdown.css({width:"200px",maxHeight:""});this.dropdownList.empty();var a=this;_.each(this.results,function(b){$("<li>"+b.name+"</li>").appendTo(a.dropdownList)});this.dropdown.show();var b=this.input.offset(),c={};c.left=b.left;c.top=this.settings.showDropdownToTop?b.top-this.dropdown.outerHeight(!0):b.top+this.input.outerHeight();this.dropdown.offset(c);this.showed=!0};
CodePhoneSelector.prototype.markSelected=function(a){if(!(0>a||a>=this.results.length)){var b=this.dropdown.find("li");b.removeClass(this.settings.selectedClass);b=$(b[a]);this.selectedIndex=a;b.addClass(this.settings.selectedClass);a=b.position().top;b=a+b.outerHeight()-this.dropdown.height();0<b?(this.allowMouseMove=!1,this.dropdown.scrollTop(this.dropdown.scrollTop()+b)):0>a&&(this.allowMouseMove=!1,this.dropdown.scrollTop(Math.max(0,this.dropdown.scrollTop()+a)))}};
CodePhoneSelector.prototype.pickSelected=function(){var a=this.results[this.selectedIndex];a?(this.picked=!0,this.input.val(this.setInputByValueFunction(a.value)),this.hideEmptyError()):this.reset()};CodePhoneSelector.prototype.getValue=function(){return this.input.val()};CodePhoneSelector.prototype.hide=function(){this.dropdown.hide();this.container.removeClass("showAll");this.lastValue=null;this.showed=!1};CodePhoneSelector.prototype.isDropDownShown=function(){return this.dropdownList.is(":visible")};
CodePhoneSelector.prototype.addEmptyError=function(){this.container.addClass("emptyError")};CodePhoneSelector.prototype.hideEmptyError=function(){this.container.removeClass("emptyError")};CodePhoneSelector.prototype.moveSelected=function(a){this.markSelected(this.selectedIndex+a)};CodePhoneSelector.prototype.markFirst=function(){this.markSelected(0)};CodePhoneSelector.prototype.markLast=function(){this.markSelected(this.results.length-1)};CodePhoneSelector.prototype.reset=function(){this.input.val(this.valueBeforeFocus)};
CodePhoneSelector.prototype.focus=function(){this.input.focus()};CodePhoneSelector.prototype.focusAndHide=function(){this.focus();this.hide()};function SubmitContactBlock(){}
SubmitContactBlock.prototype.init=function(a,b,c){var d=this;this.requestPhoneCallContainer=$("#requestCallPhoneContainer"+a);if(0!=this.requestPhoneCallContainer.length){this.requestPhoneCallContainer.on("click",function(a){a.stopPropagation()});this.closePhoneButton=this.requestPhoneCallContainer.find("#closePhoneWasSendButton"+a);this.closePhoneButton.on("click",function(){d.requestPhoneCallContainer.find(".phoneWasSendBlock").hide();d.requestPhoneCallContainer.find(".phoneInputBlock").show();d.phoneInput.pVal("");
d.unHighlightBlockIfNeeded(!1)});this.tryAgainButton=this.requestPhoneCallContainer.find(".pleaseTryAgainButton");this.tryAgainButton.on("click",function(){d.requestPhoneCallContainer.find(".inputPhoneContainer").show();d.requestPhoneCallContainer.find(".errorAnswer").hide();d.unHighlightBlockIfNeeded(!0)});var e=[];$.each(countries,function(a,b){if(0<b.phoneCodes.length)for(var c=0;c<b.phoneCodes.length;++c)e.push({id:b.id,name:b.shortName?b.shortName:b.name,phoneCode:b.phoneCodes[c]})});this.phoneInput=
this.requestPhoneCallContainer.find("#phoneInput"+a);this.phoneInput.off();this.phoneInput.placeholder();this.phoneInput.focus(function(){d.highlightBlock()});this.phoneInput.blur(function(){$(this).pVal(trim(this.value));d.unHighlightBlockIfNeeded(!1);d.phoneInput.removeClass("empty")});this.phoneInput.on("change",function(){d.phoneInput.removeClass("empty")});this.phoneInput.on("selectstart",function(a){stopEventPropagation(a)});new SmartField(this.phoneInput,function(a){a=String.fromCharCode(a);
return"0"<=a&&"9">=a},function(){});this.phoneInput.on("input",function(){isNumber(this.value)||(this.value=this.value.replace(/[^/0-9]/g,""));""!=this.value&&d.phoneInput.removeClass("empty")});this.countryCodeSelector=(new CodePhoneSelector).init({containerId:"countryCodePlaceholder"+a,options:e,createNameFunction:function(a){return a.name+" (+"+a.phoneCode+")"},setInputByValueFunction:function(a){return"+"+a.phoneCode},getTokenFunction:function(a){return""+a.phoneCode},predefinedValue:"+1",showToTop:b,
isFixedDropDown:c||!1});this.sendButton=this.requestPhoneCallContainer.find("#sendPhoneButton"+a);this.sendButton.on("click",function(){var a=d.phoneInput.pVal(),b=!1;0==a.length&&(d.phoneInput.addClass("empty"),b=!0);var c=d.countryCodeSelector.getValue();""==trim(c)&&(d.countryCodeSelector.addEmptyError("empty"),b=!0);b||d.sendPhoneCall(c+"-"+a)})}};SubmitContactBlock.prototype.getPhoneNumber=function(){return trim(this.phoneInput.pVal())};SubmitContactBlock.prototype.onBlockHighlightChanged=function(a){};
SubmitContactBlock.prototype.highlightBlock=function(){this.requestPhoneCallContainer.toggleClass("submitContact",!0);this.onBlockHighlightChanged(!0)};SubmitContactBlock.prototype.unHighlightBlockIfNeeded=function(a){if(a||""==this.getPhoneNumber())this.requestPhoneCallContainer.removeClass("submitContact"),this.onBlockHighlightChanged(!1)};
SubmitContactBlock.prototype.sendPhoneCall=function(a){var b=this;this.requestPhoneCallContainer.find(".phoneInputBlock").hide();this.requestPhoneCallContainer.find(".phoneSendBlock").show();makeRpcCall("ContactSupportService.sendPhoneNumber",[a],function(){b.requestPhoneCallContainer.find(".phoneSendBlock").hide();b.requestPhoneCallContainer.find(".phoneWasSendBlock").show()},function(a,d,e){if("timeout"==d||e.exception&&-1!=e.exception.indexOf("com.actimind.common.util.PWSCommunicationException"))return b.requestPhoneCallContainer.find(".inputPhoneContainer").hide(),
b.requestPhoneCallContainer.find(".phoneInputBlock").show(),b.requestPhoneCallContainer.find(".phoneSendBlock").hide(),b.requestPhoneCallContainer.find(".errorAnswer").show(),!0;b.requestPhoneCallContainer.find(".phoneInputBlock").show();b.requestPhoneCallContainer.find(".phoneSendBlock").hide()})};SubmitContactBlock.prototype.hide=function(){return this.countryCodeSelector.isDropDownShown()?(this.countryCodeSelector.hide(),!0):!1};function RemoveDemoDataBlock(){}
RemoveDemoDataBlock.prototype.init=function(a){var b=this;this.demoContainer=$(a);if(0!=this.demoContainer.length)return this.demoContainer.on("click",function(a){a.stopPropagation()}),this.cleanDemoButton=this.demoContainer.find("#cleanDemoDataButton"),this.cancelDemoButton=this.demoContainer.find("#cancelDemoDataClenup"),this.proceedCleanupDemoDataButton=this.demoContainer.find("#proceedCleanDemoDataButton"),this.firstDemoContainerStep=!0,this.proceedCleanupDemoDataButton.on("click",function(a){a.stopPropagation();
TransformedScreenMoire.showAndTransformTo("removeDemoDataMoire",.9,"1s","ease-out",null,b.showPacmanAndRemoveDemoData)}),this.cleanDemoButton.on("click",function(a){a.stopPropagation();b.firstDemoContainerStep&&(b.demoContainer.parent().addClass("demoDataContainer_secondPart"),b.demoContainer.addClass("secondPart"),b.firstDemoContainerStep=!1)}),this.cancelDemoButton.on("click",function(a){a.stopPropagation();b.firstDemoContainerStep||(b.demoContainer.parent().removeClass("demoDataContainer_secondPart"),
b.demoContainer.removeClass("secondPart"),b.firstDemoContainerStep=!0)}),this};
RemoveDemoDataBlock.prototype.showPacmanAndRemoveDemoData=function(){var a=$("<div id='pacman' class='pacman'></div>");a.appendTo("body");a.css("top",$(window).outerHeight()/2);makeRpcCall("DemoDataService.removeDemoData",[],function(b){a.addClass("not-eat");a.css("top",a.position().top-100);a.atAnimation().oneTransitionEnd(function(){a.removeClass("not-eat");a.addClass("smile");a.append("<span class='demoDataRemovedText'>"+messageResource.getMessage("menu.support.demo_data_removed")+"</span>");a.append("<span class='productReadyText'>"+
messageResource.getMessage("menu.support.product_ready")+"</span>");setTimeout(function(){document.location.href=BASE_PATH+b.afterRemoveURL},2E3)})},function(a,c,d){return"com.actimind.common.licensing.LicenseViolatedException"==d.msg?(alert(messageResource.getMessage("common.license_violated_exception.action_is_not_available")),$("#pacman").hide(),TransformedScreenMoire.hide("1s","ease-out","transformedMoireId",function(){}),!0):"com.actimind.common.licensing.NoActiveLicensesException"==d.msg?(alert(messageResource.getMessage("common.license_expired_exception")),
$("#pacman").hide(),TransformedScreenMoire.hide("1s","ease-out","transformedMoireId",function(){}),!0):!1})};function HelpAndSupportPopup(){}
HelpAndSupportPopup.prototype.init=function(a){this.containerId=a.containerId;this.innerPopupMenu=$.extend({},PopupMenu);var b=this;this.innerPopupMenu.handleEsc=function(a){b.submitContactBlock.hide()||PopupMenu.handleEsc.call(this,a)};this.initRemoveDemoDataBlock();this.initInviteColleaguesBlock();this.initPhoneContainer();this.demoContainer=$("#demoDataContainer");a=$("#"+this.containerId);var c=$(".popup_menu_support");0!=this.demoContainer.length?(a.find(".popup_menu_title").html(messageResource.getMessage("menu.support.item.help_and_suuport")),c.addClass("demoDataContainerIsTop")):
c.addClass("inviteUserFromHelpPopupIsTop");this.innerPopupMenu.__stopHideAnimation=function(a){a.stopTransition()};this.innerPopupMenu.animationHide=function(a,b){var c=a.height(),g=600<c?(c-600)/3600+.2:.2;a.css("height",c);a.css(AtAnimation.getVendorPrefixedCssName("transition"),"height "+g+"s ease-out");a.css("height");a.css("height",0);a.atAnimation().oneTransitionEnd(function(){b();a.hide();a.css("height","");a.css("transition","")})};return this};
HelpAndSupportPopup.prototype.initInviteColleaguesBlock=function(){(new InviteColleaguesBlock).init({containerId:this.containerId})};HelpAndSupportPopup.prototype.initPhoneContainer=function(){this.submitContactBlock=new SubmitContactBlock;this.submitContactBlock.init("_support",!0)};HelpAndSupportPopup.prototype.initRemoveDemoDataBlock=function(){(new RemoveDemoDataBlock).init("#demoDataContainer")};HelpAndSupportPopup.prototype.show=function(a,b){this.innerPopupMenu.show(a,b)};function openReportBugPopup(a){var b=SupportMenuConstants.reportBugURL;a&&(b+="?text="+encodeURIComponent(a));loadPopupContent(b,function(){(new SupportPopup).init().show()},!0)}function sendExceptionReport(){loadPopupContent(SupportMenuConstants.reportBugURL+"?exc=",function(){(new SupportPopup).init().show()},!0)}
function openUserGuidePage(a){var b=void 0;isMSIE()&&(b="scrollbars=yes, resizable=yes");a.match(/\.html$/)||isOlVersion||isDemoVersion||(a+=".html");windowOpen(USER_GUIDE_URL+a,"_blank",b)}function createOpenAboutPopupHandler(){var a=void 0;return function(){_.isUndefined(a)&&(a=(new AboutPopup("aboutPopup")).init());a.show()}}
var MenuHandler={openAbout:createOpenAboutPopupHandler(),contactSupport:function(){openReportBugPopup()},reportABug:function(){MenuHandler.contactSupport()},openFaq:function(){windowOpen(SupportMenuConstants.faqURL,"faqWnd","directories=no,height=705, width=922, location=no, menubar=no, resizable=yes, scrollbars=no, status=yes, titlebar=yes, toolbar=no")},sendAQuestionToVendor:function(){MenuHandler.contactSupport()},openUserGuide:function(){openUserGuidePage("index.html")},openUserGuidePage:function(a){openUserGuidePage(a)},
openIntroVideo:function(a){TransformedScreenMoire.showAndTransformTo("supportMenuVideoMoire noprint",.95,"0.5s","ease-in-out");var b=$("#introVideoBoxId");0==b.length?b=$("<div></div>").attr("id","introVideoBoxId").addClass("noprint").appendTo("body"):b.empty();$("<div class='introVideoHeader'>"+messageResource.getMessage("menu.support.item.video_intro.header")+"</div>").appendTo(b);$("<div class='introVideoPlaceholder'></div>").append("<div id='introVideoPlaceholderId'></div>").appendTo(b);var c=
function(){d.hide();TransformedScreenMoire.hide("0.5s","ease-in-out");e&&e.stopVideo()};$("<div class='closeIntroVideoBtn'><span>"+messageResource.getMessage("menu.support.item.video_intro.close")+"</span></div>").on("click",c).appendTo(b);var d=new DHTMLPopupWithMoire("introVideoBoxId");d.hideOnMouseDown=function(){return!1};d.hideOnEscape=function(){return!1};d.hideOnResize=function(){return!1};d.onEscape=c;d.show();$(d.getMoireDiv()).hide();var e;YouTubeVideoPlayerHelper.showYTPlayer("introVideoPlaceholderId",
a,function(a){e=a})}},PopupMenu={hide_all:function(a,b){var c=$(".popup_menu_body");a&&(c=c.not(a));var d=this;c.each(function(){d.stopAnimation(this)});c.hide();c=$(".popup_menu_button_pressed");b&&(c=c.not(b));c.removeClass("popup_menu_button_pressed");$(document).off("click.popup_menu");$(document.body).off("keydown.popup_menu")},show:function(a,b){stopEventPropagation(a);var c=b.siblings(".popup_menu_button");this.hide_all(b,c);c.toggleClass("popup_menu_button_pressed");this.stopAnimation(b[0]);
b.is(":hidden")?this.animationShow(b,this.initShowAnimationCallback(b)):this.animationHide(b,this.initHideAnimationCallback(b));var d=this;$(document).on("click.popup_menu",function(){d.hide_all()});$(document.body).on("keydown.popup_menu",function(a){handleEscape(function(){d.handleEsc(a)},a)})},handleEsc:function(a){stopEventPropagation(a);this.hide_all()},animationShow:function(a,b){a.atAnimation().showAnimated("popup_menu_slide_down",b)},animationHide:function(a,b){a.atAnimation().hideAnimated("popup_menu_slide_up",
b)},stopAnimation:function(a){this.stopShowAnimation(a);this.stopHideAnimation(a)},stopShowAnimation:function(a){a.animShowInProgress&&this.__stopShowAnimation($(a).atAnimation())},__stopShowAnimation:function(a){a.stopAnimation()},stopHideAnimation:function(a){a.animHideInProgress&&this.__stopHideAnimation($(a).atAnimation())},__stopHideAnimation:function(a){a.stopAnimation()},initShowAnimationCallback:function(a){a[0].animShowInProgress=!0;return function(){a[0].animShowInProgress=!1}},initHideAnimationCallback:function(a){a[0].animHideInProgress=
!0;return function(){a[0].animHideInProgress=!1}}};function openApIntegrationPopup(){openIntegrationPopup(function(){return new APIntegrationPopup})}function openAtIntegrationPopup(){openIntegrationPopup(function(){return new IntegrationPopup})}function openDisablePopup(a,b){(new DisablePopup).init(a,b).show()}
function openIntegrationPopup(a){loadPopupContent(SupportMenuConstants.integrationPopupURL,function(){showIntegrationPopup(a)},!0,function(a){if(a==AJAX_USER_ACTION_ERROR_CODES.NO_ACTIVE_LICENSE)return alert(messageResource.getMessage("common.license_expired_exception")),!0;if(a==AJAX_USER_ACTION_ERROR_CODES.LICENSE_VIOLATION)return alert(messageResource.getMessage("common.license_violated_exception.action_is_not_available")),!0})}
function openHelpAndSupportMenu(a){_.isUndefined(window.helpAndSupportMenu)&&(window.helpAndSupportMenu=(new HelpAndSupportPopup).init({containerId:"popup_menu_support"}));a=a||window.event;helpAndSupportMenu.show(a,$("#popup_menu_support"))};function InviteColleaguesBlock(){}InviteColleaguesBlock.FIRST_NAME_EMPTY="firstNameEmpty";InviteColleaguesBlock.LAST_NAME_EMPTY="lastNameEmpty";InviteColleaguesBlock.EMAIL_EMPTY="emailEmpty";InviteColleaguesBlock.EMAIL_INVALID="emailInvalid";InviteColleaguesBlock.USER_DISABLED_BEACAUSE_LICENSE="userIsDisabledBecauseLicense";
InviteColleaguesBlock.prototype.init=function(a){this.containerId=a.containerId;this.containerDiv=$("#inviteUserFromHelpPopup");if(0!=this.containerDiv.length)return this.errors={},this.states={beginnerState:"beginnerState",fillUserFieldsState:"fillUserFieldsState",sendInvitationState:"sendInvitationState",invitationWasSendState:"invitationWasSendState"},this.curState=this.states.beginnerState,this.initInviteUsersContainer(),this.changeState(this.curState),this};
InviteColleaguesBlock.prototype.changeState=function(a){this.containerDiv.removeClass(this.curState);this.containerDiv.parent().removeClass("inviteUserFromHelpPopup_"+this.curState);this.curState=a;this.containerDiv.addClass(this.curState);this.containerDiv.parent().addClass("inviteUserFromHelpPopup_"+this.curState)};
InviteColleaguesBlock.prototype.initInviteUsersContainer=function(){var a=this;this.containerDiv.on("click",function(a){a.stopPropagation()});this.beforeInviteDiv=this.containerDiv.find(".scrollInviteContainer");this.createAccountForColleagueButton=this.containerDiv.find(a.getFullIdElement("createAccountColleague"));this.cancelInviteColleagueButton=this.containerDiv.find(a.getFullIdElement("cancelInvitationButton"));this.sendInvitationButton=this.containerDiv.find(a.getFullIdElement("sendInvitationButton"));
this.firstNameField=this.containerDiv.find(a.getFullIdElement("firstNameInviteMenu"));this.lastNameField=this.containerDiv.find(a.getFullIdElement("lastNameInviteMenu"));this.emailField=this.containerDiv.find(a.getFullIdElement("emailInviteMenu"));this.firstNameField.off();this.lastNameField.off();this.emailField.off();this.firstNameField.placeholder();this.lastNameField.placeholder();this.emailField.placeholder();this.firstNameField.on("selectstart",function(a){stopEventPropagation(a)});this.lastNameField.on("selectstart",
function(a){stopEventPropagation(a)});this.emailField.on("selectstart",function(a){stopEventPropagation(a)});this.onBlurFieldHandler=function(){return function(){$(this).pVal(trim(this.value))}};this.firstNameField.blur(this.onBlurFieldHandler());this.lastNameField.blur(this.onBlurFieldHandler());this.emailField.blur(this.onBlurFieldHandler());this.inviteAnotherPersonBtn=this.containerDiv.find(a.getFullIdElement("inviteAnotherPersonButton"));this.inviteAnotherPersonBtn.on("click",function(){a.clearInvitationFields();
a.changeState(a.states.fillUserFieldsState)});this.closeInviteBtn=this.containerDiv.find(a.getFullIdElement("closeInviteButton"));this.closeInviteBtn.on("click",function(){a.clearInvitationFields();a.changeState(a.states.beginnerState);a.beforeInviteDiv.css("transform","translate(0px, 0px)")});this.errorTooltip=(new TableTooltip).init(this.containerId+"_inviteColleaguesErrorTooltip");this.errorTooltipPlaceholderText=this.getElementById("inviteColleaguesErrorTooltipTextPlaceholder");this.initTooltipError(this.firstNameField,
InviteColleaguesBlock.FIRST_NAME_EMPTY,"menu.support.item.invite_colleague.firstName_empty");this.initTooltipError(this.lastNameField,InviteColleaguesBlock.LAST_NAME_EMPTY,"menu.support.item.invite_colleague.lastName_empty");this.initTooltipError(this.emailField,InviteColleaguesBlock.EMAIL_EMPTY,"menu.support.item.invite_colleague.email_empty");this.initTooltipError(this.emailField,InviteColleaguesBlock.EMAIL_INVALID,"menu.support.item.invite_colleague.email_invalid");this.firstNameField.change(function(){a.hideError(InviteColleaguesBlock.FIRST_NAME_EMPTY)});
this.lastNameField.change(function(){a.hideError(InviteColleaguesBlock.LAST_NAME_EMPTY)});this.emailField.change(function(){a.hideError(InviteColleaguesBlock.EMAIL_EMPTY);a.hideError(InviteColleaguesBlock.EMAIL_INVALID)});this.createAccountForColleagueButton.on("click",function(){a.curState==a.states.beginnerState&&(a.changeState(a.states.fillUserFieldsState),a.beforeInviteDiv.css("transform","translate(0px, -115px)"))});this.cancelInviteColleagueButton.on("click",function(){a.curState==a.states.fillUserFieldsState&&
(a.changeState(a.states.beginnerState),a.beforeInviteDiv.css("transform","translate(0px, 0px)"))});this.sendInvitationButton.on("click",function(){var b=!1,c=a.firstNameField.pVal();""==c&&(a.addError(InviteColleaguesBlock.FIRST_NAME_EMPTY),b=!0);var d=a.lastNameField.pVal();""==d&&(a.addError(InviteColleaguesBlock.LAST_NAME_EMPTY),b=!0);var e=a.emailField.pVal();""==e?a.addError(InviteColleaguesBlock.EMAIL_EMPTY):(isEmailValid(e)||(a.addError(InviteColleaguesBlock.EMAIL_INVALID),b=!0),b||(a.changeState(a.states.sendInvitationState),
a.sendInvitation(c,d,e)))})};InviteColleaguesBlock.prototype.clearInvitationFields=function(){this.firstNameField.pVal("");this.lastNameField.pVal("");this.emailField.pVal("")};
InviteColleaguesBlock.prototype.sendInvitation=function(a,b,c){var d=this;this.hideError(InviteColleaguesBlock.USER_DISABLED_BEACAUSE_LICENSE);makeRpcCall("UserManagementService.sendInvitation",[{firstName:a,lastName:b,email:c}],function(c){d.containerDiv.find(d.getFullIdElement("invitedText")).html("<span class='firstName'>"+a+"</span> <span class='lastName'>"+b+"</span><span> "+messageResource.getMessage("menu.support.item.invite_colleague.invitedText.text")+"</span>");c.codeResult==InviteColleaguesResult.WARNING_ACCOUNT_DISABLED_DUE_TO_LICENSE_TERMS&&
(d.addError(InviteColleaguesBlock.USER_DISABLED_BEACAUSE_LICENSE),d.containerDiv.find(d.getFullIdElement("errorInviteText")).html(messageResource.getMessage("menu.support.user_disabled.license_maximum")));d.changeState(d.states.invitationWasSendState)},function(a,b,c){if(c.exception){if(c.exception&&-1!=c.exception.indexOf("com.actimind.common.services.UserEmailInvalidException"))return d.changeState(d.states.fillUserFieldsState),d.addError(InviteColleaguesBlock.EMAIL_INVALID),!0;if(c.exception&&
"com.actimind.actitime.services.NoRightsToManageAccountSettings"==c.exception)return alert(messageResource.getMessage("menu.support.not_rights_invite_account")),document.location.reload(),!0;if(-1!=c.msg.indexOf("com.actimind.common.licensing.NoActiveLicensesException"))return alert(messageResource.getMessage("common.license_expired_exception")),d.changeState(d.states.fillUserFieldsState),!0}d.changeState(d.states.fillUserFieldsState)})};
InviteColleaguesBlock.prototype.initTooltipError=function(a,b,c){var d=this;a.hover(function(a){d.errors[b]&&(d.errorTooltipPlaceholderText.html(messageResource.getMessage(c)),d.errorTooltip.updateUIAndShow({},calculateTooltipOffset(d.errorTooltip,a)),d.errorTooltip.show())},function(){d.errorTooltip.hide()});a.mousemove(function(a){d.errorTooltip.move(calculateTooltipOffset(d.errorTooltip,a))})};InviteColleaguesBlock.prototype.addError=function(a){this.errors[a]=!0;this.containerDiv.addClass(a)};
InviteColleaguesBlock.prototype.hideError=function(a){this.errors[a]&&(this.errors[a]=!1,this.containerDiv.removeClass(a))};InviteColleaguesBlock.prototype.getElementById=function(a){return $(this.getFullIdElement(a))};InviteColleaguesBlock.prototype.getFullIdElement=function(a){return"#"+this.containerId+"_"+a};function GraphicButton(a){this.button=a;this.hoverClassName="hoveredGraphicButton";this.activeClassName="activeGraphicButton"}GraphicButton.prototype.hover=function(){addClass(this.button.el.dom,this.hoverClassName)};GraphicButton.prototype.unhover=function(){removeClass(this.button.el.dom,this.hoverClassName)};GraphicButton.prototype.activate=function(){addClass(this.button.el.dom,this.activeClassName)};GraphicButton.prototype.deactivate=function(){removeClass(this.button.el.dom,this.activeClassName)};
GraphicButton.prototype.reset=function(){this.unhover();this.deactivate()};GraphicButton.prototype.defineStandardEventHandlers=function(a,b,c,d){if(a)this.button.el.on("mouseover",this.hover,this);if(b)this.button.el.on("mouseout",this.reset,this);if(c)this.button.el.on("mousedown",this.activate,this);if(d)this.button.el.on("mouseup",this.deactivate,this)};
GraphicButton.getRoundedBox=function(a,b,c){return new AT.RoundedBox({cls:"graphicButton button "+(_.isUndefined(c)?"":c),renderTo:a,items:[{xtype:"box",autoEl:{tag:"div",html:"<span unselectable='on'>"+b+"</span>"}}]})};var YouTubeVideoPlayerHelper={loadPlayerApiTimeout:1E4,showYTPlayer:function(a,b,c,d,e){this.onErrorShowPlayerCb=d||function(){};this.onPlayerReadyCb=c||function(){};this.videoId=b;this.$loadPlayerProgressContainer=$("<div class='loadVideoPlayerProgressContainer'></div>").css("width",640).css("height",360).appendTo($("#"+a).parent());this._showProgress();var f=this;window.onYouTubeIframeAPIReady=function(){f.playerApiIsLoaded=!0;if(!f.apiLoadingTimeoutError){f.loadingAPITimer&&clearTimeout(f.loadingAPITimer);
var b={rel:0,controls:2,showinfo:0};$.extend(b,e);var c=new YT.Player(a,{videoId:f.videoId,width:640,height:360,playerVars:b,events:{onReady:function(){f._onPlayerReady(c)},onError:function(a){console.error("Can not load video.Error code: "+a.data);f._onErrorAction()}}});isIE8()&&setTimeout(function(){f._onPlayerReady(c)},1E3)}};this._loadPlayerApi()},_loadPlayerApi:function(){if(this.playerApiIsLoaded)onYouTubeIframeAPIReady();else{var a=document.createElement("script");a.src="https://www.youtube.com/iframe_api";
var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b);this.apiLoadingTimeoutError=!1;var c=this;this.loadingAPITimer=setTimeout(function(){c.apiLoadingTimeoutError=!0;console.error("Cannot load player api");c._onErrorAction()},this.loadPlayerApiTimeout)}},_showProgress:function(){this.spinner=new Spinner({lines:12,length:8,width:5,radius:14,corners:1,rotate:0,direction:1,color:"#ffffff",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2E9,top:"auto",left:"auto"});
this.spinner.spin();this.$loadPlayerProgressContainer.append(this.spinner.el).append("<div class='videoLoading videoPlayerProgressText'>"+messageResource.getMessage("video_loading_progress.loading")+"</div>")},_onPlayerReady:function(a){this.onPlayerReadyCb(a);this.spinner.stop();this.$loadPlayerProgressContainer.hide()},_onErrorAction:function(){this.onErrorShowPlayerCb();var a="https://youtu.be/"+this.videoId;this.$loadPlayerProgressContainer.empty().append("<div class='errorHeaderText videoPlayerProgressText'>"+
messageResource.getMessage("video_loading_progress.error_loading.header")+"</div>").append("<div class='errorHintText videoPlayerProgressText'>"+messageResource.getMessage("video_loading_progress.error_loading.hint")+"</div>").append("<div class='errorLink videoPlayerProgressText'><a href='"+a+"' target='_blank'>"+a+"</a></div>")}};function LeaveTypeListTableRow(){this.constructor=LeaveTypeListTableRow}LeaveTypeListTableRow.prototype=_.create(TableRow.prototype);LeaveTypeListTableRow.prototype.init=function(a){var b=this;TableRow.call(this);$(this.getRowEl()).hover(function(){b.getTable().isDisabledHover()||b.hover()},function(){b.unhover()});$(this.getRowEl()).mousemove(function(){b.getTable().isDisabledHover()||(b.hover(),$(b.getRowEl()).off("mousemove"))});this.leaveTypeInfo=a;return this};
LeaveTypeListTableRow.prototype.getLeaveTypeInfo=function(){return this.leaveTypeInfo};LeaveTypeListTableRow.prototype.writeCellsContent=function(){for(var a=this.getCells(),b=0;b<a.length;b++)a[b].writeContent()};LeaveTypeListTableRow.prototype.markMovedRow=function(){$(this.getRowEl()).addClass("moved")};LeaveTypeListTableRow.prototype.unMarkMovedRow=function(){$(this.getRowEl()).removeClass("moved")};LeaveTypeListTableRow.prototype.highlight=function(){this.addClass("highlighted")};
LeaveTypeListTableRow.prototype.unhighlight=function(){this.removeClass("highlighted")};LeaveTypeListTableRow.prototype.hover=function(){this.addClass("hover")};LeaveTypeListTableRow.prototype.unhover=function(){this.removeClass("hover")};LeaveTypeListTableRow.prototype.addOpenPopupClass=function(){this.addClass("openPopup")};LeaveTypeListTableRow.prototype.removeOpenPopupClass=function(){this.removeClass("openPopup")};LeaveTypeListTableRow.prototype.addClass=function(a){$(this.getRowEl()).addClass(a)};
LeaveTypeListTableRow.prototype.removeClass=function(a){$(this.getRowEl()).removeClass(a)};LeaveTypeListTableRow.prototype.addCellObj=function(a){TableRow.prototype.addCellObj.call(this,a);$(a.getCellEl()).hover(function(){$(a.getCellEl()).addClass("active")},function(){$(a.getCellEl()).removeClass("active")})};function LeaveTypeListRowRenderer(){this.constructor=LeaveTypeListRowRenderer}LeaveTypeListRowRenderer.prototype.init=function(){return this};LeaveTypeListRowRenderer.prototype.getRowClasses=function(a){var b=["leaveTypeListRow"];a.active||b.push("archived");a.inUse&&b.push("inUse");return b};function LeaveTypeNameCellRenderer(){this.constructor=LeaveTypeNameCellRenderer}LeaveTypeNameCellRenderer.prototype=_.create(TableCellRenderer.prototype);LeaveTypeNameCellRenderer.prototype.init=function(a){TableCellRenderer.call(this);this.onEditLeaveTypeNameCallback=a;return this};LeaveTypeNameCellRenderer.prototype.getCellClassName=function(a){return["leaveTypeNameCell"]};
LeaveTypeNameCellRenderer.prototype.generateContent=function(a){var b=this,c=document.createElement("table"),d=document.createElement("tr"),e=document.createElement("td"),f=document.createElement("td");f.className="leaveNameOnHoverElement";var g=document.createElement("div");g.className="leaveTypeNameText";var h=document.createElement("span");h.className="leaveTypeNameText";$(h).text(a.getValue().name);e.appendChild(g);d.appendChild(e);d.appendChild(f);c.appendChild(d);a.getCellEl().onclick=function(){var c=
a.getTable();c.leaveNamePopup||(c.leaveNamePopup=(new LeaveNamePopup).init("LeaveNamePopup",b.onEditLeaveTypeNameCallback));c.leaveNamePopup.setValue(a.value);c.leaveNamePopup.show($(a.getCellEl()),{my:"left top",at:"left top",offset:"1px -1px"},function(){a.getRow().addOpenPopupClass()},function(){a.getRow().removeOpenPopupClass()})};g.appendChild(h);a.getCellEl().appendChild(c)};function LeaveTypeImageCellRenderer(){this.constructor=LeaveTypeImageCellRenderer}LeaveTypeImageCellRenderer.prototype=_.create(TableCellRenderer.prototype);LeaveTypeImageCellRenderer.prototype.init=function(a,b){TableCellRenderer.call(this);this.iconSelectorPanel=b;this.onSetLeaveTypeIconCallback=a;return this};LeaveTypeImageCellRenderer.prototype.getCellClassName=function(a){return["leaveTypeImageCell"]};
LeaveTypeImageCellRenderer.prototype.generateContent=function(a){this.iconSelector=(new ExtendedLeaveTypeIconSelector).init(this.iconSelectorPanel,a.value.id,this.onSetLeaveTypeIconCallback);a.getCellEl().appendChild(this.iconSelector.getSelectorEl());this.iconSelector.setIcon(a.value.iconId);a.getCellEl().onclick=function(){a.getRow().addOpenPopupClass();$(a.getCellEl()).addClass("iconSelectorOpened")}};function LeaveTypeAffectedBalanceCellRenderer(){this.constructor=LeaveTypeAffectedBalanceCellRenderer}LeaveTypeAffectedBalanceCellRenderer.prototype=_.create(TableCellRenderer.prototype);LeaveTypeAffectedBalanceCellRenderer.prototype.init=function(a,b,c,d,e){TableCellRenderer.call(this);this.onEditCallback=a;this.coefficientsFormatter=c;this.numberSettings=b;this.isPtoEnabled=d;this.isSickEnabled=e;return this};LeaveTypeAffectedBalanceCellRenderer.prototype.getCellClassName=function(a){return["leaveTypeAffectedBalanceCell"]};
LeaveTypeAffectedBalanceCellRenderer.prototype.generateContent=function(a){var b=this;this.isPtoEnabled&&a.getValue().balanceType==BalanceType.PTO?this._appendPtoInfoToCell(a):this.isSickEnabled&&a.getValue().balanceType==BalanceType.SICK?this._appendTextToCell(a,messageResource.getMessage("leave_type.list.sick_days_balance")):this._appendTextToCell(a,"\u2013");a.getCellEl().onclick=function(){var c=a.getTable();if(!c.affectedBalancePopup){var d=$("#AffectedBalancePopup");c.affectedBalancePopup=(new AffectedBalancePopup).init(d,
b.onEditCallback,b._createAndInitBalancesEditPanelController(d))}c.affectedBalancePopup.setValue(a.value);c.affectedBalancePopup.show($(a.getCellEl()),function(){a.getRow().addOpenPopupClass();$(a.getCellEl()).addClass("affectedBalancePopupOpened")},function(){a.getRow().removeOpenPopupClass();$(a.getCellEl()).removeClass("affectedBalancePopupOpened")})}};LeaveTypeAffectedBalanceCellRenderer.prototype._appendTextToCell=function(a,b){var c=$("<span>");c.addClass("leaveTypeInfoText");c.text(b);a.getCellEl().appendChild(c[0])};
LeaveTypeAffectedBalanceCellRenderer.prototype._appendTdWithTextToTr=function(a,b,c){var d=$("<td>");c&&d.addClass(c);d.append($("<span>").text(a));d.appendTo(b)};
LeaveTypeAffectedBalanceCellRenderer.prototype._appendPtoInfoToCell=function(a){var b=$("<table>");b.addClass("leaveTypeInfoText");var c=$("<tr>");b.append(c);this._appendTdWithTextToTr(messageResource.getMessage("leave_type.list.is_pto"),c);this._appendTdWithTextToTr(messageResource.getMessage("leave_type.list.coeff")+" "+this.coefficientsFormatter.format(a.getValue().balanceCoefficient),c,"coefficientTd");a.getCellEl().appendChild(b[0])};
LeaveTypeAffectedBalanceCellRenderer.prototype._createAndInitBalancesEditPanelController=function(a){var b=NoBalancesEditPanelController;this.isPtoEnabled&&this.isSickEnabled?b=LeaveTypeBalancesEditPanelController:this.isPtoEnabled?b=PtoBalanceEditPanelController:this.isSickEnabled&&(b=SickDaysBalanceEditPanelController);return(new b).init({container:a,numberSettings:this.numberSettings,elementSuffix:"affectedBalancePopup"})};function LeaveTypeRequiresApprovalCellRenderer(){this.constructor=LeaveTypeRequiresApprovalCellRenderer}LeaveTypeRequiresApprovalCellRenderer.prototype=_.create(TableCellRenderer.prototype);LeaveTypeRequiresApprovalCellRenderer.prototype.init=function(a){TableCellRenderer.call(this);this.changeRequiresApprovalCallback=a;return this};LeaveTypeRequiresApprovalCellRenderer.prototype.getCellClassName=function(a){return["leaveTypeRequiresApprovalCell"]};
LeaveTypeRequiresApprovalCellRenderer.prototype.generateContent=function(a){var b=this,c=a.getValue(),d=document.createElement("span");d.className="leaveTypeInfoText";$(d).text(c.requiresApproval?messageResource.getMessage("leave_type.list.require_approval"):"\u2013");a.getCellEl().onclick=function(){b.changeRequiresApprovalCallback(c.id,c.requiresApproval)};a.getCellEl().appendChild(d)};function LeaveTypeChangeOrderCellRenderer(){this.constructor=LeaveTypeChangeOrderCellRenderer}LeaveTypeChangeOrderCellRenderer.prototype=_.create(TableCellRenderer.prototype);LeaveTypeChangeOrderCellRenderer.prototype.init=function(a,b){TableCellRenderer.call(this);this.arrowImagesPaths=a;this.onMoveLeaveTypeCallback=b;return this};LeaveTypeChangeOrderCellRenderer.prototype.getCellClassName=function(a){return["leaveTypeChangeOrderCell"]};
LeaveTypeChangeOrderCellRenderer.prototype.generateContent=function(a){var b=document.createElement("div");b.className="moveTypesTable";var c=this,d=document.createElement("div");d.className="orderNumber";d.innerHTML=a.getValue().position;a.getCellEl().appendChild(d);d=document.createElement("div");d.className="upArrow";var e=document.createElement("img");e.src=this.arrowImagesPaths.upArrowImagePath;d.onclick=function(){var b=a.getRow();if(b=b.getTable().getRow(b.getRowIdx()-1))c.onMoveLeaveTypeCallback(a.value.id,
b.getLeaveTypeInfo().id)};d.onmouseover=function(){e.src=c.arrowImagesPaths.upArrowHoverImagePath};d.onmouseout=function(){e.src=c.arrowImagesPaths.upArrowImagePath};d.appendChild(e);b.appendChild(d);d=document.createElement("div");d.className="downArrow";var f=document.createElement("img");f.src=this.arrowImagesPaths.downArrowImagePath;d.onclick=function(){var b=a.getRow();if(b=b.getTable().getRow(b.getRowIdx()+1))c.onMoveLeaveTypeCallback(a.value.id,b.getLeaveTypeInfo().id)};d.onmouseover=function(){f.src=
c.arrowImagesPaths.downArrowHoverImagePath};d.onmouseout=function(){f.src=c.arrowImagesPaths.downArrowImagePath};d.appendChild(f);b.appendChild(d);a.getCellEl().appendChild(b)};function LeaveTypeStatusCellRenderer(){this.constructor=LeaveTypeStatusCellRenderer}LeaveTypeStatusCellRenderer.prototype=_.create(TableCellRenderer.prototype);LeaveTypeStatusCellRenderer.prototype.init=function(a){TableCellRenderer.call(this);this.changeStatusCallback=a;return this};LeaveTypeStatusCellRenderer.prototype.getCellClassName=function(a){return["leaveTypeStatusCell"]};
LeaveTypeStatusCellRenderer.prototype.generateContent=function(a){var b=this,c=a.getValue(),d=document.createElement("span");d.className="leaveTypeStatusSpan leaveTypeInfoText";$(d).text(c.active?messageResource.getMessage("leave_type.active"):messageResource.getMessage("leave_type.archived"));a.getCellEl().onclick=function(){b.changeStatusCallback(c.id,c.active)};a.getCellEl().appendChild(d)};function LeaveTypeDeleteCellRenderer(){this.constructor=LeaveTypeDeleteCellRenderer}LeaveTypeDeleteCellRenderer.prototype=_.create(TableCellRenderer.prototype);LeaveTypeDeleteCellRenderer.prototype.init=function(a,b,c,d){TableCellRenderer.call(this);this.onDeleteCallBack=a;this.mouseOn=b;this.mouseMove=c;this.mouseOut=d;return this};LeaveTypeDeleteCellRenderer.prototype.getCellClassName=function(a){return["leaveTypeDeleteCell"]};
LeaveTypeDeleteCellRenderer.prototype.generateContent=function(a){var b=this,c=$(a.getCellEl());a.value.inUse?(c.off("mouseenter mouseleave"),c.hover(function(a){b.mouseOn({},a)},function(){b.mouseOut()}),c.mousemove(function(a){b.mouseMove(a)})):a.getCellEl().onclick=function(){b.onDeleteCallBack(a.value)}};function LeaveTypeListTableRenderer(){this.constructor=LeaveTypeListTableRenderer}LeaveTypeListTableRenderer.prototype.init=function(a){this.table=a;return this};LeaveTypeListTableRenderer.prototype.updateUI=function(){this.table.getTableEl().className=this.getTableClasses().join(" ")};LeaveTypeListTableRenderer.prototype.getBaseTableClasses=function(){return["leaveTypesListTable"]};LeaveTypeListTableRenderer.prototype.getTableClasses=function(){};function LeaveTypeListTableController(){this.constructor=LeaveTypeListTableController}LeaveTypeListTableController.prototype=_.create(Table.prototype);
LeaveTypeListTableController.prototype.init=function(a){var b=this;Table.call(this,a.tHeadEl);this.containerEl=a.containerEl;this.leaveTypeIdRowMap={};this.handlersMap=a.handlersMap;this.arrowImagesPaths=a.arrowImagesPaths;this.isPtoEnabled=a.isPtoEnabled;this.isSickEnabled=a.isSickEnabled;this.leaveTypeListTableRenderer=this.getLeaveTypeListTableRenderer().init(this);this.rowRenderer=(new LeaveTypeListRowRenderer).init();this.numberSettings=a.numberSettings;this.coefficientsFormatter=new NumberFormatter(this.numberSettings.decimalSeparator,
this.numberSettings.digitGroupingSymbol,2,!0);this.iconSelectorPanel=a.iconSelectorPanel;this.iconSelectorPanel.setAfterCloseCallback(function(){$.each(b.rows,function(a,b){b.removeOpenPopupClass();$(b.rowEl).find(".leaveTypeImageCell").removeClass("iconSelectorOpened")})});this.createBodyContent(a.leaveTypeRecords);return this};LeaveTypeListTableController.prototype.getLeaveTypeListTableRenderer=function(){};
LeaveTypeListTableController.prototype.createBodyContent=function(a){if(0==a.length)this.insertEmptyTableRow();else{for(var b=0;b<a.length;b++){var c=a[b];c.position=b+1;this.addRow(this.createRow(c))}$(this.tbody).toggleClass("oneRow",1==a.length)}};
LeaveTypeListTableController.prototype.insertEmptyTableRow=function(){var a=document.createElement("tr"),b=document.createElement("td");b.colSpan=10;$(b).text(messageResource.getMessage("leave_type.list.no_leave_types"));a.appendChild(b);a.id="emptyLeaveTypesTableRow";this.tbody.appendChild(a)};LeaveTypeListTableController.prototype.removeEmptyTableRow=function(){$("#emptyLeaveTypesTableRow").remove()};
LeaveTypeListTableController.prototype.createRow=function(a){var b=(new LeaveTypeListTableRow).init(a);this.leaveTypeIdRowMap[a.id]=b;this.addCellsToRow(b,a);return b};LeaveTypeListTableController.prototype.createLeaveTypeNameCell=function(a,b){var c=new TableCell(a,b);c.setRenderer((new LeaveTypeNameCellRenderer).init(this.handlersMap.changeLeaveName));return c};
LeaveTypeListTableController.prototype.createLeaveTypeImageCell=function(a,b){var c=new TableCell(a,b);c.setRenderer((new LeaveTypeImageCellRenderer).init(this.handlersMap.setLeaveTypeIcon,this.iconSelectorPanel));return c};
LeaveTypeListTableController.prototype.createLeaveTypeAffectedBalanceCell=function(a,b){var c=new TableCell(a,b);c.setRenderer((new LeaveTypeAffectedBalanceCellRenderer).init(this.handlersMap.changeAffectedBalance,this.numberSettings,this.coefficientsFormatter,this.isPtoEnabled,this.isSickEnabled));return c};
LeaveTypeListTableController.prototype.createLeaveTypeChangeOrderCell=function(a,b){var c=new TableCell(a,b);c.setRenderer((new LeaveTypeChangeOrderCellRenderer).init(this.arrowImagesPaths,this.handlersMap.moveLeaveType));return c};LeaveTypeListTableController.prototype.createLeaveTypeStatusCell=function(a,b){var c=new TableCell(a,b);c.setRenderer((new LeaveTypeStatusCellRenderer).init(this.handlersMap.changeLeaveTypeStatus));return c};
LeaveTypeListTableController.prototype.createLeaveTypeDeleteCell=function(a,b){var c=new TableCell(a,b);c.setRenderer((new LeaveTypeDeleteCellRenderer).init(this.handlersMap.deleteLeaveType,this.handlersMap.deleteCellMouseOn,this.handlersMap.deleteCellMouseMove,this.handlersMap.deleteCellMouseOut));return c};LeaveTypeListTableController.prototype.addCellsToRow=function(a,b){};LeaveTypeListTableController.prototype.render=function(){this.buildDOM(this.containerEl);this.leaveTypeListTableRenderer.updateUI()};
LeaveTypeListTableController.prototype.setupTableHeaderEventHandlers=function(){$("#affectedBalanceInfoIcon").click(this.handlersMap.showAffectedBalanceHeaderTooltip)};LeaveTypeListTableController.prototype.getBaseRowClasses=function(a){a=this.getRow(a).getLeaveTypeInfo();return this.rowRenderer.getRowClasses(a)};
LeaveTypeListTableController.prototype.redrawTableBody=function(a){this.removeEmptyTableRow();this.deleteAllRowsFromModelAndDom();this.createBodyContent(a);this.buildModelRowsDOM(this.tbody);this.leaveTypeListTableRenderer.updateUI()};LeaveTypeListTableController.prototype.temporaryHighlightRow=function(a){var b=this.leaveTypeIdRowMap[a];b.highlight();setTimeout(function(){b.unhighlight()},1E3)};
LeaveTypeListTableController.prototype.temporaryMarkRow=function(a){var b=this.leaveTypeIdRowMap[a];if(b){a=b.getRowIdx();var c;0<a&&(c=this.getRow(a-1),c.addClass("previous"));var d=this;this.setDisabledHover(!0);b.markMovedRow();b.addClass("step1");setTimeout(function(){b.removeClass("step1");b.addClass("step2");c&&c.removeClass("previous");$(document).on("mousemove",function(){d.setDisabledHover(!1);b.unMarkMovedRow();b.removeClass("step2");$(document).off("mousemove")})},1E3)}};
LeaveTypeListTableController.prototype.isDisabledHover=function(){return this.disabledHover};LeaveTypeListTableController.prototype.setDisabledHover=function(a){return this.disabledHover=a};function LeaveTypeIconSelectorPanel(){this.constructor=LeaveTypeIconSelectorPanel}
LeaveTypeIconSelectorPanel.prototype.init=function(a,b,c){var d=this;this.afterCloseCallback=c;this.iconSelectorPanelEl=$(document.getElementById(a));this.panel=new DropdownDialog({wrapperClass:"LeaveTypeIconSelectorPanel",dialogDiv:this.iconSelectorPanelEl,hideButtons:!0,hideOnResize:!0,showEmptyTitleBar:!1,onClose:function(a){d.afterCloseCallback&&d.afterCloseCallback();a.stopPropagation();KeyDownHandler.restoreOnKeyDownHandler()}});b||this.iconSelectorPanelEl.addClass("hideRequestColorInIconPanel");
this.iconSelectorPanelEl.find("div.iconDiv").each(function(){$(this).click(function(){var a=$(this).attr("id").substring(8);d.iconSelectedCallback(a)})});return this};
LeaveTypeIconSelectorPanel.prototype.initAndShow=function(a,b,c){this.currentIconId=a;this.iconSelectorPanelEl.find(".iconDiv.selectedIcon").removeClass("selectedIcon");this.iconSelectorPanelEl.find("#div_icon"+a).addClass("selectedIcon");this.iconSelectedCallback=c;this.panel.showAt(b,{my:"left top",at:"left bottom",collision:"flip"});a=$("#leaveTypeLightBox").zIndex();$(".ui-widget-overlay").zIndex(a+1);$(".LeaveTypeIconSelectorPanel").zIndex(a+2);KeyDownHandler.setOnKeyDownHandler(function(){})};
LeaveTypeIconSelectorPanel.prototype.hide=function(){this.panel.hide()};LeaveTypeIconSelectorPanel.prototype.setAfterCloseCallback=function(a){this.afterCloseCallback=a};function LeaveTypeIconSelector(){this.constructor=LeaveTypeIconSelector}LeaveTypeIconSelector.prototype.init=function(a,b){this.iconSelectorPanel=a;b&&(this.changesCallback=b);return this};
LeaveTypeIconSelector.prototype.getSelectorEl=function(){var a=this,b=document.createElement("div");b.className="leaveTypeIconSelector";var c=document.createElement("div");c.className="requestColorDiv";this.requestColorDiv=$(c);b.appendChild(c);c=document.createElement("div");c.className="leaveTypeIconDiv";var d=document.createElement("img");this.iconImg=d;c.appendChild(d);b.appendChild(c);c=document.createElement("div");c.className="arrowDiv";b.appendChild(c);b.onclick=function(){a.iconSelectorPanel.initAndShow(a.currentIconId,
b,function(b){a.handlePanelClicking(b)})};return b};LeaveTypeIconSelector.prototype.setIcon=function(a){this.currentIconId=a;this.iconImg.src=getLeaveTypeIconPath(this.currentIconId);a="leave_icon"+a;this.requestColorDiv.removeClass();this.requestColorDiv.addClass("requestColorDiv "+a)};LeaveTypeIconSelector.prototype.getIconId=function(){return this.currentIconId};
LeaveTypeIconSelector.prototype.handlePanelClicking=function(a){this.iconSelectorPanel.hide();this.changesCallback&&this.changesCallback();this.setIcon(a)};function ExtendedLeaveTypeIconSelector(){this.constructor=ExtendedLeaveTypeIconSelector}ExtendedLeaveTypeIconSelector.prototype=_.create(LeaveTypeIconSelector.prototype);ExtendedLeaveTypeIconSelector.prototype.init=function(a,b,c){LeaveTypeIconSelector.prototype.init.call(this,a);this.leaveTypeId=b;this.iconSelectedCallback=c;return this};
ExtendedLeaveTypeIconSelector.prototype.handlePanelClicking=function(a){var b=this;this.currentIconId!=a?this.iconSelectedCallback(this.leaveTypeId,a,function(){b.iconSelectorPanel.hide()}):this.iconSelectorPanel.hide()};function NoBalancesEditPanelController(){this.constructor=NoBalancesEditPanelController}NoBalancesEditPanelController.DEFAULT_BALANCE_COEFF=1;NoBalancesEditPanelController.WRONG_PTO_COEFF_ERROR="wrongPtoCoeffError";NoBalancesEditPanelController.EMPTY_PTO_COEFF_ERROR="emptyPtoCoeffError";
NoBalancesEditPanelController.prototype.init=function(a){this.container=a.container;this.numberSettings=a.numberSettings;this.elementSuffix=a.elementSuffix;this.errors=[];this._initElements();this._hideElements();return this};
NoBalancesEditPanelController.prototype._initElements=function(){this.processLeaveTimeCheckbox=this._getElementBySubId("processLeaveTimeCheckbox");this.asPtoRadioButton=this._getElementBySubId("asPtoRadioButton");this.asPtoDiv=this.container.find(".asPtoDiv");this.ptoCoefficientInput=this._getElementBySubId("ptoCoefficientInput");this.ptoCoeffErrorPlaceholder=this.container.find(".ptoCoeffErrorPlaceholder");this.ptoCoefficientField=new DecimalField(this.ptoCoefficientInput,!0,5,2,this.numberSettings.decimalSeparator,
!1,this.numberSettings.digitGroupingSymbol,void 0,!0,this.numberSettings.ptoMaxNumber);this.asSickDaysRadioButton=this._getElementBySubId("asSickDaysRadioButton");this.asSickDaysDiv=this.container.find(".asSickDaysDiv");var a=$("<span>");a.addClass("emptyPtoCoeffErrorText");a.text(messageResource.getMessage("leave_type.error.pto_coefficient_required"));this.ptoCoeffErrorPlaceholder.append(a);a=$("<span>");a.addClass("wrongPtoCoeffErrorText");a.text(messageResource.getMessage("leave_type.error.invalid_pto_coefficient",
[this.numberSettings.decimalSeparator,this.numberSettings.ptoMaxNumber]));this.ptoCoeffErrorPlaceholder.append(a)};NoBalancesEditPanelController.prototype.isProcessLeaveTypeChecked=function(){return!!this.processLeaveTimeCheckbox.attr("checked")};NoBalancesEditPanelController.prototype._hideElements=function(){this.container.addClass("hidden")};NoBalancesEditPanelController.prototype.hideErrors=function(){this.errors=[];this.container.removeClass(NoBalancesEditPanelController.WRONG_PTO_COEFF_ERROR)};
NoBalancesEditPanelController.prototype.checkEmpty=function(){return!1};NoBalancesEditPanelController.prototype._checkEmptyAsPto=function(){return this.ptoCoefficientField.isEmpty()};NoBalancesEditPanelController.prototype.hideEmptyError=function(){this.container.removeClass(NoBalancesEditPanelController.EMPTY_PTO_COEFF_ERROR)};NoBalancesEditPanelController.prototype.showEmptyPtoErrorMessage=function(){this.container.addClass(NoBalancesEditPanelController.EMPTY_PTO_COEFF_ERROR)};
NoBalancesEditPanelController.prototype.showAllErrors=function(){this.checkEmpty()&&this.showEmptyPtoErrorMessage();this.showErrors()};NoBalancesEditPanelController.prototype.hideAllErrors=function(){this.hideEmptyError();this.hideErrors()};NoBalancesEditPanelController.prototype.populate=function(a){};NoBalancesEditPanelController.prototype.validate=function(){return!0};NoBalancesEditPanelController.prototype.getBalanceType=function(){return null};
NoBalancesEditPanelController.prototype.getBalanceCoefficient=function(){return this.isAsPTOChecked()?this.ptoCoefficientField.getValueAsNumber():NoBalancesEditPanelController.DEFAULT_BALANCE_COEFF};NoBalancesEditPanelController.prototype._setPtoCoefficientIntoField=function(a){this.ptoCoefficientField.setValueAsNumber("number"==typeof a?a:NoBalancesEditPanelController.DEFAULT_BALANCE_COEFF)};NoBalancesEditPanelController.prototype._getElementBySubId=function(a){return $("#"+a+"_"+this.elementSuffix)};
NoBalancesEditPanelController.prototype.showErrors=function(){for(var a=0;a<this.errors.length;a++)this.container.addClass(this.errors[a])};NoBalancesEditPanelController.prototype._validateAsPto=function(){if(!this.isAsPTOChecked())return!0;this.errors=[];return this.ptoCoefficientField.isEmpty()||this.ptoCoefficientField.isValid()?!0:(this.errors.push(NoBalancesEditPanelController.WRONG_PTO_COEFF_ERROR),!1)};
NoBalancesEditPanelController.prototype.setOnblurPtoCoefficientInputElement=function(a){this.ptoCoefficientInput.on("blur",a)};NoBalancesEditPanelController.prototype.isAsPTOChecked=function(){return this.isProcessLeaveTypeChecked()&&this.asPtoRadioButton.attr("checked")};function LeaveTypeBalancesEditPanelController(){this.constructor=LeaveTypeBalancesEditPanelController}LeaveTypeBalancesEditPanelController.prototype=new NoBalancesEditPanelController;
LeaveTypeBalancesEditPanelController.prototype.init=function(a){NoBalancesEditPanelController.prototype.init.call(this,a);var b=this,c=a.innerErrorsChangeCallback;this.processLeaveTimeCheckbox.click(function(a){b._changeDisableValueOfCheckboxes(a.target.checked);b.asPtoRadioButton.attr("checked")&&a.target.checked?b.ptoCoefficientInput.removeAttr("disabled"):b.ptoCoefficientInput.attr("disabled",!0);c&&c()});this.container.find("input[name='processLeaveTimeRadio']").click(function(a){a.target!=b.asPtoRadioButton[0]?
(b.hideAllErrors(),b.ptoCoefficientInput.attr("disabled",!0),c&&c()):b.ptoCoefficientInput.removeAttr("disabled")});return this};LeaveTypeBalancesEditPanelController.prototype._hideElements=function(){};
LeaveTypeBalancesEditPanelController.prototype.populate=function(a){if(a){switch(a.balanceType){case BalanceType.PTO:this.processLeaveTimeCheckbox.attr("checked","checked");this.asPtoRadioButton.attr("checked","checked");break;case BalanceType.SICK:this.processLeaveTimeCheckbox.attr("checked","checked");this.asSickDaysRadioButton.attr("checked","checked");break;default:this.asSickDaysRadioButton.removeAttr("checked"),this.asPtoRadioButton.attr("checked","checked"),this.processLeaveTimeCheckbox.removeAttr("checked")}a.balanceType==
BalanceType.PTO?(this._setPtoCoefficientIntoField(a.ptoCoefficient),this.ptoCoefficientInput.removeAttr("disabled")):(this._setPtoCoefficientIntoField(NoBalancesEditPanelController.DEFAULT_BALANCE_COEFF),this.ptoCoefficientInput.attr("disabled",!0));this._changeDisableValueOfCheckboxes(this.processLeaveTimeCheckbox.attr("checked"))}};
LeaveTypeBalancesEditPanelController.prototype._changeDisableValueOfCheckboxes=function(a){a?(this.asPtoRadioButton.removeAttr("disabled"),this.asSickDaysRadioButton.removeAttr("disabled")):(this.asPtoRadioButton.attr("disabled",!0),this.asSickDaysRadioButton.attr("disabled",!0),this.hideAllErrors())};LeaveTypeBalancesEditPanelController.prototype.validate=function(){return this._validateAsPto()};
LeaveTypeBalancesEditPanelController.prototype.getBalanceType=function(){var a=null;this.isProcessLeaveTypeChecked()&&(a=this.asPtoRadioButton.attr("checked")?BalanceType.PTO:BalanceType.SICK);return a};LeaveTypeBalancesEditPanelController.prototype.checkEmpty=function(){return this._checkEmptyAsPto()};function PtoBalanceEditPanelController(){this.constructor=PtoBalanceEditPanelController}PtoBalanceEditPanelController.prototype=new NoBalancesEditPanelController;
PtoBalanceEditPanelController.prototype.init=function(a){NoBalancesEditPanelController.prototype.init.call(this,a);var b=this,c=a.innerErrorsChangeCallback;this.processLeaveTimeCheckbox.click(function(a){b._changeDisableValueOfPtoInput(a.target.checked);!a.target.checked&&c&&c()});return this};PtoBalanceEditPanelController.prototype._changeDisableValueOfPtoInput=function(a){a?this.ptoCoefficientInput.removeAttr("disabled"):(this.ptoCoefficientInput.attr("disabled",!0),this.hideAllErrors())};
PtoBalanceEditPanelController.prototype._hideElements=function(){this.container.addClass("withoutRadioButtons");this.asSickDaysDiv.addClass("hidden")};PtoBalanceEditPanelController.prototype.validate=function(){return this._validateAsPto()};
PtoBalanceEditPanelController.prototype.populate=function(a){a&&(a.balanceType==BalanceType.PTO?(this.processLeaveTimeCheckbox.attr("checked","checked"),this._setPtoCoefficientIntoField(a.ptoCoefficient)):(this.processLeaveTimeCheckbox.removeAttr("checked"),this._setPtoCoefficientIntoField(NoBalancesEditPanelController.DEFAULT_BALANCE_COEFF)),this._changeDisableValueOfPtoInput(a.balanceType==BalanceType.PTO),this.asPtoRadioButton.attr("checked","checked"))};
PtoBalanceEditPanelController.prototype.getBalanceType=function(){return this.processLeaveTimeCheckbox.attr("checked")?BalanceType.PTO:null};PtoBalanceEditPanelController.prototype.checkEmpty=function(){return this._checkEmptyAsPto()};function SickDaysBalanceEditPanelController(){this.constructor=PtoBalanceEditPanelController}SickDaysBalanceEditPanelController.prototype=new NoBalancesEditPanelController;
SickDaysBalanceEditPanelController.prototype._hideElements=function(){this.container.addClass("withoutRadioButtons");this.asPtoDiv.addClass("hidden")};SickDaysBalanceEditPanelController.prototype.populate=function(a){a&&(a.balanceType==BalanceType.SICK?this.processLeaveTimeCheckbox.attr("checked","checked"):this.processLeaveTimeCheckbox.removeAttr("checked"),this.asSickDaysRadioButton.attr("checked","checked"))};
SickDaysBalanceEditPanelController.prototype.getBalanceType=function(){return this.processLeaveTimeCheckbox.attr("checked")?BalanceType.SICK:null};function LeaveTypeListPageController(){this.constructor=LeaveTypeListPageController}LeaveTypeListPageController.RESULT_SUCCESSFULL=200;LeaveTypeListPageController.ERROR_LEAVE_TYPE_ALREADY_IN_USE=400;LeaveTypeListPageController.ERROR_NAME_DUPLICATE=401;LeaveTypeListPageController.ERROR_COMPETITIVE_DELETED=402;
LeaveTypeListPageController.prototype.init=function(a,b,c){var d=this;this.tHeadEl=document.getElementById("leaveTypesListTableHeader");this.containerEl=document.getElementById("leaveTypeListTableContainer");this.numberSettings=b;this.affectedBalanceHeaderTooltip=new DropdownDialog({wrapperClass:"AffectedBalanceHeaderTooltipWrapper",dialogDiv:$("#AffectedBalanceHeaderTooltip"),hideButtons:!0,hideOnResize:!0,showEmptyTitleBar:!1,isWithBeak:!0});this.leaveTypeInUseTooltip=(new DelayTooltip).init("cantDeleteLeaveTypeTooltip");
this.newLeaveTypeButton=new GraphicButton(GraphicButton.getRoundedBox("createLeaveTypeDiv",messageResource.getMessage("leave_type.list.add_button_text")));this.newLeaveTypeButton.defineStandardEventHandlers(!0,!0,!0,!0);this.newLeaveTypeButton.button.el.on("click",function(a){d.showCreateLeaveTypePopup(a)});this.iconSelectorPanel=this.createAndInitIconSelectorPanel();this.leaveTypeLightBox=this.createAndInitLeaveTypeLightBox();this.leaveTypeLightBox.setNewLeaveTypeDefaultIcon(c);this.errorMessages=
{};this.errorMessages[LeaveTypeListPageController.ERROR_COMPETITIVE_DELETED]=messageResource.getMessage("leave_type.edit.error.competitive_deleted");this.errorMessages[LeaveTypeListPageController.ERROR_LEAVE_TYPE_ALREADY_IN_USE]=messageResource.getMessage("leave_type.list.cannot_delete.already_in_use");this.initializeHandlersMap();this.spinnerController=new SpinnerController;return this};LeaveTypeListPageController.prototype.initializeHandlersMap=function(){};
LeaveTypeListPageController.prototype.createBaseHandlersMap=function(){var a=this;return{showAffectedBalanceHeaderTooltip:function(){a.showAffectedBalanceHeaderTooltip()},hideAffectedBalanceHeaderTooltip:function(){a.hideAffectedBalanceHeaderTooltip()},deleteCellMouseOn:a.getShowTooltip(a.leaveTypeInUseTooltip),deleteCellMouseMove:a.getMoveTooltip(a.leaveTypeInUseTooltip),deleteCellMouseOut:a.getHideTooltip(a.leaveTypeInUseTooltip),deleteLeaveType:function(b){a.deleteLeaveType(b)},moveLeaveType:function(b,
c){a.moveLeaveType(b,c)},setLeaveTypeIcon:function(b,c,d){a.setLeaveTypeIcon(b,c,d)},changeLeaveTypeStatus:function(b,c){a.changeLeaveTypeStatus(b,c)},changeLeaveName:function(b,c,d,e){a.changeLeaveTypeName(b,c,d,e)},changeAffectedBalance:function(b,c,d){a.changeAffectedBalance(b,c,d)}}};LeaveTypeListPageController.prototype.render=function(){this.leaveTypeListTableController.render()};
LeaveTypeListPageController.prototype.showAffectedBalanceHeaderTooltip=function(){this.affectedBalanceHeaderTooltip.showAt(document.getElementById("affectedBalanceInfoIcon"),{my:"left top",at:"left bottom",offset:this.tableHeaderTooltipsOffsetParams,collision:"none"})};LeaveTypeListPageController.prototype.hideAffectedBalanceHeaderTooltip=function(){this.affectedBalanceHeaderTooltip.hide()};
LeaveTypeListPageController.prototype.getShowTooltip=function(a){return function(b,c){a.updateUIAndShow(b,calculateTooltipOffset(a,c))}};LeaveTypeListPageController.prototype.getMoveTooltip=function(a){return function(b){a.move(calculateTooltipOffset(a,b))}};LeaveTypeListPageController.prototype.getHideTooltip=function(a){return function(){a.hide()}};
LeaveTypeListPageController.prototype.deleteLeaveType=function(a){confirm(messageResource.getMessage("leave_type.confirm_delete"))&&this.callLeaveTypeServiceMethod("LeaveTypeService.deleteLeaveType",[a.id],!0)};LeaveTypeListPageController.prototype.moveLeaveType=function(a,b){var c=this;this.callLeaveTypeServiceMethod("LeaveTypeService.moveLeaveType",[a,b],!0,function(a){c.leaveTypeListTableController.temporaryMarkRow(a.changedLeaveTypeId)})};
LeaveTypeListPageController.prototype.showCreateLeaveTypePopup=function(){var a=this;this.leaveTypeLightBox.initAsCreatePopup();this.leaveTypeLightBox.setSuccessCallback(function(b){a.createLeaveType(b)});this.leaveTypeLightBox.show();this.leaveTypeLightBox.setFocusIntoNameField()};LeaveTypeListPageController.prototype.createLeaveType=function(a){this.callPopupLeaveTypeServiceMethod("LeaveTypeService.createLeaveType",[a])};
LeaveTypeListPageController.prototype.callPopupLeaveTypeServiceMethod=function(a,b){var c=this;this.leaveTypeLightBox.disableUserInputWhileSaving();this.callLeaveTypeServiceMethod(a,b,!1,function(a){c.leaveTypeLightBox.enableUserInputWhileSaving();if(a.resultCode==LeaveTypeListPageController.ERROR_NAME_DUPLICATE)return c.leaveTypeLightBox.displayNameDuplicateError(),!0;c.leaveTypeLightBox.hide()},function(a,b,f){c.leaveTypeLightBox.enableUserInputWhileSaving()})};
LeaveTypeListPageController.prototype.setLeaveTypeIcon=function(a,b,c){this.callLeaveTypeServiceMethod("LeaveTypeService.setIconId",[a,b],!0,c)};LeaveTypeListPageController.prototype.changeLeaveTypeStatus=function(a,b){this.callLeaveTypeServiceMethod("LeaveTypeService.setLeaveTypeStatus",[a,!b],!0)};LeaveTypeListPageController.prototype.changeLeaveTypeName=function(a,b,c){this.callLeaveTypeServiceMethod("LeaveTypeService.setLeaveTypeName",[a,b],!0,c)};
LeaveTypeListPageController.prototype.changeAffectedBalance=function(a,b,c){this.callLeaveTypeServiceMethod("LeaveTypeService.setAffectedBalance",[a,b,c],!0)};
LeaveTypeListPageController.prototype.leaveTypeServiceResultHandler=function(a,b){this.errorMessages[a.resultCode]&&alert(this.errorMessages[a.resultCode]);this.leaveTypeListTableController.redrawTableBody(a.leaveTypesInfo.list);0<a.changedLeaveTypeId&&this.leaveTypeListTableController.temporaryHighlightRow(a.changedLeaveTypeId);this.leaveTypeLightBox.setNewLeaveTypeDefaultIcon(a.newLeaveTypeIconId);if(b)return b(a)};
LeaveTypeListPageController.prototype.leaveTypeServiceErrorHandler=function(a,b,c,d){if(d)return d(a,b,c)};LeaveTypeListPageController.prototype.callLeaveTypeServiceMethod=function(a,b,c,d,e){var f=this;c&&this.spinnerController.spin("spinnerPlaceholder");makeRpcCall(a,b,function(a){f.spinnerController.stop();f.leaveTypeServiceResultHandler(a,d)},function(a,b,c){f.spinnerController.stop();return f.leaveTypeServiceErrorHandler(a,b,c,e)})};function LeaveTypeLightBox(){}LeaveTypeLightBox.NAME_EMPTY="nameEmptyError";LeaveTypeLightBox.NAME_DUPLICATE="nameDuplicateError";LeaveTypeLightBox.PTO_COEFF_EMPTY="ptoCoeffEmptyError";LeaveTypeLightBox.PTO_COEFF_INVALID="ptoCoeffInvalidError";LeaveTypeLightBox.RATE_COEFF_EMPTY="rateCoeffEmptyError";LeaveTypeLightBox.RATE_COEFF_INVALID="rateCoeffInvalidError";LeaveTypeLightBox.CREATE_POPUP_DEFAULT_LEAVE_TYPE_ID=0;LeaveTypeLightBox.CREATE_POPUP_DEFAULT_LEAVE_TYPE_NAME="";
LeaveTypeLightBox.CREATE_POPUP_DEFAULT_LEAVE_TYPE_STATUS=!0;LeaveTypeLightBox.CREATE_POPUP_DEFAULT_IS_PTO=!1;LeaveTypeLightBox.CREATE_POPUP_DEFAULT_PTO_COEFF=1;LeaveTypeLightBox.prototype=_.create(BasicLightbox.prototype);LeaveTypeLightBox.prototype.exist_invalid_fields_message_key="leave_type.edit.correct_errors";LeaveTypeLightBox.prototype.close_tab_confirmation_message_key="leave_type.create.close_tab_confirmation";
LeaveTypeLightBox.prototype.init=function(a,b,c){var d=this;this.balancesEditPanel=(new c).init({container:$(".balancesEditPanelSection"),numberSettings:a,elementSuffix:"createPopup",innerErrorsChangeCallback:function(){d.updateErrors(!1)}});BasicLightbox.prototype.init.call(this,"leaveTypeLightBox","closeLeaveTypeLightBoxBtn");this.numberSettings=a;this.cancelCallback=d.hide;this.titlePlaceholder=this.getElementBySubId("titlePlaceholder");this.leaveTypeNamePlaceholder=this.getElementBySubId("leaveTypeNamePlaceholder");
this.leaveTypeInfoTable=this.getElementBySubId("leaveTypeInfoTable");this.commitButtonTitlePlaceholder=$(document.getElementById(this.lightBoxEl.id+"_commitBtn")).find(".buttonTitle");this.nameField=$(this.getElementBySubId("nameField"));this.iconSelector=(new LeaveTypeIconSelector).init(b,function(){d.changesCallback()});this.iconSelectorPl=this.getElementBySubId("iconSelectorPlaceholder");this.iconSelectorPl.appendChild(this.iconSelector.getSelectorEl());this.newLeaveTypeDefaultIconId=1;this.balancesEditPanel.setOnblurPtoCoefficientInputElement(function(){d.balancesEditPanel.checkEmpty()?
d.balancesEditPanel.hideErrors():(d.balancesEditPanel.hideEmptyError(),d.balancesEditPanel.validate()?d.balancesEditPanel.hideErrors():d.balancesEditPanel.showErrors(),d.updateErrors(!1))});this.statusSelectorPlaceHolderEl=this.getElementBySubId("statusSelectorPlaceholder");this.footer=$(this.getElementBySubId("footer"));return this};LeaveTypeLightBox.prototype.setValue=function(a,b){a.removeClass("placeholder");a[0].value=b;a[0].prevValue=a[0].value};
LeaveTypeLightBox.prototype.setTitle=function(a){this.titlePlaceholder.innerHTML=escapeHtmlSymbols(a)};LeaveTypeLightBox.prototype.setNameInTitle=function(a){this.leaveTypeNamePlaceholder.innerHTML=escapeHtmlSymbols(a)};LeaveTypeLightBox.prototype.getLeaveTypeName=function(){return this.nameField.pVal()};
LeaveTypeLightBox.prototype.setNameFieldHandlersForCreatePopup=function(){var a=this;this.nameField.off();this.nameField.blur(this.basicOnBlurFieldHandler(function(){a.checkNameOnChange();a.setNameInTitle(a.getLeaveTypeName())}));this.nameField.keyup(this.basicKeyUpChangesHandler(function(){a.setNameInTitle(a.getLeaveTypeName())}));this.nameField.change(function(){a.hideNameDuplicateError()});this.nameField.keydown(this.basicOnKeyPressedHandler)};
LeaveTypeLightBox.prototype.setNameFieldHandlersForEditPopup=function(){var a=this;this.nameField.off();this.nameField.blur(this.basicOnBlurFieldHandler(function(){a.checkNameOnChange()}));this.nameField.keyup(this.basicKeyUpChangesHandler());this.nameField.change(function(){a.hideNameDuplicateError()});this.nameField.keydown(this.basicOnKeyPressedHandler)};LeaveTypeLightBox.prototype.checkNameOnChange=function(){this.checkEmpty(this.nameField,LeaveTypeLightBox.NAME_EMPTY,!0,!0);this.updateErrors(!1)};
LeaveTypeLightBox.prototype.isNameValid=function(a){return!this.checkEmpty(this.nameField,LeaveTypeLightBox.NAME_EMPTY,a,!0)};LeaveTypeLightBox.prototype.displayNameDuplicateError=function(){this.errors[LeaveTypeLightBox.NAME_DUPLICATE]=!0;this.updateErrors(!0)};LeaveTypeLightBox.prototype.hideNameDuplicateError=function(){this.errors[LeaveTypeLightBox.NAME_DUPLICATE]=!1;this.updateErrors()};LeaveTypeLightBox.prototype.setFocusIntoNameField=function(){setFocusIntoFieldWithPlaceholder(this.nameField)};
LeaveTypeLightBox.prototype.initStatusSelector=function(a){var b=this,c=[{text:messageResource.getMessage("leave_type.active"),value:!0},{text:messageResource.getMessage("leave_type.archived"),value:!1}];this.statusSelectorPlaceHolderEl.innerHTML="";this.statusSelector=new ListSelector({menuCls:"leaveTypeStatusSelectorMenu",renderTo:this.statusSelectorPlaceHolderEl,value:a,listItems:c});var d=function(a){$(b.statusSelectorPlaceHolderEl).removeClass("active archived");$(b.statusSelectorPlaceHolderEl).addClass(a?
"active":"archived")};d(a);this.statusSelector.on("change",function(){b.changesCallback();d(b.getStatus())})};LeaveTypeLightBox.prototype.getStatus=function(){return this.statusSelector.getSelectedItem().value};LeaveTypeLightBox.prototype.getElementBySubId=function(a){return document.getElementById(this.lightBoxEl.id+"_"+a)};LeaveTypeLightBox.prototype.setNewLeaveTypeDefaultIcon=function(a){this.newLeaveTypeDefaultIconId=a};
LeaveTypeLightBox.prototype.isCoeffValid=function(a,b,c,d,e){this.errors[d]=!1;if(e){if(!this.checkEmpty(b,c,!0))return this.errors[d]=!a.isValid()}else return a=a.isValid(),this.errors[d]=!a,!(this.checkEmpty(b,c,!1)||!a)};LeaveTypeLightBox.prototype.getErrorsMap=function(){return this.errors};LeaveTypeLightBox.prototype.validate=function(){var a=this.performCommonCheck()&this.performSpecificCheck();this.updateErrors(!0);return a};
LeaveTypeLightBox.prototype.performCommonCheck=function(){return this.isNameValid(!1)&!this.errors[LeaveTypeLightBox.NAME_DUPLICATE]};LeaveTypeLightBox.prototype.performSpecificCheck=function(){return!0};LeaveTypeLightBox.prototype.initBeforeShow=function(){this.dataChanged=!1;this.footer.removeClass("changesDetected");this.resetErrors()};
LeaveTypeLightBox.prototype.initAsCreatePopup=function(){this.initBeforeShow();this.editMode=!1;$(this.lightBoxEl).removeClass("editMode");this.setTitle(messageResource.getEscapedMessage("leave_type.create.title"));this.setNameInTitle(LeaveTypeLightBox.CREATE_POPUP_DEFAULT_LEAVE_TYPE_NAME);this.setCommitButtonTitle(messageResource.getEscapedMessage("leave_type.create.commit_button"));this.leaveTypeId=LeaveTypeLightBox.CREATE_POPUP_DEFAULT_LEAVE_TYPE_ID;this.setValue(this.nameField,LeaveTypeLightBox.CREATE_POPUP_DEFAULT_LEAVE_TYPE_NAME);
this.setNameFieldHandlersForCreatePopup();this.nameField.placeholder();this.initStatusSelector(LeaveTypeLightBox.CREATE_POPUP_DEFAULT_LEAVE_TYPE_STATUS);this.iconSelector.setIcon(this.newLeaveTypeDefaultIconId);this.cancel_confirmation_message_key="leave_type.create.exit_confirmation";this.close_tab_confirmation_message_key="leave_type.create.close_tab_confirmation";this.balancesEditPanel.hideAllErrors();this.balancesEditPanel.populate({balanceType:null,ptoCoefficient:LeaveTypeLightBox.CREATE_POPUP_DEFAULT_PTO_COEFF})};
LeaveTypeLightBox.prototype.changesDetected=function(){this.dataChanged||(this.dataChanged=!0,this.editMode&&this.footer.addClass("changesDetected"))};LeaveTypeLightBox.prototype.resetErrors=function(){this.errors={};this.updateErrors()};LeaveTypeLightBox.prototype.setErrorClasses=function(a){this.leaveTypeInfoTable.className=a.join(" ")};LeaveTypeLightBox.prototype.updateErrors=function(a){this.hasErrors()?a&&this.displayErrorInFooter():this.removeErrorInFooter()};
LeaveTypeLightBox.prototype.updateUI=function(){this.updateErrors(!0)};LeaveTypeLightBox.prototype.displayErrorInFooter=function(){this._errorMessageBox.removeClass("disabled");this.balancesEditPanel.showAllErrors()};LeaveTypeLightBox.prototype.removeErrorInFooter=function(){BasicLightbox.prototype.removeErrorInFooter.call(this);this.balancesEditPanel.hideAllErrors()};
LeaveTypeLightBox.prototype.hasErrors=function(){return BasicLightbox.prototype.hasErrors.call(this)||this.balancesEditPanel.checkEmpty()||!this.balancesEditPanel.validate()};function LeaveNamePopup(){}
LeaveNamePopup.prototype.init=function(a,b,c,d){function e(a){a.resultCode!=LeaveTypeListPageController.ERROR_NAME_DUPLICATE?f.dialog.hide():f.showError("leave_type.edit.error.name_duplicate")}var f=this;this.container=$("#"+a);this.dialog=new DropdownDialog({wrapperClass:"leaveNamePopup",dialogDiv:this.container,hideButtons:!0,hideOnResize:!0,showEmptyTitleBar:!1,isWithBeak:!1,onClose:function(){f.afterCloseHandler&&f.afterCloseHandler()}});this.inputDiv=this.container.find(".inputDiv");this.inputDiv.on("blur",
function(){f.currentName!=f.getValue()&&f.hasError&&f.hideError()});this.applyButton=this.container.find(".applyButton");this.applyButton.on("click",function(){if(!f.hasError){var a=f.getValue();a==f.originName?f.dialog.hide():""==a?f.showError("leave_type.error.name_required"):(f.currentName=a,b(f.value.id,f.currentName,e))}});this.cancelButton=this.container.find(".cancelButton");this.cancelButton.on("click",function(){f.dialog.hide()});return this};LeaveNamePopup.prototype.getValue=function(){return trim($(this.inputDiv).pVal())};
LeaveNamePopup.prototype.showError=function(a){this.container.find(".errorPlaceholder").text(messageResource.getMessage(a));this.container.addClass("error");this.hasError=!0};LeaveNamePopup.prototype.hideError=function(){this.container.removeClass("error");this.hasError=!1};LeaveNamePopup.prototype.setValue=function(a){this.value=a;this.currentName=a.name;$(this.inputDiv).val(a.name)};
LeaveNamePopup.prototype.show=function(a,b,c,d){c&&c();this.hideError();this.afterCloseHandler=d;this.dialog.showAt(a,b);this.originName=this.getValue()};function AffectedBalancePopup(){}
AffectedBalancePopup.prototype.init=function(a,b,c){var d=this;this.container=a;this.balancesEditPanel=c;this.onEditCallBack=b;this.affectedBalanceDialog=new DropdownDialog({wrapperClass:"affectedBalancePopup",dialogDiv:this.container,hideOnResize:!0,showEmptyTitleBar:!1,okButtonText:messageResource.getMessage("common.apply"),onOkClick:function(){d.onApplyClickCallback()},onClose:function(){d.afterCloseHandler&&d.afterCloseHandler()}});this.balancesEditPanel.setOnblurPtoCoefficientInputElement(function(){d.onblurCallback()});return this};
AffectedBalancePopup.prototype.show=function(a,b,c){this.beforeShowHandler=b;this.afterCloseHandler=c;this.balancesEditPanel.hideAllErrors();this.balancesEditPanel.populate({balanceType:this.value.balanceType,ptoCoefficient:this.value.balanceCoefficient});this.beforeShowHandler&&this.beforeShowHandler();this.affectedBalanceDialog.showAt(a)};
AffectedBalancePopup.prototype.onApplyClickCallback=function(){this.balancesEditPanel.hideAllErrors();this.balancesEditPanel.isAsPTOChecked()&&this.balancesEditPanel.checkEmpty()?this.balancesEditPanel.showEmptyPtoErrorMessage():this.balancesEditPanel.validate()?(this.onEditCallBack(this.value.id,this.balancesEditPanel.getBalanceType(),this.balancesEditPanel.getBalanceCoefficient()),this.affectedBalanceDialog.hide()):this.balancesEditPanel.showErrors()};
AffectedBalancePopup.prototype.onblurCallback=function(){this.balancesEditPanel.checkEmpty()?this.balancesEditPanel.hideErrors():(this.balancesEditPanel.hideEmptyError(),this.balancesEditPanel.validate()?this.balancesEditPanel.hideErrors():this.balancesEditPanel.showErrors())};AffectedBalancePopup.prototype.setValue=function(a){this.value=a};function CreateLightbox(a,b){DHTMLPopupWithMoire.call(this,a);this.afterHideHandler=function(){};this.setAfterHideHandler=function(a){this.afterHideHandler=a};this.permitToHideCallback=function(){return!0};this.setPermitToHideCallback=function(a){this.permitToHideCallback=a};this.closeButton=document.getElementById(b);this.closeButton.onclick=makeHandler(this.hide,this)}CreateLightbox.prototype=new DHTMLPopupWithMoire(void 0);
CreateLightbox.prototype.hide=function(){if(!this.permitToHideCallback||this.permitToHideCallback())DHTMLPopupWithMoire.prototype.hide.call(this,arguments),this.afterHideHandler()};function createLightbox(a,b,c){a=new CreateLightbox(a,formatId(a,"closeLightbox"));b&&a.setAfterHideHandler(b);c&&a.setPermitToHideCallback(c);a.show();return a};function SendNotificationsNowButtonStatesController(a,b,c){this.button=a;this.message=b;this.states={sending:{buttonDisabled:!0,msg:messageResource.getMessage("mail_notifications.form.send_now.progress_message"),msgClass:"sendingTestMail"},success:{buttonDisabled:void 0,msg:c,msgClass:"successmsg"},error:{buttonDisabled:void 0,msg:messageResource.getMessage("mail_notifications.form.send_now.error_message"),msgClass:"errormsg"},timeout:{buttonDisabled:void 0,msg:messageResource.getMessage("mail_notifications.form.send_now.timeout_message"),
msgClass:"errormsg"}}}SendNotificationsNowButtonStatesController.prototype.getStates=function(){return this.states};SendNotificationsNowButtonStatesController.prototype.setState=function(a){this.button.disabled=a.buttonDisabled;this.message.innerHTML=a.msg;this.message.className=a.msgClass};function ExitConfirmation(){}ExitConfirmation.isConfirmationOnUnloadRequired=!0;ExitConfirmation.setUpBaseExitConfirmation=function(a,b,c){ExitConfirmationHandlersManager.setUpExitConfirmation(messageResource.getMessage(a),function(){return ExitConfirmation.isConfirmationOnUnloadRequired&&changesDetected()},b,c);setDiscardHandler(function(){ExitConfirmation.disableConfirmationOnUnloadPage();window.location.href=getRedirectUrl()})};
ExitConfirmation.disableConfirmationOnUnloadPage=function(){ExitConfirmation.isConfirmationOnUnloadRequired=!1};function TextAreaLengthNote(a,b,c){this.divId=a;this.maxValue=c;this.descLengthSpanName=a+"Value";var d=document.getElementById(a+"Entity");d&&(d.firstChild.nodeValue=b);if(d=document.getElementById(a+"Max"))d.firstChild.nodeValue=c;this.textLengthCounter=this.trimCounter}
TextAreaLengthNote.prototype.update=function(a){this.textLength=this.countLength(a);if(a=document.getElementById(this.descLengthSpanName))a.firstChild.nodeValue=this.textLength,this.textLength>this.maxValue?(a.style.color="red",this.textLengthValid=!1):(a.style.color="",this.textLengthValid=!0)};TextAreaLengthNote.prototype.isTextLengthValid=function(){return!0===this.textLengthValid};TextAreaLengthNote.prototype.getTextLength=function(){return this.textLength};
TextAreaLengthNote.prototype.show=function(){document.getElementById(this.divId).style.display="block"};TextAreaLengthNote.prototype.hide=function(){document.getElementById(this.divId).style.display="none"};TextAreaLengthNote.prototype.countLength=function(a){return this.textLengthCounter(a)};TextAreaLengthNote.prototype.trimCounter=function(a){return trim(getStringWithUnifiedNewLineSymbol(a)).length};TextAreaLengthNote.prototype.fullCounter=function(a){return a.length};
TextAreaLengthNote.prototype.setTextLengthCounter=function(a){this.textLengthCounter=a};function SendTestMailManager(a,b,c,d,e,f,g,h,k,l,m,n,q,r){RpcControlManager.call(this);this.hostName=a;this.portName=b;this.isEncryptionEnabled=c;this.encryptionType=d;this.isAuthenticationEnabled=e;this.username=f;this.password=g;this.from=h;this.prefix=k;this.url=l;this.footer=m;this.states=n;this.statesManager=q;this.isOnline=r}SendTestMailManager.prototype=new RpcControlManager;SendTestMailManager.prototype.getService=function(){return jsonrpc.SendTestMailService};
SendTestMailManager.prototype.getMethods=function(){return["SendTestMailService.sendTestMessage","SendTestMailService.sendTestMessageInOnline"]};
SendTestMailManager.prototype.handleSpecificError=function(a){if(a){var b="javax.mail.SendFailedException"==a.exceptionClass?". "+messageResource.getMessage(this.isOnline?"general_settings.edit.mail.send_test_message.email_error_message_online":"general_settings.edit.mail.send_test_message.email_error_message"):"";this.setState(this.states.error,a.email,a.message,b);return!0}return!1};SendTestMailManager.prototype.getTimeoutMsg=function(){return messageResource.getMessage("general_settings.edit.mail.send_test_message.timeout")};
SendTestMailManager.prototype.makeRemoteCall=function(a){return this.isOnline?this.getService().sendTestMessageInOnline(a,this.prefix,this.footer):this.getService().sendTestMessage(a,this.hostName,this.portName,this.isEncryptionEnabled,this.encryptionType,this.isAuthenticationEnabled,this.username,this.password,this.from,this.prefix,this.url,this.footer)};SendTestMailManager.prototype.beginSavingData=function(){this.setState(this.states.sending)};
SendTestMailManager.prototype.endSavingData=function(a){a||this.setState(this.states.cancel)};SendTestMailManager.prototype.onDataSavingComplete=function(a){a.success?this.setState(this.states.success,a.sentTo):this.setState(this.states.error,a.sentTo)};SendTestMailManager.prototype.setState=function(a,b,c,d){this.statesManager.setState(a,b,c,d)};function SendTestMessageButtonStatesController(a,b,c,d,e,f){this.button=a;this.icon=b;this.note=c;this.userEmail=d;this.states={sending:{inputsDisabled:!0,iconUrl:atImgPath("sending-progress.gif"),msgId:"general_settings.edit.mail.send_test_message.sending_message",msgClass:"sendingTestMail"},success:{inputsDisabled:void 0,iconUrl:atImgPath("success.gif"),msgId:"general_settings.edit.mail.send_test_message.success_message",msgClass:"successmsg"},error:{inputsDisabled:void 0,iconUrl:atImgPath("error.gif"),
msgId:"general_settings.edit.mail.send_test_message.error_message",msgClass:"errormsg"},cancel:{inputsDisabled:void 0,iconUrl:f,msgId:"general_settings.edit.mail.send_test_message.note",msgClass:"notemsg"}};this.enableOrDisableSendTestMessageButton=e?e:function(){}}SendTestMessageButtonStatesController.prototype.getStates=function(){return this.states};
SendTestMessageButtonStatesController.prototype.setState=function(a,b,c,d){this.setButtonDisabled(a.inputsDisabled);this.icon.src=a.iconUrl;this.note.innerHTML=c||d?this.getStateMessage(a,[b?b:this.userEmail])+(c&&isNotEmpty(c)?': "'+c+'"':"")+(d?d:""):this.getStateMessage(a,[b?b:this.userEmail]);this.note.className=a.msgClass};SendTestMessageButtonStatesController.prototype.setButtonDisabled=function(a){(this.button.disabled=a)||this.enableOrDisableSendTestMessageButton()};
SendTestMessageButtonStatesController.prototype.getStateMessage=function(a,b){return messageResource.getMessage(a.msgId,b)};function PagerView(a){TemplateView.call(this,a)}
PagerView.prototype=_.create(TemplateView.prototype,{html:"<div id='<%=pagerPanelId%>' style='white-space: nowrap; margin-right: 25px;'>     <span id='<%=prefix%>totalRecordsPlaceholder' style='font-weight: bold;'></span>     <%=shownByLabel%>     <select name='recordsPerPage' id='<%=prefix%>recordsPerPageSelector'>     <% _.each(pagesSet, function(pageAmount) { %>          <option value='<%=pageAmount%>'><%=pageAmount%></option>     <% }); %>     </select>     <%=aPage%>     <div class='pager' id='<%=prefix%>pager' style='display: inline-block; margin-left: 10px;'></div>     <div id='<%=prefix%>spinnerPlaceholderPager'></div></div>",messageKeys:function(){return{shownByLabel:"common.records_shown_by",
aPage:"common.a_page"}}});function ViewStateSwitcher(a,b){this.config=_.defaults(b,{index:0,hideAnimatedClass:"anim-fade-out",showAnimatedClass:"anim-fade-in"});this.container=a;this.divs=a.children();this.index=this.config.index;for(var c=0;c<this.divs.length;c++){var d=this.divs.eq(c);c==this.index?d.show():d.hide()}}ViewStateSwitcher.prototype=_.create(Object.prototype,{switchState:function(a){}});function QueueViewStateSwitcher(a,b,c){ViewStateSwitcher.call(this,a,b,c);this.queue=[]}
QueueViewStateSwitcher.prototype=_.create(ViewStateSwitcher.prototype,{switchState:function(a){this.queue.push(a);1==this.queue.length&&this.processQueue()},processQueue:function(){if(0!=this.queue.length){var a=this.divs.eq(this.index),b=this.queue[0];if(this.index!=b){var c=this.divs.eq(b),d=this;a.atAnimation().hideAnimated(this.config.hideAnimatedClass);c.atAnimation().showAnimated(this.config.showAnimatedClass,function(){d.queue=d.queue.slice(1);0<d.queue.length&&d.processQueue()});this.index=
b}}}});function BaseIntegrationSection(){}BaseIntegrationSection.baseSpinnerOptions={lines:100,length:3,width:2,corners:1,rotate:0,direction:-1,color:"#9ac050",speed:1,trail:50,hwaccel:!1,className:"spinner",zIndex:2E9,shadow:!1};BaseIntegrationSection.createAccountSpinnerOptions=$.extend({},BaseIntegrationSection.baseSpinnerOptions,{radius:11,top:"50px",left:"auto"});BaseIntegrationSection.additionalRequestSpinnerOptions=$.extend({},BaseIntegrationSection.baseSpinnerOptions,{radius:6,top:"17px",left:"10px"});
BaseIntegrationSection.prototype.init=function(a,b){this._sectionId=a;this._sectionEl=$("#"+this._sectionId);this._state=IntegrationStates.ACCOUNT_DOES_NOT_EXIST;b&&(this.setState(b.integrationState),this.setProductUrl(b.productUrl),this.setContextName(b.contextName),b.firstLicenseStartDate&&this.setLicenceDates(b.firstLicenseStartDate,b.lastLicenseExpirationDate))};
BaseIntegrationSection.prototype.setContextName=function(a){this._sectionEl.find(".contextName").html(a);this._sectionEl.find(".trialUrl").attr("href",this._productUrl+a)};
BaseIntegrationSection.prototype.setLicenceDates=function(a,b){a=Date.parseJSONDate(a);b=Date.parseJSONDate(b);var c=new DateFormat("MMM, yyyy"),d="<span>"+c.formatDate(a)+"</span>",c="<span>"+c.formatDate(b)+"</span>";this._sectionEl.find(".productRestore .descriptionText").html(messageResource.getMessage("integration.restore.description",[d,c]))};BaseIntegrationSection.prototype.setProductUrl=function(a){this._productUrl=removeContextFromProductUrl(a);this._sectionEl.find(".productUrl").html(this._productUrl)};
BaseIntegrationSection.prototype.setState=function(a){this._sectionEl.find(".integrationState").hide();this._sectionEl.removeClass(this._state);this._runnerSpinner&&this._runnerSpinner.stop();this._runnerSpinner=void 0;this._state=a;this._sectionEl.addClass(a);switch(a){case IntegrationStates.ACCOUNT_DOES_NOT_EXIST:this._sectionEl.find(".accountDoesNotExist").show();this.includeAbilityToIntegrate();break;case IntegrationStates.ACCOUNT_ACTIVE:this._sectionEl.find(".accountActive").show();break;case IntegrationStates.ACCOUNT_EXPIRED:this._sectionEl.find(".accountExpired").show();
break;case IntegrationStates.ACCOUNT_CREATING:this.accountCreatingBlock=this._getIntegrationStateBlock("accountCreating");this.accountCreatingBlock.show();this.runSpinner(BaseIntegrationSection.createAccountSpinnerOptions,this.accountCreatingBlock.find(".spinnerPlaceholder")[0]);break;case IntegrationStates.ACCOUNT_ERROR:this._sectionEl.find(".accountError").show();break;case IntegrationStates.ACCOUNT_REQUEST_DISABLE:this._sectionEl.find(".requestDisable").show();break;case IntegrationStates.ACCOUNT_CONFIRM_DISABLE:this._sectionEl.find(".confirmDisable").show();
break;case IntegrationStates.ACCOUNT_DISABLING:this._sectionEl.find(".accountDisabling").show();this.runSpinner(BaseIntegrationSection.createAccountSpinnerOptions,this._sectionEl.find(".accountDisabling").find(".spinnerPlaceholder")[0]);break;case IntegrationStates.PRODUCT_DISABLED:this._sectionEl.find(".productDisabled").show();break;case IntegrationStates.PRODUCT_RESTORE:this._sectionEl.find(".productRestore").show();break;case IntegrationStates.PREPARING_PRODUCT:this._sectionEl.find(".preparingProduct").show();
this.runSpinner(BaseIntegrationSection.createAccountSpinnerOptions,this._sectionEl.find(".preparingProduct").find(".spinnerPlaceholder")[0]);break;case IntegrationStates.REFRESH_PRODUCT_INFO:this._sectionEl.find(".refreshProductInfo").show();break;case IntegrationStates.PRODUCT_CLEAN:this._sectionEl.find(".productRestore").show();this.runSpinner(BaseIntegrationSection.additionalRequestSpinnerOptions,this._sectionEl.find(".productRestore").find(".spinnerPlaceholder")[0]);break;case IntegrationStates.INTEGRATION_REQUESTS_IN_PAST_NOT_APPROVE:this._sectionEl.find(".integrationApproveRequest").show();
this.runSpinner(BaseIntegrationSection.additionalRequestSpinnerOptions,this._sectionEl.find(".integrationApproveRequest").find(".spinnerPlaceholder")[0]);break;default:this.setCustomChangeState(a)}this.changeStateCallback&&this.changeStateCallback()};BaseIntegrationSection.prototype.runSpinner=function(a,b){this._runnerSpinner=new Spinner(a);this._runnerSpinner.spin(b)};BaseIntegrationSection.prototype.setCustomChangeState=function(a){};
BaseIntegrationSection.prototype.includeAbilityToIntegrate=function(){this._integrationAbilityEnabled=!0};BaseIntegrationSection.prototype.turnOffAbilityToIntegrate=function(){this._integrationAbilityEnabled=!1};BaseIntegrationSection.prototype.isCanIntegrate=function(){return this._canIntegrate&&this._integrationAbilityEnabled};BaseIntegrationSection.prototype.abortAllRequests=function(){null!=this._integrationRequestObject&&this._integrationRequestObject.abort()};
BaseIntegrationSection.prototype._integrationRpcErrorHandler=function(a,b,c){this.setState(IntegrationStates.ACCOUNT_DOES_NOT_EXIST);if("com.actimind.common.util.PWSCommunicationException"==c.exception)return alert(IntegrationPopupErrorMessages.COMMUNICATION_ERROR),!0};BaseIntegrationSection.prototype._setErrorMessage=function(a){this._sectionEl.find(".integrationError").html(a)};
BaseIntegrationSection.prototype._setCanIntegrate=function(a){(this._canIntegrate=a)?(this._sectionEl.addClass("hasRightsForIntegration"),this.includeAbilityToIntegrate()):(this._sectionEl.addClass("noRightsForIntegration"),this.turnOffAbilityToIntegrate())};BaseIntegrationSection.prototype._setCanDisable=function(a){(this._canDisable=a)?this._sectionEl.addClass("hasRightsForDisable"):this._sectionEl.addClass("noRightsForDisable")};
BaseIntegrationSection.prototype._getIntegrationStateBlock=function(a){return this._sectionEl.find("."+a)};BaseIntegrationSection.prototype.addClass=function(a){this._sectionEl.addClass(a)};BaseIntegrationSection.prototype.removeClass=function(a){this._sectionEl.removeClass(a)};BaseIntegrationSection.prototype.getState=function(){return this._state};BaseIntegrationSection.prototype.setChangeStateCallback=function(a){this.changeStateCallback=a};function IndependentTrialSection(){}IndependentTrialSection.prototype=_.create(BaseIntegrationSection.prototype);
IndependentTrialSection.prototype.init=function(a,b,c){BaseIntegrationSection.prototype.init.call(this,a,b);var d=this;this._getIntegrationStateBlock("accountDoesNotExist").on("click",function(){d.isCanIntegrate()&&d.setState(IntegrationStates.ACCOUNT_INSERT_NAME)});if(b)return this._contextNameErrorEl=$(".contextNameError"),this._contextNameInput=this._getIntegrationStateBlock("nameAccountContext").find("#contextNameInput"),this._contextNameInput.val(b.contextName),this._contextNameInput.off().keyup(function(){this.prevValue&&
this.prevValue===this.value||(d._hideError(),d.setContextNameValid(!0),this.prevValue=this.value,d._abortCheckContextNameRequest(),d._validateContextName()&&(d._checkContextNameDelayTimer=setTimeout(function(){d._checkContextName();d._checkContextNameDelayTimer=null},200)))}),this._setCanIntegrate(!0),this.setContextNameValid(!0),this;this.setState(IntegrationStates.ACCOUNT_ERROR)};IndependentTrialSection.prototype._hideError=function(){this.removeClass("error")};
IndependentTrialSection.prototype.setContextNameValid=function(a){this._isContextNameValid=a};IndependentTrialSection.prototype.isContextNameValid=function(){return this._isContextNameValid};IndependentTrialSection.prototype._showContextNameError=function(a){this.addClass("error");this._contextNameErrorEl.html(a);this.setContextNameValid(!1)};
IndependentTrialSection.prototype._validateContextName=function(){""==this._contextNameInput.val()&&this._showContextNameError(IntegrationPopupErrorMessages.EMPTY_CONTEXT_NAME);return this.isContextNameValid()};IndependentTrialSection.prototype.setCustomChangeState=function(a){switch(a){case IntegrationStates.ACCOUNT_INSERT_NAME:this.initAndShowAccountInputNameBlock()}};
IndependentTrialSection.prototype.initAndShowAccountInputNameBlock=function(){this._stateBlockElement=this._getIntegrationStateBlock("nameAccountContext");this._stateBlockElement.find(".cancelButton").off().on("click",_.bind(this.setState,this,IntegrationStates.ACCOUNT_DOES_NOT_EXIST));this._stateBlockElement.find(".applyButton").off().on("click",_.bind(this._startIndependentTrial,this));this._stateBlockElement.show()};
IndependentTrialSection.prototype._startIndependentTrial=function(){var a=this;if(this.isCanIntegrate()&&this._validateContextName()){this._abortCheckContextNameRequest();var b=this._contextNameInput.val();this.setState(IntegrationStates.ACCOUNT_CREATING);this._integrationRequestObject=makeRpcCall("IntegrationService.startIndependentTrial",[b],function(){a.setState(IntegrationStates.ACCOUNT_ACTIVE);a.setContextName(b)},function(b,d,e){return a._integrationRpcErrorHandler(b,d,e)},null,IntegrationPopup.JQUERY_RPC_TIMEOUT)}else this._integrationAbilityEnabled&&
this._blinkError()};
IndependentTrialSection.prototype._integrationRpcErrorHandler=function(a,b,c){return"com.actimind.common.integration.ContextNameExistsException"==c.exception?(this.setState(IntegrationStates.ACCOUNT_INSERT_NAME),this._showContextNameError(IntegrationPopupErrorMessages.CONTEXT_NAME_EXISTS),!0):"com.actimind.common.integration.MalformedContextNameException"==c.exception?(this.setState(IntegrationStates.ACCOUNT_INSERT_NAME),this._showContextNameError(IntegrationPopupErrorMessages.WRONG_CONTEXT_NAME_FORMAT),!0):
"com.actimind.common.integration.UserAlreadyHasIntegratedTrialException"==c.exception||"com.actimind.common.integration.UserAlreadyHasIntegratedTrialException"==c.exception?(this.setContextName(c.contextName),this.setState(IntegrationStates.ACCOUNT_ACTIVE),alert(IntegrationPopupErrorMessages.USER_ALREADY_HAS_TRIAL),!0):BaseIntegrationSection.prototype._integrationRpcErrorHandler.call(this,a,b,c)};
IndependentTrialSection.prototype._abortCheckContextNameRequest=function(){null!=this._checkContextNameDelayTimer&&(clearTimeout(this._checkContextNameDelayTimer),this._checkContextNameDelayTimer=null);null!=this._checkContextNameRequestObject&&this._checkContextNameRequestObject.abort()};
IndependentTrialSection.prototype._checkContextName=function(){if(this.isCanIntegrate()){var a=this,b=this._contextNameInput.val();this._abortCheckContextNameRequest();this._checkContextNameRequestObject=makeRpcCall("IntegrationService.checkContextNameExists",[b],function(b){b&&a._showContextNameError(IntegrationPopupErrorMessages.CONTEXT_NAME_EXISTS)},function(b,d,e){"com.actimind.common.integration.MalformedContextNameException"==e.exception&&a._showContextNameError(IntegrationPopupErrorMessages.WRONG_CONTEXT_NAME_FORMAT);
return!0},null,IntegrationPopup.JQUERY_RPC_TIMEOUT)}};IndependentTrialSection.prototype.setState=function(a){a==IntegrationStates.ACCOUNT_EXPIRED&&(a=IntegrationStates.ACCOUNT_ACTIVE);BaseIntegrationSection.prototype.setState.call(this,a)};IndependentTrialSection.prototype.abortAllRequests=function(){BaseIntegrationSection.prototype.abortAllRequests.call(this);this._abortCheckContextNameRequest()};
IndependentTrialSection.prototype._blinkError=function(){this._sectionEl.removeClass("error");var a=this;window.setTimeout(function(){a._sectionEl.addClass("error")},250)};function IntegrationSection(){}IntegrationSection.prototype=_.create(BaseIntegrationSection.prototype);
IntegrationSection.prototype.init=function(a,b,c,d,e,f,g){BaseIntegrationSection.prototype.init.call(this,a,b);var h=this;this.accountDoesNotExitsBlock=this._getIntegrationStateBlock("accountDoesNotExist");this.accountDoesNotExitsBlock.click(_.bind(this._integrateProduct,this,[]));this._renewButton=this._getIntegrationStateBlock("accountExpired").find("#renewButton");this.$enableButton=this._sectionEl.find(".enableButton");this.$enableButton.click(_.bind(this._checkClean,this,[]));this._sectionEl.find(".accountExpired .disableButton").click(_.bind(function(){this.setState(IntegrationStates.ACCOUNT_REQUEST_DISABLE)},
this,[]));this._sectionEl.find(".requestDisable .cancelButton").click(_.bind(function(){this.setState(IntegrationStates.ACCOUNT_EXPIRED);this._setExpiredClass()},this,[]));this._sectionEl.find(".requestDisable .conformButton").click(_.bind(function(){this._shouldBecomeLicenseManager?this.setState(IntegrationStates.ACCOUNT_CONFIRM_DISABLE):this._disableProduct()},this,[]));this._sectionEl.find(".confirmDisable .conformButton").click(_.bind(this._disableProduct,this,[]));this._sectionEl.find(".confirmDisable .cancel").click(_.bind(function(){this.setState(IntegrationStates.ACCOUNT_EXPIRED)},
this,[]));this.disabledConfirmButton=!0;this.$submitClearDataButton=this._sectionEl.find(".productRestore .applyButton");this._sectionEl.find(".productRestore").find("input[type='radio'][name='restoreOperation']").change(function(){h.disabledConfirmButton=!1;h.$submitClearDataButton.removeClass("disabled")});var k=(new TableTooltip).init("deleteInfoTooltip");a=this._sectionEl.find(".productRestore .infoIcon");a.hover(function(a){k.show();k.move(calculateTooltipOffset(k,a))},function(){k.hide()});
a.mousemove(function(a){k.move(calculateTooltipOffset(k,a))});this._sectionEl.find(".productRestore .cancelButton").click(_.bind(function(){this.setState(IntegrationStates.PRODUCT_DISABLED)},this,[]));this.$submitClearDataButton.click(_.bind(function(){this.disabledConfirmButton||(this.cleanProduct=this._getOperationForRestoreProduct(),this._checkPastLeaves())},this,[]));this.$submitIntegratePastLeaves=this._sectionEl.find(".integrationApproveRequest .applyButton");this.$submitIntegratePastLeaves.click(_.bind(function(){this.pastLeavesType=
this._getOperationForIntegrationPastRequests();this._enableProduct()},this,[]));this._sectionEl.find(".integrationApproveRequest .cancelButton").click(_.bind(function(){this.setState(IntegrationStates.PRODUCT_DISABLED)},this,[]));this._shouldBecomeLicenseManager=g;this._setCanIntegrate(c);this._setCanDisable(f);this._setCanRenew(d);this._setLicenseInfo(e);this._setExpiredClass();return this};
IntegrationSection.prototype._setExpiredClass=function(){_.isUndefined(this.isTrial)||(this.isTrial?this._sectionEl.addClass("purchase"):this._sectionEl.addClass("renew"))};IntegrationSection.prototype._setCanRenew=function(a){this._canRenew=a;this.addClass(this._canRenew?"withRightsForRenewal":"noRightsForRenewal")};
IntegrationSection.prototype._integrateProduct=function(a){if(this.isCanIntegrate()){var b=this;this.setState(IntegrationStates.ACCOUNT_CREATING);this._integrationRequestObject=makeRpcCall("IntegrationService.integrateProduct",a,function(){b.setState(IntegrationStates.ACCOUNT_ACTIVE)},function(a,d,e){return b._integrationRpcErrorHandler(a,d,e)},null,IntegrationPopup.JQUERY_RPC_TIMEOUT)}};
IntegrationSection.prototype._checkClean=function(){if(this._canDisable){var a=this;makeRpcCall("IntegrationService.isOtherProductEmpty",[],function(b){!1===b?a.setState(IntegrationStates.PRODUCT_CLEAN):(a.cleanProduct="CLEAR",a._checkPastLeaves())},function(b,c,d){return a._integrationRpcErrorHandler(b,c,d)},null,IntegrationPopup.JQUERY_RPC_TIMEOUT)}};
IntegrationSection.prototype._checkPastLeaves=function(){if(this._canDisable){var a=this;makeRpcCall("IntegrationService.hasUnapprovedPastLeaveRequest",[],function(b){!0===b?a.setState(IntegrationStates.INTEGRATION_REQUESTS_IN_PAST_NOT_APPROVE):(a.pastLeavesType="AUTOMATICALLY_APPROVE_PAST_LEAVES",a._enableProduct())},function(b,c,d){return a._integrationRpcErrorHandler(b,c,d)},null,IntegrationPopup.JQUERY_RPC_TIMEOUT)}};
IntegrationSection.prototype._enableProduct=function(){if(this._canDisable){var a=this;a.setState(IntegrationStates.PREPARING_PRODUCT);makeRpcCall("IntegrationService.enableProduct",[a.cleanProduct,a.pastLeavesType],function(){a.setState(IntegrationStates.REFRESH_PRODUCT_INFO);a._checkInfo()},function(b,c,d){return a._integrationRpcErrorHandler(b,c,d)},null,IntegrationPopup.JQUERY_RPC_TIMEOUT)}};IntegrationSection.prototype._getOperationForIntegrationPastRequests=function(){return this._getIntegrationStateBlock("integrationApproveRequest").find("input[type='radio'][name='integrationApproveRequest']:checked").val()};
IntegrationSection.prototype._getOperationForRestoreProduct=function(){return this._getIntegrationStateBlock("productRestore").find("input[type='radio'][name='restoreOperation']:checked").val()};IntegrationSection.prototype._setLicenseInfo=function(a){if(this._licenseRenewalData=a)this.isTrial=a.trial,this._renewButton.click(_.bind(this._purchaseLicense,this))};
IntegrationSection.prototype._checkInfo=function(){if(this._canDisable){var a=this;makeRpcCall("IntegrationService.getIntegrationStatus",[],function(b){a._setLicenseInfo(b.licenseRenewalInfo);a._setExpiredClass();a.setState(b.state)},function(b,c,d){return a._integrationRpcErrorHandler(b,c,d)},null,IntegrationPopup.JQUERY_RPC_TIMEOUT)}};
IntegrationSection.prototype._disableProduct=function(){if(this._canDisable){var a=this;this.setState(IntegrationStates.ACCOUNT_DISABLING);makeRpcCall("IntegrationService.disableOtherProduct",[],function(){a.setState(IntegrationStates.PRODUCT_DISABLED)},function(b,c,d){return a._integrationRpcErrorHandler(b,c,d)},null,IntegrationPopup.JQUERY_RPC_TIMEOUT)}};
IntegrationSection.prototype._integrationRpcErrorHandler=function(a,b,c){switch(c.exception){case "com.actimind.common.integration.NoRightsForIntegrationException":case "com.actimind.common.integration.NoRightsForDisableProductException":return this.setState(IntegrationStates.ACCOUNT_DOES_NOT_EXIST),this._setCanIntegrate(!1),alert(IntegrationPopupErrorMessages.NO_RIGHT_FOR_INTEGRATION),!0;case "com.actimind.common.integration.ContextAlreadyIntegratedException":return this.setState(IntegrationStates.ACCOUNT_ACTIVE),
!0;case "com.actimind.common.integration.ContextNotExistsException":return this.setState(IntegrationStates.ACCOUNT_ERROR),this._setErrorMessage(IntegrationPopupErrorMessages.CONTEXT_NOT_EXISTS),!0;case "com.actimind.common.integration.NewLicenseNotFoundException":case "com.actimind.common.util.PWSCommunicationException":case "com.actimind.common.integration.EnableProductException":case "java.sql.SQLException":return this.setState(IntegrationStates.ACCOUNT_ERROR),!0;default:return BaseIntegrationSection.prototype._integrationRpcErrorHandler.call(this,
a,b,c)}};IntegrationSection.prototype._purchaseLicense=function(){this._canRenew&&this._licenseRenewalData&&window.open(this._licenseRenewalData.purchaseUrl,"_blank")};function IntegrationPopup(){}IntegrationPopup.JQUERY_RPC_TIMEOUT=12E4;IntegrationPopup.prototype=_.create(DHTMLPopupWithMoire.prototype);
IntegrationPopup.prototype.init=function(a){this._popupId="integrationPopup";this._popupEl=$("#"+this._popupId);DHTMLPopupWithMoire.call(this,this._popupId);this._integrationSection=this.getNewIntegrationSection();this._independentTrialSection=new IndependentTrialSection;this._integrationSection.init("currentProductIntegration",a.integratedProductInfo,a.canIntegrate,a.canRenewLicense,a.licenseRenewalInfo,a.canDisableProduct,a.shouldBecomeLicenseManager);this._independentTrialSection.init("independentIntegration",
a.independentTrialInfo,a.hasEmail);this._closeButton=this._popupEl.find("#closeIntegrationPopupButton");this._closeButton.click(_.bind(this.hide,this));(new window.Link({text:window.messageResource.getMessage("integration.visit_for_info"),reference:window.ProductWebSiteURLs.OTHER_PRODUCT_WEB_SITE_URL})).init(this._popupEl.find("#productInfoLink"));(new window.Link({text:window.messageResource.getMessage("common.service_agreement"),reference:window.ProductWebSiteURLs.OTHER_PRODUCT_SERVICE_AGREEMENT_URL})).init(this._popupEl.find(".serviceAgreementLink"));
(new window.Link({text:window.messageResource.getMessage("common.data_processing_agreement"),reference:window.ProductWebSiteURLs.OTHER_PRODUCT_DATA_PROCESSING_AGREEMENT_URL})).init(this._popupEl.find(".dataProcessingAgreementLink"));this._integrationSection.isCanIntegrate()||this._independentTrialSection.isCanIntegrate()||this._popupEl.find(".integrationAgreement").hide();this.hideOnMouseDown=function(){return!1};this.hideOnResize=function(){return!1};return this};
IntegrationPopup.prototype.getNewIntegrationSection=function(){return new IntegrationSection};IntegrationPopup.prototype.show=function(){DHTMLPopupWithMoire.prototype.show.call(this)};IntegrationPopup.prototype.hide=function(){DHTMLPopupWithMoire.prototype.hide.call(this);this._abortAllRequests()};IntegrationPopup.prototype._abortAllRequests=function(){this._integrationSection.abortAllRequests();this._independentTrialSection.abortAllRequests()};function SupportFormMessageManager(a,b,c){this.entityName=a;this.msgContainerId=b;this.clientSideErrorsContainerId=c}
SupportFormMessageManager.prototype={hideErrorMessage:function(){document.getElementById(this.clientSideErrorsContainerId).style.visibility="hidden"},showErrorMsg:function(a){document.getElementById(this.msgContainerId).innerHTML=a;this.hideErrorMessage();var b=this;window.setTimeout(function(){var a=document.getElementById(b.clientSideErrorsContainerId);a.style.display="block";a.style.visibility="visible"},200)},showEmptyFieldMsg:function(){this.showErrorMsg(messageResource.getMessage("support.form.empty_field_error"))},
showInvalidEmailMsg:function(){this.showErrorMsg(messageResource.getMessage("support.form.ivalid_email_msg"))},showTooLongDescMsg:function(a){this.showErrorMsg(messageResource.getMessage("support.form.long_desc_error",[this.entityName,a]))},showFormSubmitErrorMsg:function(){this.showErrorMsg(messageResource.getMessage("support.form.submit_error_msg",[this.entityName,PRODUCT_NAME]))},showRedirectErrorMsg:function(){this.showErrorMsg(messageResource.getMessage("support.form.redirect_error_msg",[this.entityName,
PRODUCT_NAME]))},showVerificationErrorMsg:function(){this.showFormSubmitErrorMsg()}};function SupportFormValidator(a){this.fields=[];this.textArea=this.emailField=null;this.messageManager=a}
SupportFormValidator.prototype=_.create(Object.prototype,{maxTextAreaLength:32E3,addField:function(a){this.fields.push(a)},addEmailField:function(a){this.emailField=a;this.addField(a)},addTextArea:function(a){this.textArea=a;this.addField(a)},addErrorIndicator:function(a){$(a).addClass("error")},removeErrorIndicator:function(a){$(a).removeClass("error")},createErrorCountObject:function(a){var b={};b.value=a;b.getErrorCount=function(){return this.value};b.incrementErrorCount=function(){this.value++};
b.decrementErrorCount=function(){this.value--};return b},markErrorField:function(a,b){this.addErrorIndicator(a);var c=this.messageManager;a.valueChangeHandler=function(){b.decrementErrorCount();0>=b.getErrorCount()&&c.hideErrorMessage();SupportFormValidator.prototype.removeErrorIndicator(a);SupportFormValidator.prototype.removeValueChangeHandler(a,a.valueChangeHandler);a.valueChangeHandler=null};this.addValueChangeHandler(a,a.valueChangeHandler)},validateNotEmpty:function(){for(var a=this.createErrorCountObject(0),
b=0;b<this.fields.length;b++){var c=this.fields[b],d;c==this.textArea?(d=trim(c.value),c.value=d):(d=trim($(c).pVal()),$(c).pVal(d));""==d&&(a.incrementErrorCount(),this.markErrorField(c,a))}return 0==a.getErrorCount()},validateEmailAddress:function(){return null==this.emailField?!0:isEmailValid($(this.emailField).pVal())?!0:(this.markErrorField(this.emailField,this.createErrorCountObject(1)),!1)},validateTextLength:function(){if(null==this.textArea)throw"Description text area is not registered!";
return trim(getStringWithUnifiedNewLineSymbol(this.textArea.value)).length>this.maxTextAreaLength?(this.markErrorField(this.textArea,this.createErrorCountObject(1)),!1):!0},resetValidator:function(){this.messageManager.hideErrorMessage();for(var a=0;a<this.fields.length;a++){var b=this.fields[a];this.removeErrorIndicator(b);b.valueChangeHandler&&(this.removeValueChangeHandler(b,b.valueChangeHandler),b.valueChangeHandler=null)}},validateForm:function(){this.resetValidator();if(this.validateNotEmpty()){if(!this.validateEmailAddress())return this.messageManager.showInvalidEmailMsg(),
!1;if(!this.validateTextLength())return this.messageManager.showTooLongDescMsg(this.maxTextAreaLength),!1}else return this.messageManager.showEmptyFieldMsg(),!1;return!0},addValueChangeHandler:function(a,b){a.addEventListener?a.addEventListener("input",b,!1):a.onpropertychange=function(){"value"==window.event.propertyName&&b()}},removeValueChangeHandler:function(a,b){a.removeEventListener?a.removeEventListener("input",b,!1):a.onpropertychange=null}});function SupportPopup(){DHTMLPopupWithMoire.call(this,"contactSupportPopup")}SupportPopup.States={MAIN:0,PROGRESS:1,SUCCESS:2};
SupportPopup.prototype=_.create(DHTMLPopupWithMoire.prototype,{init:function(){this.popupEl=$("#"+this.popupId);this.closeButton=document.getElementById("supportPopupCloseButton");$(this.closeButton).click(_.bind(this.cancel,this));this.submitButton=this.getElementBySubId("submitButton");$(this.submitButton).click(_.bind(this.onSubmitButtonClick,this));this.sendAgainButton=this.getElementBySubId("sendAgain");$(this.sendAgainButton).click(_.bind(this.onSendAgainButtonClick,this));this.textArea=this.getElementBySubId("description");
this.textArea.onpaste=_.bind(this.updateTextLengthNote,this,!0);this.textArea.onblur=_.bind(this.updateTextLengthNote,this,!1);this.textArea.onkeyup=_.bind(this.updateTextLengthNote,this,!1);this.textLengthNote=new TextAreaLengthNote(this.popupId+"_descLength",messageResource.getMessage("support.report_bug.text_area_name"),32E3);this.textLengthNote.update(this.textArea.value);this.textLengthNote.show();this.messageManager=new SupportFormMessageManager(messageResource.getMessage("support.submitQuestion.entity"),
this.popupId+"_errorMsgContainer",this.popupId+"_clientSideErrorMessage");this.formValidator=new SupportFormValidator(this.messageManager);this.formValidator.addTextArea(this.textArea);this.addChangesHandler(this.textArea);CONTACT_SUPPORT_SHOW_EXTRA_FIELDS?(this.popupEl.find(".contactInformationContainer").show(),this.firstNameField=this.getElementBySubId("first_name"),this.lastNameField=this.getElementBySubId("last_name"),this.emailField=this.getElementBySubId("email"),this.companyNameField=this.getElementBySubId("company_name"),
$(this.firstNameField).placeholder(),$(this.lastNameField).placeholder(),$(this.emailField).placeholder(),$(this.companyNameField).placeholder(),this.formValidator.addField(this.firstNameField),this.formValidator.addField(this.lastNameField),this.formValidator.addEmailField(this.emailField),this.formValidator.addField(this.companyNameField),this.addChangesHandler(this.firstNameField),this.addChangesHandler(this.lastNameField),this.addChangesHandler(this.emailField),this.addChangesHandler(this.companyNameField)):
this.popupEl.find(".contactInformationContainer").hide();this.stateSwitcher=this.popupEl.find(".innerContent").queueViewStateSwitcher({index:SupportPopup.States.MAIN,hideAnimatedClass:"anim-fade-out",showAnimatedClass:"anim-fade-in"});this.uploadId=0;var a=this;this.dropzone=new Dropzone("#"+this.popupId+" .dropzone",{previewTemplate:document.querySelector(".dropzoneTemplate").innerHTML,url:UPLOAD_SUPPORT_FILE_URL,createImageThumbnails:!1,maxFiles:1,dictDefaultMessage:messageResource.getMessage("contact_support.main.dropzone_placeholder"),
dictMaxFilesExceeded:messageResource.getMessage("common.multiple_upload_error"),fallback:function(){a.popupEl.find(".dropzoneContainer").hide()},accept:function(a,c){0==a.size?c(messageResource.getMessage("contact_support.error.empty_file")):10485760<a.size?c(messageResource.getMessage("contact_support.error.large_file",[(new NumberFormatter(".","",2)).format(a.size/1024/1024),10])):c()}});this.dropzone.on("success",function(b,c){var d=!1;try{c=JSON.parse(c),d=c.error}catch(e){d=!0}if(d)a.onDropzoneError(b,
messageResource.getMessage("contact_support.error.upload"));else 0<a.uploadId&&a.rpcCancel(),a.uploadId=c.result,a.changesDetected()});this.dropzone.on("error",function(b,c){if(b.xhr){var d=b.xhr.status;0==d?c=messageResource.getMessage("contact_support.error.http_0"):400<=d&&499>=d?c=messageResource.getMessage("contact_support.error.http_4xx"):500<=d&&(c=messageResource.getMessage("contact_support.error.http_5xx"))}a.onDropzoneError(b,c)});this.dropzone.on("removedfile",function(){a.rpcCancel();
a.uploadId=0;a.dropzone.setupEventListeners()});this.dropzone.on("maxfilesreached",function(){a.dropzone.removeEventListeners()});this.dropzone.on("sending",function(){a.changesDetected()});return this},centrePopup:function(){this._height||(this._height=$(this.getElementBySubId("supportForm")).outerHeight()+80);this.popupEl.find(".content").css("height",this._height+"px");this.popupEl.find(".innerContent").css("height",this._height+"px");DHTMLPopupWithMoire.prototype.centrePopup.call(this)},show:function(){DHTMLPopupWithMoire.prototype.show.call(this,
!0);var a=this;ExitConfirmationHandlersManager.setUpExitConfirmation(messageResource.getMessage("contact_support.main.cancel_confirmation"),function(){return a.dataChanged},!1)},hide:function(){ExitConfirmationHandlersManager.restoreExitConfirmation();DHTMLPopupWithMoire.prototype.hide.call(this,!0);$(this.popupEl).empty()},cancel:function(){if(this.stateSwitcher.index!=SupportPopup.States.MAIN||!this.dataChanged||confirm(messageResource.getMessage("contact_support.main.cancel_confirmation")))if(this.stateSwitcher.index!=
SupportPopup.States.PROGRESS||confirm(messageResource.getMessage("contact_support.progress.cancel_confirmation"))){var a=this.dropzone.getUploadingFiles()[0];a&&this.dropzone.cancelUpload(a);this.rpcCancel();this.hide()}},rpcSend:function(){makeRpcCall("ContactSupportService.send",CONTACT_SUPPORT_SHOW_EXTRA_FIELDS?[this.textArea.value,this.firstNameField.value,this.lastNameField.value,this.emailField.value,this.companyNameField.value,this.uploadId]:[this.textArea.value,null,null,null,null,this.uploadId],
_.bind(this.onSubmitRpcSuccess,this),_.bind(this.onSubmitRpcError,this))},rpcCancel:function(){makeRpcCall("ContactSupportService.cancel",[this.uploadId],null,_.constant(!0))},hideOnMouseDown:_.constant(!1),hideOnResize:_.constant(!1),hideOnEscape:_.constant(!1),onEscape:function(){this.cancel()},changesDetected:function(){this.dataChanged=!0},addChangesHandler:function(a){$(a).valueChanged(_.bind(this.changesDetected,this))},wereDataChanged:function(){return this.dataChanged},updateTextLengthNote:function(a){var b=
this;a?setTimeout(function(){b.updateTextLengthNote(!1)},40):this.textLengthNote.update(this.textArea.value)},getElementBySubId:function(a){return document.getElementById(this.popupId+"_"+a)},onSubmitButtonClick:function(){this.formValidator.validateForm()&&(this.stateSwitcher.switchState(SupportPopup.States.PROGRESS),this.rpcSend())},onSubmitRpcSuccess:function(){this.stateSwitcher.switchState(SupportPopup.States.SUCCESS)},onSubmitRpcError:function(a,b,c){this.stateSwitcher.switchState(SupportPopup.States.MAIN);
"com.actimind.common.util.PWSCommunicationException"==c.exception?alert(messageResource.getMessage("contact_support.error.communication_exception")):"com.actimind.actitime.services.ContactSupportValidationException"==c.exception?alert(messageResource.getMessage("contact_support.error.validation_exception")):"com.actimind.actitime.services.UploadExpiredException"==c.exception?(alert(messageResource.getMessage("contact_support.error.upload_expired_exception")),this.dropzone.removeAllFiles()):alert(messageResource.getMessage("contact_support.error.generic"));
return!0},onSendAgainButtonClick:function(){this.textArea.value="";this.updateTextLengthNote(!1);this.textArea.prevValue=this.textArea.value;this.dataChanged=!1;this.uploadId=0;this.dropzone.removeAllFiles();this.stateSwitcher.switchState(SupportPopup.States.MAIN)},onDropzoneError:function(a,b){"canceled"!=a.status&&(alert(b),this.dropzone.removeFile(a))}});function BeigeButtonClassesController(){}BeigeButtonClassesController.prototype.init=function(a){this.$element=a;isOldIE()||this.$element.toggleClass("useNativeActive");return this};
BeigeButtonClassesController.prototype.addListenersIfNeeded=function(){isOldIE()&&(this.$element.off("mousedown.beigeButtonClassesController").on("mousedown.beigeButtonClassesController",this._getAddingActiveClassFunction()),this.$element.off("mouseup.beigeButtonClassesController").on("mouseup.beigeButtonClassesController",this._getRemovingActiveClassFunction()),this.$element.off("mouseleave.beigeButtonClassesController").on("mouseleave.beigeButtonClassesController",this._getRemovingActiveClassFunction()))};
BeigeButtonClassesController.prototype._getAddingActiveClassFunction=function(){return _.bind(function(){this.$element.addClass("active")},this)};BeigeButtonClassesController.prototype._getRemovingActiveClassFunction=function(){return _.bind(function(){this.$element.removeClass("active")},this)};HeaderTextListSelector=Ext.extend(ListSelector,{headerPropName:"headerText",createItem:function(a){return{text:a[this.textPropName],headerText:a[this.headerPropName],value:a[this.valuePropName],cls:a[this.clsPropName],origObj:a}},setItem:function(a){if(this.currentItem){if(this.currentItem==a)return!1;this.currentItem.setIconClass("")}this.currentItem=a;this.currentItem.setIconClass("selected");this.value=a.value;this.setText(a.headerText);return!0}});function LeaveTypesSelectorUtil(){}
LeaveTypesSelectorUtil.prototype.init=function(a,b,c,d){this.leaveTypes=a;this.allBalancesOff=!(b||c);this.sickLeaves=[];this.ptoLeaves=[];this.withoutBalanceLeaves=[];var e={};if(d)for(var f=0;f<d.length;f++)e[d[f]]=!0;this.showInactive=!1;for(f=0;f<a.length;f++)d=a[f],b&&d.balanceType==BalanceType.PTO?this.ptoLeaves.push(d):c&&d.balanceType==BalanceType.SICK?this.sickLeaves.push(d):this.withoutBalanceLeaves.push(d),e[d.id]&&(d.selected=!0,d.active||(this.showInactive=!0));return this};
LeaveTypesSelectorUtil.prototype._isPossibleToGroupLeaves=function(){return!this.allBalancesOff&&(0!=this.sickLeaves.length||0!=this.ptoLeaves.length||0!=this.withoutBalanceLeaves.length)};LeaveTypesSelectorUtil.prototype.getDataForSelector=function(a){if(this._isPossibleToGroupLeaves()){var b=[];b.push({label:a.ptoLabel,children:this.ptoLeaves});b.push({label:a.sickDaysLabel,children:this.sickLeaves});b.push({label:a.withoutBalancesLabel,children:this.withoutBalanceLeaves});return b}return this.withoutBalanceLeaves};
LeaveTypesSelectorUtil.prototype.setSelectorTreeConstructorToPanel=function(a){a.prototype.selectorTreeCtor=this._isPossibleToGroupLeaves()?AT.LeavesGroupingSelectorTree:AT.LeavesSelectorTree};LeaveTypesSelectorUtil.prototype.isNeedToShowInactiveLeaves=function(){return this.showInactive};function BalancesViewer(a){TemplateView.call(this,a)}
BalancesViewer.prototype=_.create(TemplateView.prototype,{html:'<div class="balancesViewer">  <div class="calendar">   <span class="calendarSpan"><%=calendarLabel%></span>   <span class="calendarPlaceholder"></span>  </div>  <span class="separator"></span>  <div class="balances">   <div class="ptoBalance">     <span class="ptoLabel"><%=ptoLabel%></span>     <span class="ptoValue"></span>   </div>   <div class="sickBalance">     <span class="sickLabel"><%=sickLabel%></span>     <span class="sickValue"></span>  </div></div></div>',updateOnInit:!1,
messageKeys:function(){return{calendarLabel:"common.balancesViewer.label",ptoLabel:"common.balancesViewer.ptoLabel",sickLabel:"common.balancesViewer.sickLabel"}},initComponents:function(a,b){this.ptoFormatter=(new PTOFormatter).init(a.hoursPerDay);this.sickFormatter=(new SickFormatter).init(a.hoursPerDay);this.displayPTOBalance=a.displayPto||!1;this.displaySickBalance=a.displaySick||!1;this.onDateChange=b;this.$calendarLabel=this.$containerEl.find(".calendarSpan");this.$calendar=this.$containerEl.find(".calendarPlaceholder");
this.$balances=this.$containerEl.find(".balances");this.$ptoValue=this.$balances.find(".ptoValue");this.$sickValue=this.$balances.find(".sickValue");this._createDateSelector(a)},update:function(a){this.displayPTOBalance=a.displayPto;this.displaySickBalance=a.displaySick;this._displayBalances(a.balances);this._updateMainClasses()},updateUserSchedule:function(a){var b=Ext.QuickTips.unregister;Ext.QuickTips.unregister=$.noop;this.dateSelector.destroy();Ext.QuickTips.unregister=b;this._createDateSelector(a)},
_createDateSelector:function(a){this.dateSelector=BalancesViewer.createDateSelector(this.$calendar[0],a.userInitialSchedule,a.userSchedules,a.userHireDate,a.userReleaseDate);if(this.onDateChange)this.dateSelector.on("change",this.onDateChange);return this.dateSelector},getDate:function(){return this.dateSelector.getValue()},setDate:function(a){this.dateSelector.setValue(a)},_displayBalances:function(a){this._displayBalance(this.$ptoValue,this.ptoFormatter,a.PTOBalance);this._displayBalance(this.$sickValue,
this.sickFormatter,a.sickBalance)},_displayBalance:function(a,b,c){var d=!_.isNull(c)&&!!b.isNegativePTO(c);a.toggleClass("negative",d);a.toggleClass("empty",_.isNull(c));a.html(b.format(c))},_updateMainClasses:function(){this.$el.toggleClass("showPTO",this.displayPTOBalance);this.$el.toggleClass("showSick",this.displaySickBalance)},isDisplayedPto:function(){return this.displayPTOBalance},isDisplayedSick:function(){return this.displaySickBalance}});
BalancesViewer.createDateSelector=function(a,b,c,d,e){var f=new Date(1970,0,1),g=void 0,h=MAX_ALLOWED_DATE_FOR_TIME_TRACK,k=void 0;d&&(f=d.parseJSONDate(),g=messageResource.getMessage("common.balancesViewer.calendar.minText"));e&&(h=e.parseJSONDate(),k=messageResource.getMessage("common.balancesViewer.calendar.maxText"));d=currentUserTime().clearTime();d>h&&(d=h);return new DateSelector({minValue:f,maxValue:h,minText:g,maxText:k,showOkCancelButtons:!1,weekStartDay:SystemSettings.weekStartDay-1,name:"dateSelector",
renderTo:a,scheduleCalculator:(new UserScheduleCalculator).init(invertedDaysDateMap,b,c),date:d,format:Date.convertSmartToExtDateFormat(SystemSettings.dateFormat.replace(/MMMM/,"MMM")),displayValue:function(a){this.setText(a?areDatesEqual(a,currentUserTime())?messageResource.getMessage("common.datepicker.today"):this.formatDate(a):messageResource.getMessage("common.date_selector.select_date"))}})};BaseBalancesViewerController=function(a){this.$containerEl=a};
BaseBalancesViewerController.prototype=_.create(Object.prototype,{init:function(){this.spinner=new SpinnerController;this.balancesViewer=this.createBalanceViewer(this.$containerEl);var a=this.getUserWorkScheduleData();if(_.isNull(a))return!1;this.userWorkScheduleData=a;this.balancesViewer.init().initComponents(this._getConfig(),this.onDateChange);return this},createBalanceViewer:function(a){},getUserWorkScheduleData:function(){},getFormatterSettings:function(){},onDateChange:function(){},_getConfig:function(){var a=
this.getUserWorkScheduleData(),b=this.getFormatterSettings();return{userHireDate:a.hireDate,userReleaseDate:a.releaseDate,userInitialSchedule:a.initialSchedule,userSchedules:a.schedules,hoursPerDay:b.workHoursPerDay}},_reInitBalanceViewer:function(a){var b=this.getUserWorkScheduleData();this.userWorkScheduleData!==b&&(this.userWorkScheduleData=b,this.balancesViewer.updateUserSchedule(a));this.balancesViewer.showInHours=a.showInHours},updateBalances:function(a,b){var c=this.getUserWorkScheduleData();
_.isNull(c)||(this._reInitBalanceViewer(this._getConfig()),_.isNull(a)||areDatesEqual(this.getViewerDate(),a)||this.balancesViewer.setDate(a),this.balancesViewer.update(b));this.spinner.stop()},getViewerDate:function(){return this.balancesViewer.getDate()},spin:function(){this.spinner.spin("balancesViewerSpinner")}});function BaseReport(){};var GroupingUtils={getGroupingLevels:function(a){return _.filter([a.firstGroupingLevel,a.secondGroupingLevel,a.thirdGroupingLevel,a.fourthGroupingLevel],function(a){return null!=a&&a!=ReportGroupingLevel.NONE})},isTimeGrouping:function(a){return a==ReportGroupingLevel.DATE||a==ReportGroupingLevel.WEEK||a==ReportGroupingLevel.MONTH},hasUserGroupingLevel:function(a){return _.contains(a,ReportGroupingLevel.USER)},searchLastGroupingTime:function(a){for(var b=ReportGroupingLevel.NONE,c=0;c<a.length;c++){var d=
a[c];GroupingUtils.isTimeGrouping(d)&&(b=d)}return b},addGroupingInfo:function(a,b,c){switch(a){case ReportGroupingLevel.USER:c["user info"]=BaseReportFormatUtils.getFormattedUser(b.firstName,b.lastName,b.middleInitial,b.username);break;case ReportGroupingLevel.USER_GROUP:c["User group"]=null!=b.name?b.name:messageResource.getMessage("reports.without_department");break;case ReportGroupingLevel.TIME_ZONE_GROUP:c["Time Zone"]=b.name;break;case ReportGroupingLevel.DATE:c.Day=ConverterFormatUtils.formatDay.formatDate(b.date.parseJSONDate());
break;case ReportGroupingLevel.WEEK:a=b.to;c.Week=ConverterFormatUtils.formatWeekBegin.formatDate(b.from.parseJSONDate())+" - "+ConverterFormatUtils.formatWeekEnd.formatDate(a.parseJSONDate());break;case ReportGroupingLevel.MONTH:c.Month=ConverterFormatUtils.formatMonth.formatDate(b.date.parseJSONDate());break;case ReportGroupingLevel.PROJECT_NAME:c["Project name"]=b.name;break;case ReportGroupingLevel.PROJECT:c.Project=b.name;break;case ReportGroupingLevel.CUSTOMER:c.Customer=b.name;break;case ReportGroupingLevel.TASK:c.Task=
b.name;break;case ReportGroupingLevel.TASK_NAME:c["Task name"]=b.name;break;case ReportGroupingLevel.BILLING_TYPE:c["Type of work"]=b.name}},addGroupingColumnName:function(a,b,c){switch(a){case ReportGroupingLevel.USER:b["user info"]="User";c.push("user info");break;case ReportGroupingLevel.USER_GROUP:b["User group"]=messageResource.getMessage("user.group");c.push("User group");break;case ReportGroupingLevel.TIME_ZONE_GROUP:b["Time Zone"]=messageResource.getMessage("common.Time_Zone_Group");c.push("Time Zone");
break;case ReportGroupingLevel.DATE:b.Day="Day";c.push("Day");break;case ReportGroupingLevel.WEEK:b.Week="Week";c.push("Week");break;case ReportGroupingLevel.MONTH:b.Month="Month";c.push("Month");break;case ReportGroupingLevel.PROJECT_NAME:b["Project name"]=messageResource.getMessage("common.Project");c.push("Project name");break;case ReportGroupingLevel.PROJECT:b.Project=messageResource.getMessage("common.Project");c.push("Project");break;case ReportGroupingLevel.CUSTOMER:b.Customer=messageResource.getMessage("common.Customer");
c.push("Customer");break;case ReportGroupingLevel.TASK:b.Task=messageResource.getMessage("common.Task");c.push("Task");break;case ReportGroupingLevel.TASK_NAME:b["Task name"]=messageResource.getMessage("common.Task");c.push("Task name");break;case ReportGroupingLevel.BILLING_TYPE:b["Type of work"]="Type of work",c.push("Type of work")}}};var ConverterFormatUtils={formatMonth:new DateFormat("MMMM yyyy"),formatDay:new DateFormat(SystemSettings.dateFormat),formatWeekBegin:new DateFormat("MMM dd"),formatWeekEnd:new DateFormat("MMM dd, yyyy"),numberFormatter:new NumberFormatter(SystemSettings.decimalSeparator,SystemSettings.digitGroupingSymbol,4,!1),varianceNumberFormatter:new NumberFormatter(SystemSettings.decimalSeparator,SystemSettings.digitGroupingSymbol,2,!1)};function BaseCSVJsonConverter(){}
BaseCSVJsonConverter.prototype={init:function(){return this},convertData:function(a,b,c,d){var e=this.groupingLevels[a];this.addGroupingInfo(e,this.getIdentity(c,e),d);if(a+1==b)this.addDataToTable(c,d),this.lines.push(_.clone(d));else for(e=0;e<c.items.length;++e)this.convertData(a+1,b,c.items[e],d)},convertLinearData:function(a,b,c){var d={},e;for(e=0;e<b;e++){var f=this.groupingLevels[e];e==a&&this.addGroupingInfo(f,this.getIdentity(c,f),d)}this.addDataToTable(c,d);this.lines.push(d);if(a+1!=b)for(e=
0;e<c.items.length;++e)this.convertLinearData(a+1,b,c.items[e])},generateTableHeader:function(a,b,c,d){for(var e=0;e<this.groupingLevels.length;++e)GroupingUtils.addGroupingColumnName(this.groupingLevels[e],c,d);this.addOtherColumnNames(c,d,b,a)},convertTable:function(a,b){this.groupingLevels=GroupingUtils.getGroupingLevels(a);this.preprocess(a,b);var c={},d=[];this.generateTableHeader(b,a,c,d);this.lines=[];for(var e=0;e<b.items.length;++e)this.convertData(0,this.groupingLevels.length,b.items[e],
{});return{columnNames:c,columns:d,table:this.lines}},convertLinearTable:function(a,b){this.groupingLevels=GroupingUtils.getGroupingLevels(a);this.preprocess(a,b);var c={},d=[];this.generateTableHeader(b,a,c,d);this.lines=[];for(var e=0;e<b.items.length;++e)this.convertLinearData(0,this.groupingLevels.length,b.items[e]);return{columnNames:c,columns:d,table:this.lines}},addGroupingInfo:function(a,b,c){},getIdentity:function(a,b){},addDataToTable:function(a,b){},addOtherColumnNames:function(a,b,c,d){},
preprocess:function(a,b){},convertTitle:function(a,b){var c=(new CSVParametersBuilder).init();this.processParamsBuilder(c,a,b);for(var c=c.getParameters(),d=[],e=0;e<c.length;++e)d.push({title:c[e][0],description:c[e][1]});d.push({title:"",description:""});return{columns:["title","description"],table:d}},processParamsBuilder:function(a,b,c){},getJsons:function(a,b){}};function LeaveCSVJsonConverter(){}
LeaveCSVJsonConverter.prototype=_.create(BaseCSVJsonConverter.prototype,{init:function(a){BaseCSVJsonConverter.prototype.init.call(this);this.store=a.store;this.usersMap=a.store.getUsers();this.usersGroupsMap=a.store.getUserGroups();this.timeZoneGroupsMap=a.store.getTimeZoneGroups();this.defaultWorkDayDuration=a.defaultWorkDayDuration/60;this.reportParamsStringBuilderConstructor=a.reportParamsStringBuilderConstructor;this.manageableUserIds=a.manageableUserIds;this.projectsWithMaIds=a.projectsWithMaIds;
this.reportAuthorizationInfo=a.reportAuthorizationInfo;return this},addOtherColumnNames:function(a,b,c,d){this.showLeaveTime&&this.addLeaveTimeNames(a,b,d.leaveSpent);this.showBalances&&this.addBalancesNames(a,b)},addLeaveTimeNames:function(a,b,c){b.push("Total");a.Total=messageResource.getMessage("report.leaves.total.html_csv");for(var d=0;d<c.length;++d){var e=this.getLeaveTypeColumnName(c[d]);a[e]=LeaveTypeStore.getLeaveType(c[d].leaveTypeId).name;b.push(e)}},getIdentity:function(a,b){switch(b){case ReportGroupingLevel.USER:return this.usersMap[a.id];
case ReportGroupingLevel.USER_GROUP:return this.usersGroupsMap[a.id];case ReportGroupingLevel.TIME_ZONE_GROUP:return this.timeZoneGroupsMap[a.id];case ReportGroupingLevel.DATE:return this.store.getDateInfo([a.id]);case ReportGroupingLevel.WEEK:return this.store.getWeek([a.id]);case ReportGroupingLevel.MONTH:return this.store.getMonth([a.id])}},addBalancesNames:function(a,b){if(this.pto){var c=messageResource.getMessage("report.leaves.balance_column_name.pto");b.push("PTO begin");a["PTO begin"]=c+
this.balanceColumnNameBegin(SystemSettings.showPTOInHours);b.push("PTO end");a["PTO end"]=c+this.balanceColumnNameEnd(SystemSettings.showPTOInHours)}this.sick&&(c=messageResource.getMessage("report.leaves.balance_column_name.sick_days"),b.push("Sick begin"),a["Sick begin"]=c+this.balanceColumnNameBegin(SystemSettings.showSickInHours),b.push("Sick end"),a["Sick end"]=c+this.balanceColumnNameEnd(SystemSettings.showSickInHours))},getLeaveTypeColumnName:function(a){return"leaveType"+a.leaveTypeId.toString()},
balanceColumnNameBegin:function(a){var b=GroupingUtils.searchLastGroupingTime(this.groupingLevels),c="",d=this.dateRange;switch(b){case ReportGroupingLevel.NONE:c=" "+ConverterFormatUtils.formatDay.formatDate(d.fromDate);break;case ReportGroupingLevel.DATE:c=" "+messageResource.getMessage("report.leaves.first_balance_subcolumn.dates");break;case ReportGroupingLevel.WEEK:c=" "+messageResource.getMessage("report.leaves.first_balance_subcolumn.weeks");break;case ReportGroupingLevel.MONTH:c=" "+messageResource.getMessage("report.leaves.first_balance_subcolumn.months")}return c+=
" ("+messageResource.getMessage(a?"common.pto_units.hours":"common.pto_units.days")+")"},balanceColumnNameEnd:function(a){var b=GroupingUtils.searchLastGroupingTime(this.groupingLevels),c="",d=this.dateRange;switch(b){case ReportGroupingLevel.NONE:c=" "+ConverterFormatUtils.formatDay.formatDate(d.toDate);break;case ReportGroupingLevel.DATE:c=" "+messageResource.getMessage("report.leaves.second_balance_subcolumn.dates");break;case ReportGroupingLevel.WEEK:c=" "+messageResource.getMessage("report.leaves.second_balance_subcolumn.weeks");
break;case ReportGroupingLevel.MONTH:c=" "+messageResource.getMessage("report.leaves.second_balance_subcolumn.months")}return c+=" ("+messageResource.getMessage(a?"common.pto_units.hours":"common.pto_units.days")+")"},formatLeaveTime:function(a){return ConverterFormatUtils.numberFormatter.format(a/60)},addLeaveTimeToTable:function(a,b){b.Total=this.formatLeaveTime(a.totalLeaveSpent);for(var c=a.leaveSpent,d=0;d<c.length;++d){var e=this.getLeaveTypeColumnName(c[d]);b[e]=this.formatLeaveTime(c[d].leaveSpent)}},
addBalancesToTable:function(a,b){var c=SystemSettings.showSickInHours?this.defaultWorkDayDuration:1,d=SystemSettings.showPTOInHours?this.defaultWorkDayDuration:1;if(this.pto){var e=a.ptoBalance;b["PTO begin"]=null!=e&&null!=e.balanceForFirstColumn?ConverterFormatUtils.numberFormatter.format(e.balanceForFirstColumn*d):"";b["PTO end"]=null!=e&&null!=e.balanceForSecondColumn?ConverterFormatUtils.numberFormatter.format(e.balanceForSecondColumn*d):""}this.sick&&(d=a.sickBalance,b["Sick begin"]=null!=d&&
null!=d.balanceForFirstColumn?ConverterFormatUtils.numberFormatter.format(d.balanceForFirstColumn*c):"",b["Sick end"]=null!=d&&null!=d.balanceForSecondColumn?ConverterFormatUtils.numberFormatter.format(d.balanceForSecondColumn*c):"")},addDataToTable:function(a,b){this.showLeaveTime&&this.addLeaveTimeToTable(a,b);this.showBalances&&this.addBalancesToTable(a,b)},preprocess:function(a,b){this.dateRange=a.dateRangeSelection;this.showBalances=a.columnsConfig==LeaveTypeColumnConfig.LEAVE_TIME_AND_BALANCES||
a.columnsConfig==LeaveTypeColumnConfig.BALANCES_ONLY;this.showLeaveTime=a.columnsConfig==LeaveTypeColumnConfig.LEAVE_TIME_AND_BALANCES||a.columnsConfig==LeaveTypeColumnConfig.LEAVE_TIME_ONLY;this.pto=a.balanceQualifier==LeaveTypeBalanceQualifier.PTO_AND_SICK_DAYS||a.balanceQualifier==LeaveTypeBalanceQualifier.PTO_ONLY;this.sick=a.balanceQualifier==LeaveTypeBalanceQualifier.PTO_AND_SICK_DAYS||a.balanceQualifier==LeaveTypeBalanceQualifier.SICK_DAYS_ONLY},addGroupingInfo:function(a,b,c){GroupingUtils.addGroupingInfo(a,
b,c)},processParamsBuilder:function(a,b,c){c=new this.reportParamsStringBuilderConstructor({data:{users:_.values(this.usersMap),userGroupsFeatureEnabled:c.userGroupFeature,tzGroupsFeatureEnabled:c.tzGroupFeature,userGroups:_.values(this.usersGroupsMap),timeZoneGroups:_.values(this.timeZoneGroupsMap),leaveTypesMap:LeaveTypeStore.getLeaveTypes(),manageableUserIds:this.manageableUserIds,projectsWithMaIds:this.projectsWithMaIds},reportAuthorizationInfo:this.reportAuthorizationInfo});a.addDateRangeParam(b.dateRangeSelection,
c);a.addUsersParam(b.userSelection,c,{isShowOnlyAssigned:b.isShowOnlyAssigned,viewerInfo:b.viewerInfo});a.addLeavesParam(b.leaveTypeSelection,c)},generateCSVName:function(a,b,c){var d="";c&&(d=b.isPTOEnabled()&&b.isSickEnabled()?messageResource.getMessage("common.leave.reports.csv.file_name.balances"):b.isPTOEnabled()?messageResource.getMessage("common.leave.reports.csv.file_name.pto"):b.isSickEnabled()?messageResource.getMessage("common.leave.reports.csv.file_name.sick"):messageResource.getMessage("common.leave.reports.csv.file_name.no_balances"));
b=[];c=new DateFormat(SystemSettings.dateFormat);b.push(d);b.push(c.formatDate(a.dateRangeSelection.fromDate));b.push(c.formatDate(a.dateRangeSelection.toDate));a=messageResource.getMessage("common.leave.reports.csv.file_name",b);isOldIE()&&(a=a.replace(/\//g,"_"));return a},convertTitle:function(a,b,c){return BaseCSVJsonConverter.prototype.convertTitle.call(this,a,{userGroupFeature:b,tzGroupFeature:c})},getJsons:function(a,b){return[this.convertTitle(a),this.convertTable(a,b)]}});var LeaveTypeUtil={validateLeaveType:function(a){return null!==a&&0<a.leaveTypeId&&_.isUndefined(LeaveTypeStore.getLeaveType(a.leaveTypeId))?(window.location.reload(),!1):!0},validateLeaveTypeById:function(a){return 0<a&&_.isUndefined(LeaveTypeStore.getLeaveType(a))?(window.location.reload(),!1):!0}};function LightboxTemplateView(a,b,c){TemplateView.call(this,a);this.lightboxId=b;this.additionalClasses=c}
LightboxTemplateView.prototype=_.create(TemplateView.prototype,{html:"<div id='<%=id%>' class='lightbox <%=additionalClasses%>' style='display: none'>  <div class='content'><%=createContent()%></div></div>",templateModel:function(){return{id:this.lightboxId,additionalClasses:_.isString(this.additionalClasses)?this.additionalClasses:"",createContent:_.bind(this.createContent,this)}},createContent:function(){return _.template(this.getContentHtml())(_.extend(this.templateModel(),this.getAdditionalContentModel()))},
getAdditionalContentModel:function(){return{}},getContentHtml:function(){return""}});BaseReport.ConvertUtils={getGroupingLevels:function(a){return[a.firstGroupingLevel,a.secondGroupingLevel]},getGroupingType:function(a,b){var c=this.getGroupingIndex(a,b);return null!=c?b[c]:null},getGroupingIndex:function(a,b){for(var c=function(a,b){for(;a<b.length&&b[a]==ReportGroupingLevel.NONE;)a++;return a},d=c(0,b);d<b.length&&0<a;)d=c(d+1,b),a--;return d<b.length?d:null},getGroupingLevelsCollapsed:function(a){return _.filter(a,function(a){return a!=ReportGroupingLevel.NONE})}};function LeavesReport(){};ReportUtils={generateOldIEPDFTooltip:function(a){var b=$("<div id='pdfDisabledTooltip' class='yellowTooltip aboveMenuZindex' style='display: none;'><div id='pdfDisabledTooltip_textPlaceholder'>"+messageResource.getMessage("common.export.pdf.disabled_tooltip")+"</div></div>");$("body").append(b);var c=(new TableTooltip).init("pdfDisabledTooltip");window.test=c;a.hover(function(){c.show()},function(){c.hide()});a.mousemove(function(a){c.move(calculateTooltipOffset(c,a))})}};LeavesReport.Table=function(a,b){TemplateView.call(this,a);this.store=b};
LeavesReport.Table.prototype=_.create(TemplateView.prototype,{html:"<table class='leavesReportTable display-for-print' cellspacing='0' cellpadding='0'></table>",updateOnInit:!1,update:function(){var a=this.store.getReportData(),b=this.store.getReportParams(),a=(new LeavesReportTableDataConverter(a,b)).convert();this.cancelRendering();this.$el.empty();this.rowInsertProcessor=(new ChunkIterator(a,20,function(a){switch(a.type){case RowType.HEADER:(new LeavesReport.Table.HeaderRow(this.$el,b.firstGroupingLevel,
b.secondGroupingLevel,b.timeFormat,a.leaveTypeIds,a.balancesRange,a.hasPto,a.hasSick)).init();break;case RowType.TOTALS:(new LeavesReport.Table.TotalsRow(this.$el,this.store,a.total,a.leaveTypeTotals,a.ptoBalances,a.sickBalances,b.timeFormat)).init();break;case RowType.FIRST_LEVEL:(new LeavesReport.Table.FirstLevelRow(this.$el,this.store,b.firstGroupingLevel,a.id,a.total,a.leaveTypeTotals,a.ptoBalances,a.sickBalances,b.timeFormat)).init();break;case RowType.SECOND_LEVEL:(new LeavesReport.Table.SecondLevelRow(this.$el,
this.store,b.secondGroupingLevel,a.id,a.total,a.leaveTypeTotals,a.ptoBalances,a.sickBalances,b.timeFormat)).init()}},this)).start();this.$el.toggleClass("noSecondGroupingLevel",!b.secondGroupingLevel||b.secondGroupingLevel==ReportGroupingLevel.NONE);this.$el.toggleClass("noLeaves",!LeavesReportUtils.reportParamsWithLeaves(b));this.$el.toggleClass("noPto",!LeavesReportUtils.reportParamsWithPTO(b));this.$el.toggleClass("noSick",!LeavesReportUtils.reportParamsWithSick(b))},cancelRendering:function(){this.rowInsertProcessor&&
this.rowInsertProcessor.pause()}});LeavesReport.Table.HeaderRow=function(a,b,c,d,e,f,g,h){TemplateView.call(this,a);this.firstGroupingLevel=b;this.secondGroupingLevel=c;this.timeFormat=d;this.leaveTypeIds=e;this.balancesRange=f;this.hasPto=g;this.hasSick=h};
LeavesReport.Table.HeaderRow.prototype=_.create(TemplateView.prototype,{html:"<tr class='headerRow top'>  <td class='listtblcolheader firstCell' rowspan='2'><%-firstLevelName%><span class='secondLevel'> / <%-secondLevelName%></span></td>  <td class='listtblcolheader totalCell' rowspan='2'>Total<br/>Leave Time<br/><span class='format'>(<%-format%>)</span></td></tr><tr class='headerRow bottom'></tr>",afterRender:function(){this.$topRow=this.$el.eq(0);this.$bottomRow=this.$el.eq(1);_.each(this.leaveTypeIds,
function(a){(new LeavesReport.Table.HeaderRow.LeaveTypeCell(this.$topRow,a)).init()},this);this.hasPto&&this._addBalances(BalanceType.PTO);this.hasSick&&this._addBalances(BalanceType.SICK)},templateModel:function(){return{firstLevelName:LeavesReportFormatUtils.formatGroupingLevel(this.firstGroupingLevel),secondLevelName:LeavesReportFormatUtils.formatGroupingLevel(this.secondGroupingLevel),format:LeavesReportFormatUtils.formatTimeFormat(this.timeFormat)}},_addBalances:function(a){this.leaveTypeIds&&
0<this.leaveTypeIds.length&&this.$topRow.append("<td class='separator' rowspan='2'></td>");(new LeavesReport.Table.HeaderRow.BalancesCellTop(this.$topRow,this.balancesRange.startDate,this.balancesRange.endDate,a,this.firstGroupingLevel,this.secondGroupingLevel)).init();(new LeavesReport.Table.HeaderRow.BalancesCellBottom(this.$bottomRow,this.balancesRange.startDate,this.balancesRange.endDate,a,this.firstGroupingLevel,this.secondGroupingLevel)).init()}});LeavesReport.Table.HeaderRow.LeaveTypeCell=function(a,b){TemplateView.call(this,a);this.leaveTypeId=b};LeavesReport.Table.HeaderRow.LeaveTypeCell.prototype=_.create(TemplateView.prototype,{html:"<td class='reportcolheader leaveTypeCell' rowspan='2'>  <img src='<%=iconUrl%>'/>  <br/>  <%-name%></td>",templateModel:function(){var a=LeaveTypeStore.getLeaveType(this.leaveTypeId);return{name:a.name,iconUrl:getLeaveTypeIconPath(a.iconId)}}});LeavesReport.Table.HeaderRow.BalancesCell=function(a,b,c,d,e,f){TemplateView.call(this,a);this.startDate=b;this.endDate=c;this.type=d;this.firstGroupingLevel=e;this.secondGroupingLevel=f};LeavesReport.Table.HeaderRow.BalancesCell.prototype=_.create(TemplateView.prototype,{templateModel:function(){return LeavesReportFormatUtils.makeBalanceTemplateModel(this.type,this.firstGroupingLevel,this.secondGroupingLevel,this.startDate,this.endDate)}});LeavesReport.Table.HeaderRow.BalancesCellTop=function(a,b,c,d,e,f){LeavesReport.Table.HeaderRow.BalancesCell.call(this,a,b,c,d,e,f)};LeavesReport.Table.HeaderRow.BalancesCellTop.prototype=_.create(LeavesReport.Table.HeaderRow.BalancesCell.prototype,{html:"<td class='listtblcolheader balancesTitle' colspan='2'><%=title%></td>"});LeavesReport.Table.HeaderRow.BalancesCellBottom=function(a,b,c,d,e,f){LeavesReport.Table.HeaderRow.BalancesCell.call(this,a,b,c,d,e,f)};LeavesReport.Table.HeaderRow.BalancesCellBottom.prototype=_.create(LeavesReport.Table.HeaderRow.BalancesCell.prototype,{html:"<td class='listtblcolheader startDate'>  <div><%=startDate%></div>  <div class='details'><%=startDateDetails%></div>  <div class='unit'>(<%=unit%>)</div></td><td class='listtblcolheader endDate'>  <div><%=endDate%></div>  <div class='details'><%=endDateDetails%></div>  <div class='unit'>(<%=unit%>)</div></td>"});LeavesReport.Table.TimeCell=function(a,b,c,d){TemplateView.call(this,a);this.level=b;this.time=c;this.timeFormat=d};LeavesReport.Table.TimeCell.prototype=_.create(TemplateView.prototype,{html:"<td class='<%=levelClass%>'><%-time%></td>",templateModel:function(){return{time:LeavesReportFormatUtils.formatTime(this.time,this.timeFormat),levelClass:"reportrow"+this.level+"num"}}});LeavesReport.Table.BalanceCell=function(a,b,c,d,e){TemplateView.call(this,a);this.store=b;this.level=c;this.balance=d;this.balanceType=e};
LeavesReport.Table.BalanceCell.prototype=_.create(TemplateView.prototype,{html:"<td class='<%=levelClass%> balanceCell'><%-balance%></td>",afterRender:function(){this.$el.toggleClass("negative",0>this.balance)},templateModel:function(){return{balance:LeavesReportFormatUtils.formatBalance(this.balance,this.balanceType,this.store.getDefaultWorkDayDuration()),levelClass:"reportrow"+this.level+"num"}}});LeavesReport.Table.DataRow=function(a,b,c,d,e,f,g,h,k,l){TemplateView.call(this,a);this.store=b;this.level=c;this.groupingLevel=d;this.id=e;this.total=f;this.leaveTypeTotals=g;this.ptoBalances=h;this.sickBalances=k;this.timeFormat=l};
LeavesReport.Table.DataRow.prototype=_.create(TemplateView.prototype,{html:"<tr class='dataRow <%=rowClass%>'>  <td class='<%=titleLevelClass%> titleCell'><%-title%><span class='corporateDayOffLabel'> <%=corporateDayOffLabel%></span></td>  <td class='totalCell <%=levelClass%>'><%-total%></td></tr>",afterRender:function(){_.each(this.leaveTypeTotals,function(a){(new LeavesReport.Table.TimeCell(this.$el,this.level,a,this.timeFormat)).init()},this);this.ptoBalances&&this._addBalances(this.ptoBalances,
BalanceType.PTO);this.sickBalances&&this._addBalances(this.sickBalances,BalanceType.SICK);this.groupingLevel==ReportGroupingLevel.DATE&&(this.$el.toggleClass("dayOff",this.store.getDateInfo(this.id).dayOff),this.$el.toggleClass("corporateDayOff",this.store.getDateInfo(this.id).corporateDayOff))},templateModel:function(){return{rowClass:this.rowClass(),title:this._title(),total:LeavesReportFormatUtils.formatTime(this.total,this.timeFormat),titleLevelClass:"reportrow"+this.level,levelClass:"reportrow"+
this.level+"num"}},messageKeys:function(){return{corporateDayOffLabel:"common.corporate_day_off_text"}},rowClass:function(){},_title:function(){return LeavesReportFormatUtils.getGroupingLevelTitle(this.groupingLevel,this.id,this.store)},_addBalances:function(a,b){this.leaveTypeTotals&&0<this.leaveTypeTotals.length&&this.$el.append("<td class='separator'></td>");(new LeavesReport.Table.BalanceCell(this.$el,this.store,this.level,a.start,b)).init();(new LeavesReport.Table.BalanceCell(this.$el,this.store,
this.level,a.end,b)).init()}});LeavesReport.Table.TotalsRow=function(a,b,c,d,e,f,g){LeavesReport.Table.DataRow.call(this,a,b,0,null,null,c,d,e,f,g)};LeavesReport.Table.TotalsRow.prototype=_.create(LeavesReport.Table.DataRow.prototype,{rowClass:function(){return"totalsRow"},_title:function(){return messageResource.getMessage("report.total")}});LeavesReport.Table.FirstLevelRow=function(a,b,c,d,e,f,g,h,k){LeavesReport.Table.DataRow.call(this,a,b,1,c,d,e,f,g,h,k)};LeavesReport.Table.FirstLevelRow.prototype=_.create(LeavesReport.Table.DataRow.prototype,{rowClass:function(){return"firstLevelRow"}});function BaseReportPDF(){};BaseReport.PDFPreviewLightboxTemplateView=function(a,b,c){LightboxTemplateView.call(this,a,b,c)};BaseReport.PDFPreviewLightboxTemplateView.prototype=_.create(LightboxTemplateView.prototype,{getContentHtml:function(){return"<table class='dialog-header'>  <tr>    <td>      <div class='close-button'>         <div id='closeViewTTPdfPreviewLightboxButton' class='closeButton'/>      </div>      <div class='lightBoxTitle'></div>    </td>  </tr></table><div class='delimiter'></div><div id='<%=id%>_chartConfigurationSection' class='chartConfigurationSection'>  Users' and cp selectors' parameters</div><div class='innerContent'><div class='pdfPreviewContainer'></div></div><div id='<%=id%>_footer'>  <table cellpadding=0 cellspacing=0 border=0 style='width: 100%;'>    <tr>      <td class='errorMessageBox'>        <img src='<%=atImgPath(\"error.gif\")%>'/>        <span class='errormsg'></span>       </td>       <td class='buttonsBox'>         <span class='changesMsg'></span>         <span class='savingMsg'></span>         <div id='<%=id%>_downloadPdfBtn' class='greyButton withIcon downloadPdfBtn'><div class='buttonIcon'><span class='buttonTitle'><%=messageResource.getMessage('report.chart_pdf_preview.exportButton.caption')%></span></div></div>       </td>     </tr>  </table></div>"}});LeavesReport.Table.SecondLevelRow=function(a,b,c,d,e,f,g,h,k){LeavesReport.Table.DataRow.call(this,a,b,3,c,d,e,f,g,h,k)};LeavesReport.Table.SecondLevelRow.prototype=_.create(LeavesReport.Table.DataRow.prototype,{rowClass:function(){return"secondLevelRow"}});var BalanceHistory={TableRows:{AUTOMATIC_BALANCE_LIMIT_RECORD:"AUTOMATIC_BALANCE_LIMIT_RECORD",AUTOMATIC_BALANCE_RESET_RECORD:"AUTOMATIC_BALANCE_RESET_RECORD",AUTOMATIC_BALANCE_ACCRUE_RECORD:"AUTOMATIC_BALANCE_ACCRUE_RECORD",MANUAL_INCREASE_RECORD:"MANUAL_INCREASE_RECORD",MANUAL_DECREASE_RECORD:"MANUAL_DECREASE_RECORD",MANUAL_SET_RECORD:"MANUAL_SET_RECORD",LEAVE_TIME_COMPLETED_RECORD:"LEAVE_TIME_COMPLETED_RECORD"},BalanceTypes:{SICK:"sick",PTO:"pto"},Table:function(a,b,c){TemplateView.call(this,a);
this.balanceFormatter=(new BalanceFormatter).init(b,c)}};
BalanceHistory.Table.prototype=_.create(TemplateView.prototype,{html:"<div class='balanceHistoryTableContainer <%=balanceTypeClass%>'>  <table class='balanceHistoryTable display-for-print dataTable' cellspacing='0' cellpadding='0'><thead></thead><tbody class='rows'></tbody></table></div>",updateOnInit:!1,afterRender:function(){this.$balanceRows=this.find(".balanceHistoryTable tbody");this.renderTHead();this._createRows(this.$balanceRows,this.getBalanceModels())},renderTHead:function(){(new BalanceHistory.Table.HeadRow(this.find(".balanceHistoryTable thead"))).init()},
update:function(){this.$balanceRows.empty();this._createRows(this.$balanceRows,this.getBalanceModels())},_createRows:function(a,b){var c=this.getBalanceType(),d=this.balanceFormatter;_.isEmpty(b)?(new BalanceHistory.Table.NoLeaveTimeRow(a,c)).init():_.each(b,function(b){switch(b.type){case BalanceHistory.TableRows.AUTOMATIC_BALANCE_ACCRUE_RECORD:(new BalanceHistory.Table.AutoAdjustmentRow.Accrue(a,c,b,d)).init();break;case BalanceHistory.TableRows.AUTOMATIC_BALANCE_LIMIT_RECORD:(new BalanceHistory.Table.AutoAdjustmentRow.Limit(a,
c,b,d)).init();break;case BalanceHistory.TableRows.AUTOMATIC_BALANCE_RESET_RECORD:(new BalanceHistory.Table.AutoAdjustmentRow.Reset(a,c,b,d)).init();break;case BalanceHistory.TableRows.LEAVE_TIME_COMPLETED_RECORD:(new BalanceHistory.Table.LeaveTimeCompletedRow(a,c,b,d)).init();break;case BalanceHistory.TableRows.MANUAL_INCREASE_RECORD:(new BalanceHistory.Table.ManualAdjustmentRow.Increase(a,c,b,d)).init();break;case BalanceHistory.TableRows.MANUAL_DECREASE_RECORD:(new BalanceHistory.Table.ManualAdjustmentRow.Decrease(a,
c,b,d)).init();break;case BalanceHistory.TableRows.MANUAL_SET_RECORD:(new BalanceHistory.Table.ManualAdjustmentRow.ManualSet(a,c,b,d)).init()}})},getBalanceModels:function(){},getBalanceType:function(){}});BalanceHistory.Table.BalanceRow=function(a,b,c,d){TemplateView.call(this,a);this.balanceType=b;this.balanceModel=c;this.balanceFormatter=d};
BalanceHistory.Table.BalanceRow.prototype=_.create(TemplateView.prototype,{html:"<tr class='record <%=recordClass%>'>    <td class='effectiveDateCell'><%=effectiveDate%></td>    <td class='descriptionCell'>        <div class='descriptionDiv'>            <img src='<%=recordImgPath%>'>            <div class='for-print-only'><img src='<%=recordPrintImgPath%>'></div>            <div class='descriptionTitle'><%=descriptionTitle%></div>            <% if (!_.isNull(comment)) { %>             <div title='<%-comment%>' class='descriptionComment'><%-comment%></div>            <% } %>        </div>    </td>    <td class='valueCell'>        <span class='mainValue'><%=mainValue%></span>        <span class='additionalValue'>&nbsp;&nbsp;(<%=additionalValue%>)</span>    </td>    <td class='endingBalanceCell'>        <span class='bold mainValue'><%=endingMainValue%></span>        <span class='additionalValue'>&nbsp;&nbsp;(<%=endingAdditionalValue%>)</span>    </td></tr>",templateModel:function(){var a=
this.balanceModel,b=this.additionalValueSign,c=this.balanceFormatter;return{effectiveDate:(new DateFormat(window.SystemSettings.dateFormat)).formatDate(a.effectiveDate.parseJSONDate()),mainValue:b+" "+c.format(a.differenceValue),additionalValue:c.format(a.differenceValue,!0),endingMainValue:c.format(a.endingBalance),endingAdditionalValue:c.format(a.endingBalance,!0),recordClass:this.recordClass}},afterRender:function(){this.balanceFormatter.isNegativePTO(this.balanceModel.endingBalance)&&(this.find(".endingBalanceCell > span.mainValue").addClass("negative"),
this.find(".endingBalanceCell > span.additionalValue").addClass("negative"))}});BalanceHistory.Table.AutoAdjustmentRow=function(a,b,c,d){BalanceHistory.Table.BalanceRow.call(this,a,b,c,d)};BalanceHistory.Table.AutoAdjustmentRow.prototype=_.create(BalanceHistory.Table.BalanceRow.prototype,{templateModel:function(){return _.extend(BalanceHistory.Table.BalanceRow.prototype.templateModel.call(this),{recordImgPath:atImgPath("auto-adjustment.png"),recordPrintImgPath:atImgPath("auto-adjustment_print.png"),comment:null})}});
BalanceHistory.Table.AutoAdjustmentRow.Limit=function(a,b,c,d){BalanceHistory.Table.AutoAdjustmentRow.call(this,a,b,c,d)};
BalanceHistory.Table.AutoAdjustmentRow.Limit.prototype=_.create(BalanceHistory.Table.AutoAdjustmentRow.prototype,{templateModel:function(){var a=messageResource.getMessage("common.balance_history.table.automatic_balance_limit.label",[messageResource.getMessage("common.balance_history.table."+this.balanceType)]);return _.extend(BalanceHistory.Table.AutoAdjustmentRow.prototype.templateModel.call(this),{descriptionTitle:a})},additionalValueSign:"=",recordClass:"automaticBalanceLimitRecord"});
BalanceHistory.Table.AutoAdjustmentRow.Reset=function(a,b,c,d){BalanceHistory.Table.AutoAdjustmentRow.call(this,a,b,c,d)};
BalanceHistory.Table.AutoAdjustmentRow.Reset.prototype=_.create(BalanceHistory.Table.AutoAdjustmentRow.prototype,{templateModel:function(){var a=messageResource.getMessage("common.balance_history.table.automatic_balance_reset.label",[messageResource.getMessage("common.balance_history.table."+this.balanceType)]);return _.extend(BalanceHistory.Table.AutoAdjustmentRow.prototype.templateModel.call(this),{descriptionTitle:a})},additionalValueSign:"=",recordClass:"automaticBalanceResetRecord"});
BalanceHistory.Table.AutoAdjustmentRow.Accrue=function(a,b,c,d){BalanceHistory.Table.AutoAdjustmentRow.call(this,a,b,c,d)};
BalanceHistory.Table.AutoAdjustmentRow.Accrue.prototype=_.create(BalanceHistory.Table.AutoAdjustmentRow.prototype,{messageKeys:function(){return{descriptionTitle:"common.balance_history.table.automatic_balance_accrue.label"}},afterRender:function(){BalanceHistory.Table.AutoAdjustmentRow.prototype.afterRender.call(this);this.find(".valueCell > span.mainValue").addClass("increased");this.find(".valueCell > span.additionalValue").addClass("increased")},additionalValueSign:"+",recordClass:"automaticBalanceAccrueRecord"});BalanceHistory.Table.LeaveTimeCompletedRow=function(a,b,c,d){BalanceHistory.Table.BalanceRow.call(this,a,b,c,d)};
BalanceHistory.Table.LeaveTimeCompletedRow.prototype=_.create(BalanceHistory.Table.BalanceRow.prototype,{additionalValueSign:"-",recordClass:"leaveTimeCompletedRecord",templateModel:function(){var a=this.balanceModel.comment,b=LeaveTypeStore.getLeaveType(this.balanceModel.leaveTypeId),c=messageResource.getEscapedMessage("common.balance_history.table.leave_time_completed.label",[b.name]);return _.extend(BalanceHistory.Table.BalanceRow.prototype.templateModel.call(this),{descriptionTitle:c,comment:a,
recordImgPath:getLeaveTypeIconPath(b.iconId),recordPrintImgPath:getLeaveTypePrintIconPath(b.iconId)})},afterRender:function(){BalanceHistory.Table.BalanceRow.prototype.afterRender.call(this);this.find(".valueCell > span.mainValue").addClass("decreased");this.find(".valueCell > span.additionalValue").addClass("decreased")}});BalanceHistory.Table.ManualAdjustmentRow=function(a,b,c,d){BalanceHistory.Table.BalanceRow.call(this,a,b,c,d)};
BalanceHistory.Table.ManualAdjustmentRow.prototype=_.create(BalanceHistory.Table.BalanceRow.prototype,{formatBalanceManagerInfo:function(a){return messageResource.getMessage("common.balance_history.table.leave_time_completed.by.label",[UserNameFormat.formatFML(a.firstName,a.lastName,a.middleInitial)])},formatCommentIfPresent:function(a){return a&&isNotEmpty(a)?" - "+a:""},templateModel:function(){var a=this.formatBalanceManagerInfo(this.balanceModel.balanceManagerInfo)+this.formatCommentIfPresent(this.balanceModel.comment);
return _.extend(BalanceHistory.Table.BalanceRow.prototype.templateModel.call(this),{recordImgPath:atImgPath("manual-adjustment.png"),recordPrintImgPath:atImgPath("manual-adjustment_print.png"),comment:a})}});BalanceHistory.Table.ManualAdjustmentRow.Increase=function(a,b,c,d){BalanceHistory.Table.ManualAdjustmentRow.call(this,a,b,c,d)};
BalanceHistory.Table.ManualAdjustmentRow.Increase.prototype=_.create(BalanceHistory.Table.ManualAdjustmentRow.prototype,{messageKeys:function(){return{descriptionTitle:"common.balance_history.table.manual_increase.label"}},afterRender:function(){BalanceHistory.Table.ManualAdjustmentRow.prototype.afterRender.call(this);this.find(".valueCell > span.mainValue").addClass("increased");this.find(".valueCell > span.additionalValue").addClass("increased")},additionalValueSign:"+",recordClass:"manualIncreaseRecord"});
BalanceHistory.Table.ManualAdjustmentRow.Decrease=function(a,b,c,d){BalanceHistory.Table.ManualAdjustmentRow.call(this,a,b,c,d)};
BalanceHistory.Table.ManualAdjustmentRow.Decrease.prototype=_.create(BalanceHistory.Table.ManualAdjustmentRow.prototype,{messageKeys:function(){return{descriptionTitle:"common.balance_history.table.manual_decrease.label"}},afterRender:function(){BalanceHistory.Table.ManualAdjustmentRow.prototype.afterRender.call(this);this.find(".valueCell > span.mainValue").addClass("decreased");this.find(".valueCell > span.additionalValue").addClass("decreased")},additionalValueSign:"-",recordClass:"manualDecreaseRecord"});
BalanceHistory.Table.ManualAdjustmentRow.ManualSet=function(a,b,c,d){BalanceHistory.Table.ManualAdjustmentRow.call(this,a,b,c,d)};BalanceHistory.Table.ManualAdjustmentRow.ManualSet.prototype=_.create(BalanceHistory.Table.ManualAdjustmentRow.prototype,{messageKeys:function(){return{descriptionTitle:"common.balance_history.table.manual_set.label"}},additionalValueSign:"=",recordClass:"manualSetRecord"});BalanceHistory.Table.HeadRow=function(a){TemplateView.call(this,a)};
BalanceHistory.Table.HeadRow.prototype=_.create(TemplateView.prototype,{html:"<tr><th class='effectiveDateCell'><%=dataCellTitle%></th> <th class='descriptionCell'><%=descriptionCellTitle%></th>  <th class='valueCell'><%=valueCellTitle%></th>  <th class='endingBalanceCell'><%=balanceCellTitle%></th> </tr>",messageKeys:function(){return{dataCellTitle:"common.balance_history.table.date_cell.title",descriptionCellTitle:"common.balance_history.table.description_cell.title",valueCellTitle:"common.balance_history.table.value_cell.title",
balanceCellTitle:"common.balance_history.table.balance_cell.title"}}});BalanceHistory.Table.NoLeaveTimeRow=function(a,b){TemplateView.call(this,a);this.balanceType=b};BalanceHistory.Table.NoLeaveTimeRow.prototype=_.create(TemplateView.prototype,{html:"<tr class='emptyRecord'><td colspan='4' class='content'><%-noLeaveTimeLabel%></td></tr>",templateModel:function(){return{noLeaveTimeLabel:messageResource.getMessage("common.balance_history.table.empty_table_info.text",[messageResource.getMessage("common.balance_history.table."+this.balanceType)])}}});function PanelBalanceHistoryTable(a,b,c,d,e){this._balanceTypePrefix=e;this._balanceRecords=b;BalanceHistory.Table.call(this,a,c,d)}
PanelBalanceHistoryTable.prototype=_.create(BalanceHistory.Table.prototype,{html:"<div class='balanceHistoryTableContainer'><table id='panel_balanceHistoryTable' class='balanceHistoryTable display-for-print dataTable'><tbody></tbody></table></div>",renderTHead:function(){},afterRender:function(){BalanceHistory.Table.prototype.afterRender.call(this);var a=!1;this.$balanceRows.find("tr").each(function(b,c){a?$(c).addClass("even"):$(c).addClass("odd");a=!a})},getBalanceModels:function(){return this._balanceRecords},
beforeRender:function(){this.$containerEl.empty()},getBalanceType:function(){return this._balanceTypePrefix}});var Router={_routes:{},_config:{},_root:"/",_mode:window.history&&history.pushState?"history":"anchors",config:function(a){_.extend(this._config,a);return this},init:function(a){this._root=a;a=_.bind(Router.check,Router,null);History.Adapter.bind(window,"statechange",a);return this},_clearPath:function(a){return a.toString().replace(/\/$/,"").replace(/\?(.*)$/,"").replace(/;(.*)$/,"")},getPath:function(a){a=a||this.getState();a=this._clearPath(decodeURI(a.hash));if("history"===this._mode)return"/"!=
this._root?a.replace(this._root,""):a;var b=a.match(/#(.*)$/);return b?b[1]:a},add:function(a,b){this._routes[a]={handler:b};return this},remove:function(a){delete this._routes[a];return this},base:function(a,b,c){a="history"===this._mode?this._root+a:a;a+=this.getJSessionFromUrl();History.replaceState(b,c,a);return this},navigate:function(a,b,c){a="history"===this._mode?this._root+a:a;a+=this.getJSessionFromUrl();History.pushState(b,c,a);return this},getJSessionFromUrl:function(){var a=decodeURI(this.getState().hash).match(/jsessionid=(.*)$/);
return _.isNull(a)?"":(";"+a[0]).replace(/\/$/,"").replace(/\?.*$/,"").replace(/&.*$/,"")},getState:function(){return History.getState(!0,!0)},flush:function(){this._routes=[];this._config={};this._root="/";return this},check:function(a){var b=this.getState();a=a||this.getPath(b);_.isUndefined(this._routes[a])||this._routes[a].handler.call({},b.data,b.title);return this},supportHistoryAPI:function(){return"history"===this._mode}};ProductSettingsValidator=function(){};ProductSettingsValidator.prototype={isTZGEnabled:function(){},isUGREnabled:function(){},isSickEnabled:function(){},isPTOEnabled:function(){}};function ReportRightsValidator(){}ReportRightsValidator.isCanViewBalances=function(){};
//# sourceMappingURL=common.min.js.map
